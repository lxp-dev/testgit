<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="queryPersonID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O>
<![CDATA[2014-12-15]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O>
<![CDATA[01]]></O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O>
<![CDATA[2014-12-16]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[-------------收银员工作量统计(多店)------------------------------
DECLARE @select   VARCHAR(8000),
        @from     VARCHAR(8000),
        @where    VARCHAR(1000),
        @groupby  VARCHAR(1000),
        @sql      VARCHAR(8000),
        @bgndate  VARCHAR(10),
        @enddate  VARCHAR(10),
        @shopCode VARCHAR(MAX),
        @personID VARCHAR(MAX)

SET @bgndate = '${startTime}'
SET @enddate = '${endTime}'
SET @shopCode = '${departmentid}'
SET @personID = '${queryPersonID}'

-- SET @bgndate = '2015-06-01'
-- SET @enddate = '2015-06-01'
-- SET @shopCode = '010'
-- SET @personID = ''
SELECT departmentID
INTO   #salesDepartments
FROM   Sales_createshopcodetab(@shopCode)

IF ( @bgndate < CONVERT(VARCHAR(10), Getdate(), 120) )
  BEGIN
      IF ( @enddate < CONVERT(VARCHAR(10), Getdate(), 120) )
        BEGIN
            ----1、当日以前，从石英数据汇总-----------------------------------------------------------
            SELECT ( @bgndate + '--' + @enddate ) AS queryDate,
                   departmentId                   AS departmentId,
                   departmentName                 AS departmentName,
                   glassesAmount                  AS glassesAmount,
                   frameAmount                    AS frameAmount,
                   eyeglassesAmount               AS eyeglassesAmount,
                   frameAssistAmount              AS frameAssistAmount,
                   yxAssistAmount                 AS yxAssistAmount,
                   contactAmount                  AS contactAmount,
                   contactAssistAmount            AS contactAssistAmount,
                   othersAmount                   AS othersAmount,
                   discountAmount                 AS discountAmount,
                   amount                         AS amount,
                   inspectionNum                  AS inspectionNum,
                   inspectionAmount               AS inspectionAmount,
                   glassesBillNum                 AS glassesBillNum,
                   oldAmount                      AS oldAmount,
                   shineAmount                    AS shineAmount,
                   wxAmount                       AS wxAmount,
                   arrearsAmount                  AS arrearsAmount,
                   customizeValue                 AS customizeAmount
            FROM   (SELECT ( @bgndate + '--' + @enddate )    AS queryDate,
                           R_CQT_OS_DepartmentId             AS departmentId,
                           B_DP_DepartmentName               AS departmentName,
                           SUM(R_CQT_OS_glassesAmount)       AS glassesAmount,
                           SUM(R_CQT_OS_frameAmount)         AS frameAmount,
                           SUM(R_CQT_OS_eyeglassesAmount)    AS eyeglassesAmount,
                           SUM(R_CQT_OS_frameAssistAmount)   AS frameAssistAmount,
                           SUM(R_CQT_OS_yxAssistAmount)      AS yxAssistAmount,
                           SUM(R_CQT_OS_contactAmount)       AS contactAmount,
                           SUM(R_CQT_OS_contactAssistAmount) AS contactAssistAmount,
                           SUM(R_CQT_OS_otherAmount)         AS othersAmount,
                           SUM(R_CQT_OS_discountAmount)      AS discountAmount,
                           SUM(R_CQT_OS_amount)              AS amount,
                           SUM(R_CQT_OS_inspectionNum)       AS inspectionNum,
                           SUM(R_CQT_OS_inspectionAmount)    AS inspectionAmount,
                           SUM(R_CQT_OS_glassesBillNum)      AS glassesBillNum,
                           SUM(R_CQT_OS_oldAmount)           AS oldAmount,
                           SUM(R_CQT_OS_shineAmount)         AS shineAmount,
                           SUM(R_CQT_OS_WxAmount)            AS wxAmount,
                           SUM(R_CQT_OS_ArrearsValue)        AS arrearsAmount,
                           SUM(R_CQT_OS_CustomizeValue)      AS customizeValue
                    FROM   R_casherQTOnlyStore
                           INNER JOIN B_Departments
                             ON R_CQT_OS_DepartmentId = B_DP_DepartmentID
                    WHERE  R_CQT_OS_Date >= @bgndate
                           AND R_CQT_OS_Date <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND R_CQT_OS_DepartmentId IN (SELECT departmentID
                                                                 FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND R_CQT_OS_personID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    GROUP  BY B_DP_DepartmentName,
                              R_CQT_OS_DepartmentId
            )TEMP
            ORDER  BY departmentId
        END
      ELSE
        BEGIN
            ----2、当日以前+当日，从石英及当日数据表汇总----------------------------------
            ---- 人员信息临时表 #personinfo_02 -------------------------------------------
            SELECT DISTINCT departmentId        AS ShopCode,
                            B_DP_DepartmentName AS departmentName
            INTO   #personinfo_02
            FROM   (SELECT DISTINCT S_SE_SB_ShopCode AS departmentId
                    FROM   uview_SalesBasic
                    WHERE  CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND s_se_sb_posid = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION
                    SELECT DISTINCT S_SE_SB_ShopCode AS departmentId
                    FROM   uview_SalesBasic
                    WHERE  CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SB_WithdrawPersonID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION
                    SELECT DISTINCT S_CR_RD_ShopCode AS departmentId
                    FROM   S_CR_RegisteredDetails
                    WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_CR_RD_Casher = @personID )
                                  OR Isnull(@personID, '') = '' )
                           AND Isnull(S_CR_RD_Casher, '') <> ''
                    UNION
                    SELECT DISTINCT S_CR_RD_ShopCode AS departmentId
                    FROM   S_CR_RepairsCostDetails
                    WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                           AND Isnull(S_CR_RD_Casher, '') <> ''
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_CR_RD_Casher = @personID )
                                  OR Isnull(@personID, '') = '' )) person
                   INNER JOIN B_Departments
                     ON departmentId = B_DP_DepartmentID
            ORDER  BY departmentId

            ---- 镜片金额 #jp_02 ----------------------------------------------------
            SELECT SUM(TEMP.glassesAmount1) + SUM(TEMP.glassesAmount2) AS glassesAmount,
                   TEMP.ShopCode                                       AS ShopCode
            INTO   #jp_02
            FROM   (SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                           CAST(Isnull(S_SE_SCR_CpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                           CAST(Isnull(S_SE_SCR_DzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                          AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_CpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                           -CAST(Isnull(S_SE_SCR_DzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 镜架金额 #jj_02 -------------------------------------------------------
            SELECT SUM(TEMP.frameAmount) AS frameAmount,
                   TEMP.ShopCode         AS ShopCode
            INTO   #jj_02
            FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                           CAST(Isnull(S_SE_SCR_JjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_JjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 成镜金额 #cj_01 -------------------------------------------------------
            SELECT SUM(TEMP.eyeglassesAmount) AS eyeglassesAmount,
                   TEMP.ShopCode              AS ShopCode
            INTO   #cj_01
            FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           CAST(Isnull(S_SE_SCR_TyjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_TyjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 老花镜金额 #cj_02 -------------------------------------------------------
            SELECT SUM(TEMP.eyeglassesAmount) AS eyeglassesAmount,
                   TEMP.ShopCode              AS ShopCode
            INTO   #cj_02
            FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           CAST(Isnull(S_SE_SCR_LhjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_LhjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 镜架辅料金额 #jzfl_02 --------------------------------------------------
            SELECT SUM(TEMP.frameAssistAmount) AS frameAssistAmount,
                   TEMP.ShopCode               AS ShopCode
            INTO   #jzfl_02
            FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                           CAST(Isnull(S_SE_SCR_PjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_PjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 隐形辅料金额 #jzfl_02 --------------------------------------------------
            SELECT SUM(TEMP.yxAssistAmount) AS yxAssistAmount,
                   TEMP.ShopCode            AS ShopCode
            INTO   #yxfl_02
            FROM   (SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                           CAST(Isnull(S_SE_SCR_PjyxPrice, '0.0') AS DECIMAL(18, 2)) AS yxAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                          AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_PjyxPrice, '0.0') AS DECIMAL(18, 2)) AS yxAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 隐形金额 #yx_02 -------------------------------------------------------
            SELECT SUM(TEMP.glassesAmount1) + SUM(TEMP.glassesAmount2) AS contactAmount,
                   TEMP.ShopCode                                       AS ShopCode
            INTO   #yx_02
            FROM   (SELECT S_SE_SCR_ShopCode                                           AS ShopCode,
                           CAST(Isnull(S_SE_SCR_YxcpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                           CAST(Isnull(S_SE_SCR_YxdzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                            AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_YxcpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                           -CAST(Isnull(S_SE_SCR_YxdzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 护理液金额 #hly_02 -------------------------------------------------------
            SELECT SUM(TEMP.contactAssistAmount) AS contactAssistAmount,
                   TEMP.ShopCode                 AS ShopCode
            INTO   #hly_02
            FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           CAST(Isnull(S_SE_SCR_HlyPrice, '0.0') AS DECIMAL(18, 2)) AS contactAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_HlyPrice, '0.0') AS DECIMAL(18, 2)) AS contactAssistAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 折扣金额 #zk_02 -------------------------------------------------------
            SELECT SUM(TEMP.discountAmount) AS discountAmount,
                   TEMP.ShopCode            AS ShopCode
            INTO   #zk_02
            FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                           CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 检查数量，检查金额 #jcsj_02 -------------------------------------------
            SELECT *
            INTO   #jcsj_02
            FROM   (SELECT S_CR_RD_ShopCode                AS ShopCode,
                           COUNT(*)                        AS inspectionNum,
                           SUM(Isnull(S_CR_RD_Money, 0.0)) AS inspectionAmount
                    FROM   S_CR_RegisteredDetails
                    WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                           AND S_CR_RD_Flag = '1'
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_CR_RD_Casher = @personID )
                                  OR Isnull(@personID, '') = '' )
                    GROUP  BY S_CR_RD_ShopCode) jcsj

            ---- 验光人次 #ygrc_02 -----------------------------------------------------
            SELECT *
            INTO   #ygrc_02
            FROM   (SELECT ( SUM(optometry) - SUM(unoptometry) ) AS optometryPersonTime,
                           ShopCode                              AS ShopCode
                    FROM   (SELECT COUNT(*)         AS optometry,
                                   0                AS unoptometry,
                                   S_CR_RD_ShopCode AS ShopCode
                            FROM   S_CR_RegisteredDetails t1
                                   INNER JOIN F_RegisteredCategory t2
                                     ON t1.S_CR_RD_RegisteredID = t2.F_RC_ID
                                        AND t2.F_RC_ID IN ( '8', '9', '21', '23',
                                                            '24', '25', '26', '27', '28' )
                            WHERE  CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                                   AND CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) <= @enddate
                            GROUP  BY S_CR_RD_ShopCode
                            UNION ALL
                            SELECT 0                AS optometry,
                                   COUNT(*)         AS unoptometry,
                                   S_CR_RD_ShopCode AS ShopCode
                            FROM   S_CR_RegisteredDetails t1
                                   INNER JOIN F_RegisteredCategory t2
                                     ON t1.S_CR_RD_RegisteredID = t2.F_RC_ID
                                        AND t2.F_RC_ID IN ( '10', '11', '29', '30',
                                                            '31', '32', '33', '34', '35' )
                            WHERE  CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                                   AND CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) <= @enddate
                            GROUP  BY S_CR_RD_ShopCode) t
                    WHERE  1 = 1
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND ShopCode IN (SELECT departmentID
                                                    FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                    GROUP  BY ShopCode) ygrc

            -- 配镜单数 #pjds_02 -----------------------------------------------------
            SELECT COUNT(*)      AS glassesBillNum,
                   TEMP.ShopCode AS ShopCode
            INTO   #pjds_02
            FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                           CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            -- 附加费用 #fjfy_02 -----------------------------------------------------
            SELECT SUM(TEMP.amount) AS amount,
                   TEMP.ShopCode    AS ShopCode
            INTO   #fjfy_02
            FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                           CAST(Isnull(S_SE_SCR_AdditionPrice, '0.0') AS DECIMAL(18, 2)) AS amount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_AdditionPrice, '0.0') AS DECIMAL(18, 2)) AS amount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 其他商品金额 #jp_02 ----------------------------------------------------
            SELECT SUM(TEMP.othersAmount) AS othersAmount,
                   TEMP.ShopCode          AS ShopCode
            INTO   #qt_02
            FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                           CAST(Isnull(S_SE_SCR_HcPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_HcPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 视光金额 #jp_02 ----------------------------------------------------
            SELECT SUM(TEMP.othersAmount) AS othersAmount,
                   TEMP.ShopCode          AS ShopCode
            INTO   #sg_02
            FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                           CAST(Isnull(S_SE_SCR_SgPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '0'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                           -CAST(Isnull(S_SE_SCR_SgPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
                    FROM   S_SE_SalerCashierRecord
                    WHERE  S_SE_SCR_WithdrawFlag = '1'
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                             FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_SE_SCR_PosID = @personID )
                                  OR Isnull(@personID, '') = '' )) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 欠款金额 #qk_02 ----------------------------------------------------
            SELECT TEMP.ShopCode           AS ShopCode,
                   SUM(TEMP.arrearsAmount) AS arrearsAmount
            INTO   #qk_02
            FROM   (SELECT Isnull(t2.s_se_c_arrearsValue, 0) AS arrearsAmount,
                           S_SE_SB_ShopCode                  AS ShopCode
                    FROM   uview_SalesBasic t1
                           INNER JOIN S_Se_Customize t2
                             ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                                AND t1.S_SE_SB_ValueFlag = '1'
                    WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND s_se_sb_posid = @personID )
                                  OR Isnull(@personID, '') = '' )
                    UNION ALL
                    SELECT Isnull(t2.s_se_c_arrearsValue, 0) AS arrearsAmount,
                           S_SE_SB_ShopCode                  AS ShopCode
                    FROM   uview_SalesBasic t1
                           INNER JOIN S_Se_CustomizeTui t2
                             ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                                AND t1.S_SE_SB_ValueFlag = '1'
                    WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND s_se_sb_posid = @personID )
                                  OR Isnull(@personID, '') = '' )
                   ) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 订金金额 #dj_02 ----------------------------------------------------
            SELECT TEMP.ShopCode            AS ShopCode,
                   SUM(TEMP.customizeValue) AS customizeValue
            INTO   #dj_02
            FROM   (SELECT Isnull(t2.s_se_c_customizeValue, 0) AS customizeValue,
                           S_SE_SB_ShopCode                    AS ShopCode
                    FROM   uview_SalesBasic t1
                           INNER JOIN S_Se_Customize t2
                             ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                                AND t1.S_SE_SB_ValueFlag = '1'
                    WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND s_se_sb_posid = @personID )
                                  OR Isnull(@personID, '') = '' )
                     UNION ALL
                    SELECT Isnull(t2.s_se_c_customizeValue, 0) AS customizeValue,
                           S_SE_SB_ShopCode                    AS ShopCode
                    FROM   uview_SalesBasic t1
                           INNER JOIN S_Se_CustomizeTui t2
                             ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                                AND t1.S_SE_SB_ValueFlag = '1'
                    WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= CONVERT(VARCHAR(10), @bgndate, 23)
                           AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND s_se_sb_posid = @personID )
                                  OR Isnull(@personID, '') = '' )
                    ) TEMP
            GROUP  BY TEMP.ShopCode

            ---- 维修费 #wx_02 ----------------------------------------------------
            SELECT TEMP.ShopCode AS ShopCode,
                   TEMP.wxfy     AS wxfy
            INTO   #wx_02
            FROM   (SELECT S_CR_RD_ShopCode                 AS ShopCode,
                           Isnull(SUM(S_CR_RD_Money), 0.00) AS wxfy
                    FROM   S_CR_RepairsCostDetails
                    WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= CONVERT(VARCHAR(10), Getdate(), 23)
                           AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                           AND S_CR_RD_Casher IS NOT NULL
                           AND ( ( Isnull(@shopCode, '') <> ''
                                   AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                            FROM   #salesDepartments) )
                                  OR ( Isnull(@shopCode, '') = '' ) )
                           AND ( ( Isnull(@personID, '') <> ''
                                   AND S_CR_RD_Casher = @personID )
                                  OR Isnull(@personID, '') = '' )
                    GROUP  BY S_CR_RD_ShopCode) TEMP

            --------拼装执行SQL---------------------------------------
            SET @select = 'select (''' + @bgndate + '--' + @enddate + ''') as queryDate,' + 'departmentId AS departmentId,' + 'departmentName AS departmentName,' + 'sum(glassesAmount) as glassesAmount,' + 'sum(frameAmount) as frameAmount,' + 'sum(eyeglassesAmount) as eyeglassesAmount,' + 'sum(frameAssistAmount) as frameAssistAmount,' + 'sum(yxAssistAmount) as yxAssistAmount,' + 'sum(contactAmount) as contactAmount,' + 'sum(contactAssistAmount) as contactAssistAmount,' + 'sum(othersAmount) as othersAmount,' + 'sum(discountAmount) as discountAmount,' + 'sum(amount) as amount,' + 'sum(inspectionNum) as inspectionNum,' + 'sum(inspectionAmount) as inspectionAmount,' + 'sum(glassesBillNum) as glassesBillNum, ' + 'sum(oldAmount) as oldAmount, ' + 'sum(shineAmount) as shineAmount, ' + 'sum(arrearsAmount) as arrearsAmount, ' + 'sum(customizeAmount) as customizeAmount, ' + 'sum(wxAmount) as wxAmount '
            SET @select = @select + ' from ( '
            SET @select = @select + ' select ' + 'R_CQT_OS_DepartmentId AS departmentId,' + 'B_DP_DepartmentName AS departmentName,' + 'sum(R_CQT_OS_glassesAmount) as glassesAmount,' + 'sum(R_CQT_OS_frameAmount) as frameAmount,' + 'sum(R_CQT_OS_eyeglassesAmount) as eyeglassesAmount,' + 'sum(R_CQT_OS_frameAssistAmount) as frameAssistAmount,' + 'sum(R_CQT_OS_yxAssistAmount) as yxAssistAmount,' + 'sum(R_CQT_OS_contactAmount) as contactAmount,' + 'sum(R_CQT_OS_contactAssistAmount) as contactAssistAmount,' + 'sum(R_CQT_OS_discountAmount) as discountAmount,' + 'sum(R_CQT_OS_inspectionNum) as inspectionNum,' + 'sum(R_CQT_OS_inspectionAmount) as inspectionAmount,' + 'sum(R_CQT_OS_glassesBillNum) as glassesBillNum,' + 'sum(R_CQT_OS_otherAmount) as othersAmount,' + 'sum(R_CQT_OS_amount) as amount, ' + 'sum(R_CQT_OS_oldAmount) as oldAmount, ' + 'sum(R_CQT_OS_shineAmount) as shineAmount, ' + '0 as arrearsAmount, ' + '0 as customizeAmount, ' + 'sum(R_CQT_OS_WxAmount) as wxAmount '
            SET @select = @select + ' from R_casherQTOnlyStore '
            SET @select = @select + ' INNER JOIN B_Departments ON R_CQT_OS_DepartmentId = B_DP_DepartmentID '
            SET @select = @select + ' where  R_CQT_OS_Date>=''' + @bgndate + ''' and R_CQT_OS_Date<=convert(char(10), dateadd(day,-1, ''' + @enddate + '''),120)  '
            SET @select = @select + ' and ((ISNULL(''' + @shopCode + ''','''')<>'''' AND R_CQT_OS_DepartmentId in (select departmentID from #salesDepartments)) OR (ISNULL(''' + @shopCode + ''','''')=''''))'
            SET @select = @select + ' and ((ISNULL(''' + @personID + ''','''')<>'''' and R_CQT_OS_personID = ''' + @personID + ''') or ISNULL(''' + @personID + ''','''')='''')'
            SET @select = @select + ' group by R_CQT_OS_DepartmentId,B_DP_DepartmentName'
            SET @select = @select + ' union all'
            ------------------------****************************--------------------------
            SET @select = @select + ' select ' + '#personinfo_02.ShopCode as departmentId,' + '#personinfo_02.departmentName as departmentName, ' + 'isnull(#jp_02.glassesAmount,0.0) as glassesAmount, ' + 'isnull(#jj_02.frameAmount,0.0) as frameAmount, ' + 'isnull(#cj_01.eyeglassesAmount,0.0) as eyeglassesAmount, ' + 'isnull(#jzfl_02.frameAssistAmount,0.0) as frameAssistAmount, ' + 'isnull(#yxfl_02.yxAssistAmount,0.0) as yxAssistAmount, ' + 'isnull(#yx_02.contactAmount,0.0) as contactAmount, ' + 'isnull(#hly_02.contactAssistAmount,0.0) as contactAssistAmount, ' + 'isnull(#zk_02.discountAmount,0.0) as discountAmount, ' + 'isnull(#jcsj_02.inspectionNum,0.0) as inspectionNum, ' + 'isnull(#jcsj_02.inspectionAmount,0.0) as inspectionAmount, ' + 'isnull(glassesBillNum,0.0) as glassesBillNum, ' + 'isnull(#qt_02.othersAmount,0.0) as othersAmount, ' + 'isnull(#fjfy_02.amount,0.0) as amount, ' + 'isnull(#cj_02.eyeglassesAmount,0.0) as oldAmount, ' +
                          'isnull(#sg_02.othersAmount,0.0) as shineAmount, ' +
                                        'isnull(#qk_02.arrearsAmount,0.0) as arrearsAmount, ' + 'isnull(#dj_02.customizeValue,0.0) as customizeAmount, ' + 'isnull(#wx_02.wxfy,0.0) as wxAmount '
            SET @from = ' from #personinfo_02 '
            SET @from = @from + 'left join #jp_02 on #personinfo_02.ShopCode = #jp_02.ShopCode '
            SET @from = @from + 'left join #jj_02 on #personinfo_02.ShopCode = #jj_02.ShopCode '
            SET @from = @from + 'left join #cj_01 on #personinfo_02.ShopCode = #cj_01.ShopCode '
            SET @from = @from + 'left join #cj_02 on #personinfo_02.ShopCode = #cj_02.ShopCode '
            SET @from = @from + 'left join #jzfl_02 on #personinfo_02.ShopCode = #jzfl_02.ShopCode '
            SET @from = @from + 'left join #yxfl_02 on #personinfo_02.ShopCode = #yxfl_02.ShopCode '
            SET @from = @from + 'left join #yx_02 on #personinfo_02.ShopCode = #yx_02.ShopCode '
            SET @from = @from + 'left join #hly_02 on #personinfo_02.ShopCode = #hly_02.ShopCode '
            SET @from = @from + 'left join #sg_02 on #personinfo_02.ShopCode = #sg_02.ShopCode '
            SET @from = @from + 'left join #zk_02 on #personinfo_02.ShopCode = #zk_02.ShopCode '
            SET @from = @from + 'left join #jcsj_02 on #personinfo_02.ShopCode = #jcsj_02.ShopCode '
            SET @from = @from + 'left join #ygrc_02 on #personinfo_02.ShopCode = #ygrc_02.ShopCode '
            SET @from = @from + 'left join #pjds_02 on #personinfo_02.ShopCode = #pjds_02.ShopCode '
            SET @from = @from + 'left join #fjfy_02 on #personinfo_02.ShopCode = #fjfy_02.ShopCode '
            SET @from = @from + 'left join #qt_02 on #personinfo_02.ShopCode = #qt_02.ShopCode '
            SET @from = @from + 'left join #qk_02 on #personinfo_02.ShopCode = #qk_02.ShopCode '
            SET @from = @from + 'left join #dj_02 on #personinfo_02.ShopCode = #dj_02.ShopCode '
            SET @from = @from + 'left join #wx_02 on #personinfo_02.ShopCode = #wx_02.ShopCode '
            SET @where = ' 1=1 and ((ISNULL(''' + @shopCode + ''','')<>'' AND #personinfo_02.ShopCode in (select departmentID from #salesDepartments)) OR (ISNULL(''' + @shopCode + ''','')='')) and ((ISNULL(''' + @personID + ''','')<>'''' ) '
            SET @sql = @select + @from + ' )temp2 group by departmentId,departmentName order by departmentId'

            --  print(@sql)
            EXEC(@sql)

            DROP TABLE #personinfo_02

            DROP TABLE #jp_02

            DROP TABLE #jj_02

            DROP TABLE #cj_01

            DROP TABLE #cj_02

            DROP TABLE #jzfl_02

            DROP TABLE #yxfl_02

            DROP TABLE #yx_02

            DROP TABLE #hly_02

            DROP TABLE #qt_02

            DROP TABLE #sg_02

            DROP TABLE #zk_02

            DROP TABLE #jcsj_02

            DROP TABLE #ygrc_02

            DROP TABLE #pjds_02

            DROP TABLE #fjfy_02

            DROP TABLE #qk_02

            DROP TABLE #dj_02

            DROP TABLE #wx_02
        END
  END
ELSE
  BEGIN
      ----3、当日数据汇总-----------------------------------------------------------
      ---- 人员信息临时表 #personinfo_03 -------------------------------------------
      SELECT DISTINCT departmentId        AS ShopCode,
                      B_DP_DepartmentName AS departmentName
      INTO   #personinfo_03
      FROM   (SELECT DISTINCT S_SE_SB_ShopCode AS departmentId
              FROM   uview_SalesBasic
              WHERE  CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_posid = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION
              SELECT DISTINCT S_SE_SB_ShopCode AS departmentId
              FROM   uview_SalesBasic
              WHERE  CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SB_WithdrawPersonID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION
              SELECT DISTINCT S_CR_RD_ShopCode AS departmentId
              FROM   S_CR_RegisteredDetails
              WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_CR_RD_Casher = @personID )
                            OR Isnull(@personID, '') = '' )
                     AND Isnull(S_CR_RD_Casher, '') <> ''
              UNION
              SELECT DISTINCT S_CR_RD_ShopCode AS departmentId
              FROM   S_CR_RepairsCostDetails
              WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                     AND Isnull(S_CR_RD_Casher, '') <> ''
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_CR_RD_Casher = @personID )
                            OR Isnull(@personID, '') = '' )) person
             INNER JOIN B_Departments
               ON departmentId = B_DP_DepartmentID
      ORDER  BY departmentId

      ---- 镜片金额 #jp_03 ----------------------------------------------------
      SELECT SUM(TEMP.glassesAmount1) + SUM(TEMP.glassesAmount2) AS glassesAmount,
             TEMP.ShopCode                                       AS ShopCode
      INTO   #jp_03
      FROM   (SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                     CAST(Isnull(S_SE_SCR_CpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                     CAST(Isnull(S_SE_SCR_DzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                          AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_CpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                     -CAST(Isnull(S_SE_SCR_DzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 镜架金额 #jj_03 -------------------------------------------------------
      SELECT SUM(TEMP.frameAmount) AS frameAmount,
             TEMP.ShopCode         AS ShopCode
      INTO   #jj_03
      FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                     CAST(Isnull(S_SE_SCR_JjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_JjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 成镜金额 #cj_03 -------------------------------------------------------
      SELECT SUM(TEMP.eyeglassesAmount) AS eyeglassesAmount,
             TEMP.ShopCode              AS ShopCode
      INTO   #cj_03
      FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     CAST(Isnull(S_SE_SCR_TyjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_TyjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 老花金额 #cj_03 -------------------------------------------------------
      SELECT SUM(TEMP.eyeglassesAmount) AS eyeglassesAmount,
             TEMP.ShopCode              AS ShopCode
      INTO   #cj_04
      FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     CAST(Isnull(S_SE_SCR_LhjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_LhjPrice, '0.0') AS DECIMAL(18, 2)) AS eyeglassesAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 镜架辅料金额 #jzfl_03 --------------------------------------------------
      SELECT SUM(TEMP.frameAssistAmount) AS frameAssistAmount,
             TEMP.ShopCode               AS ShopCode
      INTO   #jzfl_03
      FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                     CAST(Isnull(S_SE_SCR_PjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_PjPrice, '0.0') AS DECIMAL(18, 2)) AS frameAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 隐形辅料金额 #jzfl_03 --------------------------------------------------
      SELECT SUM(TEMP.yxAssistAmount) AS yxAssistAmount,
             TEMP.ShopCode            AS ShopCode
      INTO   #yxfl_03
      FROM   (SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                     CAST(Isnull(S_SE_SCR_PjyxPrice, '0.0') AS DECIMAL(18, 2)) AS yxAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                          AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_PjyxPrice, '0.0') AS DECIMAL(18, 2)) AS yxAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 隐形金额 #yx_03 -------------------------------------------------------
      SELECT SUM(TEMP.glassesAmount1) + SUM(TEMP.glassesAmount2) AS contactAmount,
             TEMP.ShopCode                                       AS ShopCode
      INTO   #yx_03
      FROM   (SELECT S_SE_SCR_ShopCode                                           AS ShopCode,
                     CAST(Isnull(S_SE_SCR_YxcpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                     CAST(Isnull(S_SE_SCR_YxdzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                            AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_YxcpjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount1,
                     -CAST(Isnull(S_SE_SCR_YxdzjpPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount2
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 护理液金额 #hly_03 -------------------------------------------------------
      SELECT SUM(TEMP.contactAssistAmount) AS contactAssistAmount,
             TEMP.ShopCode                 AS ShopCode
      INTO   #hly_03
      FROM   (SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     CAST(Isnull(S_SE_SCR_HlyPrice, '0.0') AS DECIMAL(18, 2)) AS contactAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                         AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_HlyPrice, '0.0') AS DECIMAL(18, 2)) AS contactAssistAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 折扣金额 #zk_03 -------------------------------------------------------
      SELECT SUM(TEMP.discountAmount) AS discountAmount,
             TEMP.ShopCode            AS ShopCode
      INTO   #zk_03
      FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                     CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 检查数量，检查金额 #jcsj_03 -------------------------------------------
      SELECT *
      INTO   #jcsj_03
      FROM   (SELECT S_CR_RD_ShopCode                AS ShopCode,
                     COUNT(*)                        AS inspectionNum,
                     SUM(Isnull(S_CR_RD_Money, 0.0)) AS inspectionAmount
              FROM   S_CR_RegisteredDetails
              WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                     AND S_CR_RD_Flag = '1'
                     -- AND S_CR_RD_ShopCode = @shopCode
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_CR_RD_Casher = @personID )
                            OR Isnull(@personID, '') = '' )
              GROUP  BY S_CR_RD_ShopCode) jcsj

      ---- 验光人次 #ygrc_03 -----------------------------------------------------
      SELECT *
      INTO   #ygrc_03
      FROM   (SELECT ( SUM(optometry) - SUM(unoptometry) ) AS optometryPersonTime,
                     ShopCode                              AS ShopCode
              FROM   (SELECT COUNT(*)         AS optometry,
                             0                AS unoptometry,
                             S_CR_RD_Casher   AS s_se_sb_PosID,
                             S_CR_RD_ShopCode AS ShopCode
                      FROM   S_CR_RegisteredDetails t1
                             INNER JOIN F_RegisteredCategory t2
                               ON t1.S_CR_RD_RegisteredID = t2.F_RC_ID
                                  AND t2.F_RC_ID IN ( '8', '9', '21', '23',
                                                      '24', '25', '26', '27', '28' )
                      WHERE  CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) >= @bgndate
                             AND CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) <= @enddate
                      GROUP  BY S_CR_RD_Casher,
                                S_CR_RD_ShopCode
                      UNION ALL
                      SELECT 0                AS optometry,
                             COUNT(*)         AS unoptometry,
                             S_CR_RD_Casher   AS s_se_sb_PosID,
                             S_CR_RD_ShopCode AS ShopCode
                      FROM   S_CR_RegisteredDetails t1
                             INNER JOIN F_RegisteredCategory t2
                               ON t1.S_CR_RD_RegisteredID = t2.F_RC_ID
                                  AND t2.F_RC_ID IN ( '10', '11', '29', '30',
                                                      '31', '32', '33', '34', '35' )
                      WHERE  CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) >= @bgndate
                             AND CONVERT(VARCHAR(10), S_CR_RD_OptDate, 23) <= @enddate
                      GROUP  BY S_CR_RD_Casher,
                                S_CR_RD_ShopCode) t
              WHERE  1 = 1
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND ShopCode IN (SELECT departmentID
                                              FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              GROUP  BY ShopCode) ygrc

      -- 配镜单数 #pjds_03 -----------------------------------------------------
      SELECT COUNT(*)      AS glassesBillNum,
             TEMP.ShopCode AS ShopCode
      INTO   #pjds_03
      FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                     CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_DiscountPrice, '0.0') AS DECIMAL(18, 2)) AS discountAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      -- 附加费用 #fjfy_03 -----------------------------------------------------
      SELECT SUM(TEMP.amount) AS amount,
             TEMP.ShopCode    AS ShopCode
      INTO   #fjfy_03
      FROM   (SELECT S_SE_SCR_ShopCode                                             AS ShopCode,
                     CAST(Isnull(S_SE_SCR_AdditionPrice, '0.0') AS DECIMAL(18, 2)) AS amount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                              AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_AdditionPrice, '0.0') AS DECIMAL(18, 2)) AS amount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 其他商品金额 #jp_03 ----------------------------------------------------
      SELECT SUM(TEMP.othersAmount) AS othersAmount,
             TEMP.ShopCode          AS ShopCode
      INTO   #qt_03
      FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                     CAST(Isnull(S_SE_SCR_HcPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_HcPrice, '0.0') AS DECIMAL(18, 2)) AS glassesAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 视光金额 #sg_03 ----------------------------------------------------
      SELECT SUM(TEMP.othersAmount) AS othersAmount,
             TEMP.ShopCode          AS ShopCode
      INTO   #sg_03
      FROM   (SELECT S_SE_SCR_ShopCode                                       AS ShopCode,
                     CAST(Isnull(S_SE_SCR_SgPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '0'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT S_SE_SCR_ShopCode                                        AS ShopCode,
                     -CAST(Isnull(S_SE_SCR_SgPrice, '0.0') AS DECIMAL(18, 2)) AS othersAmount
              FROM   S_SE_SalerCashierRecord
              WHERE  S_SE_SCR_WithdrawFlag = '1'
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_SE_SCR_PosDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SCR_ShopCode IN (SELECT departmentID
                                                       FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_SE_SCR_PosID = @personID )
                            OR Isnull(@personID, '') = '' )) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 欠款金额 #qk_02 ----------------------------------------------------
      SELECT TEMP.ShopCode           AS ShopCode,
             SUM(TEMP.arrearsAmount) AS arrearsAmount
      INTO   #qk_03
      FROM   (SELECT Isnull(t2.s_se_c_arrearsValue, 0) AS arrearsAmount,
                     S_SE_SB_ShopCode                  AS ShopCode
              FROM   uview_SalesBasic t1
                     INNER JOIN S_Se_Customize t2
                       ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                          AND t1.S_SE_SB_ValueFlag = '1'
              WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_posid = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT Isnull(t2.s_se_c_arrearsValue, 0) AS arrearsAmount,
                     S_SE_SB_ShopCode                  AS ShopCode
              FROM   uview_SalesBasic t1
                     INNER JOIN S_Se_CustomizeTui t2
                       ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                          AND t1.S_SE_SB_ValueFlag = '1'
              WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_posid = @personID )
                            OR Isnull(@personID, '') = '' )
             ) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 订金金额 #dj_02 ----------------------------------------------------
      SELECT TEMP.ShopCode            AS ShopCode,
             SUM(TEMP.customizeValue) AS customizeValue
      INTO   #dj_03
      FROM   (SELECT Isnull(t2.s_se_c_customizeValue, 0) AS customizeValue,
                     S_SE_SB_ShopCode                    AS ShopCode
              FROM   uview_SalesBasic t1
                     INNER JOIN S_Se_Customize t2
                       ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                          AND t1.S_SE_SB_ValueFlag = '1'
              WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_posid = @personID )
                            OR Isnull(@personID, '') = '' )
              UNION ALL
              SELECT Isnull(t2.s_se_c_customizeValue, 0) AS customizeValue,
                     S_SE_SB_ShopCode                    AS ShopCode
              FROM   uview_SalesBasic t1
                     INNER JOIN S_Se_CustomizeTui t2
                       ON t1.S_SE_Sb_SalesID = t2.s_se_c_salesid
                          AND t1.S_SE_SB_ValueFlag = '1'
              WHERE  CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), s_se_c_arrearsDate, 23) <= @enddate
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND s_se_sb_posid = @personID )
                            OR Isnull(@personID, '') = '' )
             ) TEMP
      GROUP  BY TEMP.ShopCode

      ---- 维修费 #wx_03 ----------------------------------------------------
      SELECT TEMP.ShopCode AS ShopCode,
             TEMP.wxfy     AS wxfy
      INTO   #wx_03
      FROM   (SELECT S_CR_RD_ShopCode                 AS ShopCode,
                     Isnull(SUM(S_CR_RD_Money), 0.00) AS wxfy
              FROM   S_CR_RepairsCostDetails
              WHERE  CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) >= @bgndate
                     AND CONVERT(VARCHAR(10), S_CR_RD_CasherDate, 23) <= @enddate
                     AND S_CR_RD_Casher IS NOT NULL
                     AND ( ( Isnull(@shopCode, '') <> ''
                             AND S_CR_RD_ShopCode IN (SELECT departmentID
                                                      FROM   #salesDepartments) )
                            OR ( Isnull(@shopCode, '') = '' ) )
                     AND ( ( Isnull(@personID, '') <> ''
                             AND S_CR_RD_Casher = @personID )
                            OR Isnull(@personID, '') = '' )
              GROUP  BY S_CR_RD_ShopCode) TEMP

      ------拼装执行Sql-------------------------------------------------------------------
      SET @select = ' select (''' + @bgndate + '--' + @enddate + ''') as queryDate,' + '#personinfo_03.ShopCode as departmentId, ' + '#personinfo_03.departmentName as departmentName, '
                     --			+ '#personinfo_03.S_SE_SB_ShopCode, '
                     --			+ '#personinfo_03.B_DP_DepartmentName as departmentName, '
                     + 'sum(isnull(#jp_03.glassesAmount,0.0)) as glassesAmount, ' + 'sum(isnull(#jj_03.frameAmount,0.0)) as frameAmount, ' + 'sum(isnull(#cj_03.eyeglassesAmount,0.0)) as eyeglassesAmount, ' + 'sum(isnull(#jzfl_03.frameAssistAmount,0.0)) as frameAssistAmount, ' + 'sum(isnull(#yxfl_03.yxAssistAmount,0.0)) as yxAssistAmount, ' + 'sum(isnull(#yx_03.contactAmount,0.0)) as contactAmount, ' + 'sum(isnull(#hly_03.contactAssistAmount,0.0)) as contactAssistAmount, ' + 'sum(isnull(#zk_03.discountAmount,0.0)) as discountAmount, ' + 'sum(isnull(#jcsj_03.inspectionNum,0.0)) as inspectionNum, ' + 'sum(isnull(#jcsj_03.inspectionAmount,0.0)) as inspectionAmount, ' + 'sum(isnull(glassesBillNum,0.0)) as glassesBillNum, ' + 'sum(isnull(#qt_03.othersAmount,0.0)) as othersAmount, ' + 'sum(isnull(#fjfy_03.amount,0.0)) as amount, ' + 'sum(isnull(#cj_04.eyeglassesAmount,0.0)) as oldAmount, ' + 'sum(isnull(#sg_03.othersAmount,0.0)) as shineAmount,' +
                    'sum(isnull(#qk_03.arrearsAmount,0.0)) as arrearsAmount, ' +
                                  'sum(isnull(#dj_03.customizeValue,0.0)) as customizeAmount, ' + 'sum(isnull(#wx_03.wxfy,0.0)) as wxAmount '
      SET @from = ' from #personinfo_03 '
      SET @from = @from + 'left join #jp_03 on #personinfo_03.ShopCode = #jp_03.ShopCode '
      SET @from = @from + 'left join #jj_03 on #personinfo_03.ShopCode = #jj_03.ShopCode '
      SET @from = @from + 'left join #cj_03 on #personinfo_03.ShopCode = #cj_03.ShopCode '
      SET @from = @from + 'left join #cj_04 on #personinfo_03.ShopCode = #cj_04.ShopCode '
      SET @from = @from + 'left join #jzfl_03 on #personinfo_03.ShopCode = #jzfl_03.ShopCode '
      SET @from = @from + 'left join #yxfl_03 on #personinfo_03.ShopCode = #yxfl_03.ShopCode '
      SET @from = @from + 'left join #yx_03 on #personinfo_03.ShopCode = #yx_03.ShopCode '
      SET @from = @from + 'left join #hly_03 on #personinfo_03.ShopCode = #hly_03.ShopCode '
      SET @from = @from + 'left join #zk_03 on #personinfo_03.ShopCode = #zk_03.ShopCode '
      SET @from = @from + 'left join #jcsj_03 on #personinfo_03.ShopCode = #jcsj_03.ShopCode '
      SET @from = @from + 'left join #ygrc_03 on #personinfo_03.ShopCode = #ygrc_03.ShopCode '
      SET @from = @from + 'left join #pjds_03 on #personinfo_03.ShopCode = #pjds_03.ShopCode '
      SET @from = @from + 'left join #fjfy_03 on #personinfo_03.ShopCode = #fjfy_03.ShopCode '
      SET @from = @from + 'left join #qt_03 on #personinfo_03.ShopCode = #qt_03.ShopCode '
      SET @from = @from + 'left join #sg_03 on #personinfo_03.ShopCode = #sg_03.ShopCode '
      SET @from = @from + 'left join #qk_03 on #personinfo_03.ShopCode = #qk_03.ShopCode '
      SET @from = @from + 'left join #dj_03 on #personinfo_03.ShopCode = #dj_03.ShopCode '
      SET @from = @from + 'left join #wx_03 on #personinfo_03.ShopCode = #wx_03.ShopCode '
      SET @where = ' 1=1 and ((ISNULL(''' + @shopCode + ''','')<>'' AND #personinfo_03.S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) OR (ISNULL(''' + @shopCode + ''','')='')) '
      SET @sql = @select + @from + ' group by #personinfo_03.ShopCode,#personinfo_03.departmentName order by departmentId'

      --print(@sql)
      EXEC(@sql)

      DROP TABLE #personinfo_03

      DROP TABLE #jp_03

      DROP TABLE #jj_03

      DROP TABLE #cj_03

      DROP TABLE #cj_04

      DROP TABLE #jzfl_03

      DROP TABLE #yxfl_03

      DROP TABLE #yx_03

      DROP TABLE #hly_03

      DROP TABLE #zk_03

      DROP TABLE #jcsj_03

      DROP TABLE #ygrc_03

      DROP TABLE #pjds_03

      DROP TABLE #fjfy_03

      DROP TABLE #qt_03

      DROP TABLE #sg_03

      DROP TABLE #qk_03

      DROP TABLE #dj_03

      DROP TABLE #wx_03
  END

DROP TABLE #salesDepartments ]]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="customAmountName"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 '${customAmountName}' as customAmountName,'${ShopCodeName}' as ShopCodeName,'${queryWay}'  as queryWay,'${lookWay}' as lookWay

]]></Query>
</TableData>
<TableData name="ds4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startTime"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
DECLARE @bgnDate  VARCHAR(10),
        @endDate  VARCHAR(10),
        @shopCode VARCHAR(4000)

SET @bgnDate='${startTime}'
SET @endDate='${endTime}'
SET @shopCode='${departmentid}'

IF ( Object_id('tempdb..#saleslog') IS NOT NULL )
  DROP TABLE #saleslog

IF ( Object_id('tempdb..#salesDepartments') IS NOT NULL )
  DROP TABLE #salesDepartments

SELECT departmentID
INTO   #salesDepartments
FROM   Sales_createshopcodetab(@shopCode)

SELECT dptid,
       dptname,
       paytype,
       conid,
       price,
       arramount,
       iprice
INTO   #saleslog
FROM   (SELECT S_SE_SL_ShopCode                 AS dptid,
               B_DP_DepartmentName              AS dptname,
               S_SE_SL_PaymentType              AS paytype,
               S_SE_SL_ConsumptionID            AS conid,
               Isnull(S_SE_SL_Price, 0)         AS price,
               0                                AS arramount,
               Isnull(S_SE_SL_IntegralPrice, 0) AS iprice
        FROM   S_SE_SalesLog
               INNER JOIN B_Departments
                 ON B_DP_DepartmentID = S_SE_SL_ShopCode
        WHERE  ( ( Isnull(@shopCode, '') <> ''
                   AND S_SE_SL_ShopCode IN (SELECT departmentID
                                            FROM   #salesDepartments) )
                  OR Isnull(@shopCode, '') = '' )
               AND ( ( Isnull(@bgnDate, '') <> ''
                       AND CONVERT(VARCHAR(10), S_SE_SL_DateTime, 120) >= @bgnDate )
                      OR Isnull(@bgnDate, '') = '' )
               AND ( ( Isnull(@endDate, '') <> ''
                       AND CONVERT(VARCHAR(10), S_SE_SL_DateTime, 120) <= @endDate )
                      OR Isnull(@endDate, '') = '' ))TEMP

SELECT dptid,
       dptname AS dptname,
       a1      AS xj,
       a2      AS zl,
       a3      AS yhk,
       a4      AS czk,
       a5      AS jf,
       a6      AS qt,
       a7      as hj
FROM   (SELECT dptid,
               dptname                                                                                                                                                                       AS dptname,
               Isnull(SUM(Isnull(CAST(a1 AS NUMERIC(30, 2)), 0)), 0)                                                                                                                         AS a1,
               Isnull(SUM(Isnull(CAST(a2 AS NUMERIC(30, 2)), 0)), 0)                                                                                                                         AS a2,
               Isnull(SUM(Isnull(CAST(a3 AS NUMERIC(30, 2)), 0)), 0)                                                                                                                         AS a3,
               Isnull(SUM(Isnull(CAST(a4 AS NUMERIC(30, 2)), 0)), 0)                                                                                                                         AS a4,
               Isnull(SUM(Isnull(CAST(a5 AS NUMERIC(30, 2)), 0)), 0)                                                                                                                         AS a5,
               Isnull(SUM(Isnull(CAST(a6 AS NUMERIC(30, 2)), 0)), 0) AS a6,
               Isnull(SUM(Isnull(CAST(a1 AS NUMERIC(30, 2)), 0) + Isnull(CAST(a3 AS NUMERIC(30, 2)), 0) + Isnull(CAST(a4 AS NUMERIC(30, 2)), 0) + Isnull(CAST(a5 AS NUMERIC(30, 2)), 0)+ Isnull(CAST(a6 AS NUMERIC(30, 2)), 0) + Isnull(CAST(a2 AS NUMERIC(30, 2)), 0)), 0) AS a7
        FROM   (
               -- 全款(现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      CAST(price AS NUMERIC(30, 2)) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '1'
               UNION ALL
               -- 订金(现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      CAST(price AS NUMERIC(30, 2)) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '1'
               UNION ALL
               -- 补齐(现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      CAST(price AS NUMERIC(30, 2)) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '1'
               UNION ALL
               -- 退款(现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                                   AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '1'
               UNION ALL
               -- 无配镜单退款(现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '1'
               UNION ALL
               -- 挂号费(现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      CAST(price AS NUMERIC(30, 2)) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '1'
               UNION ALL
               -- 退挂号费(现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '7'
                      AND conid = '1'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      CAST(price AS NUMERIC(30, 2)) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '1'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '1'
               UNION ALL
               -- 找零(现金)
               SELECT dptid                                            AS dptid,
                      dptname                                          AS dptname,
                      -Abs(CAST(Isnull(price, '0') AS NUMERIC(30, 2))) AS a1,
                      0                                                AS a2,
                      0                                                AS a3,
                      0                                                AS a4,
                      0                                                AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  conid = '5'
               union all
               ------------------------------------------------------------------------------------------------------------------------------------------------
               -- 全款(代金券)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      CAST(price AS NUMERIC(30, 2)) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '7'
               UNION ALL
               -- 订金(代金券)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      CAST(price AS NUMERIC(30, 2)) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '7'
               UNION ALL
               -- 补齐(代金券)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      CAST(price AS NUMERIC(30, 2)) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '7'
               UNION ALL
               -- 退款(代金券)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '7'
               UNION ALL
               -- 无配镜单退款(代金券)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '7'
               UNION ALL
               -- 挂号费(代金券)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      CAST(price AS NUMERIC(30, 2)) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '7'
               UNION ALL
               -- 退挂号费(代金券)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '7'
                      AND conid = '7'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      CAST(price AS NUMERIC(30, 2)) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '7'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '7'

               ------------------------------------------------------------------------------------------------------------------------------------------------
               UNION ALL
               -- 全款(银行卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      CAST(price AS NUMERIC(30, 2)) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '3'
               UNION ALL
               -- 订金(银行卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      CAST(price AS NUMERIC(30, 2)) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '3'
               UNION ALL
               -- 补齐(银行卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      CAST(price AS NUMERIC(30, 2)) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '3'
               UNION ALL
               -- 退款(银行卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '3'
               UNION ALL
               -- 无配镜单退款(银行卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '3'
               UNION ALL
               -- 挂号费(银行卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      CAST(price AS NUMERIC(30, 2)) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '3'
               UNION ALL
               -- 退挂号费(银行卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '7'
                      AND conid = '3'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      CAST(price AS NUMERIC(30, 2)) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '3'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '3'
               ---------------------------------------------------------------------------------------------------------------------------------------------------
               UNION ALL
               -- 全款(非现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      CAST(price AS NUMERIC(30, 2)) AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '6'
               UNION ALL
               -- 订金(非现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      CAST(price AS NUMERIC(30, 2)) AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '6'
               UNION ALL
               -- 补齐(非现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      CAST(price AS NUMERIC(30, 2)) AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '6'
               UNION ALL
               -- 退款(非现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '6'
               UNION ALL
               -- 无配镜单退款(非现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '6'
               UNION ALL
               -- 挂号费(非现金)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      CAST(price AS NUMERIC(30, 2)) AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '6'
               UNION ALL
               -- 退挂号费(非现金)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      0                                   AS a5,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a6
               FROM   #saleslog
               WHERE  paytype = '7'
                      AND conid = '6'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      CAST(price AS NUMERIC(30, 2)) AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '6'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      0                             AS a4,
                      0                             AS a5,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '6'
               ---------------------------------------------------------------------------------------------------------------------------------------------------
               UNION ALL
               -- 全款(储值卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      CAST(price AS NUMERIC(30, 2)) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '4'
               UNION ALL
               -- 订金(储值卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      CAST(price AS NUMERIC(30, 2)) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '4'
               UNION ALL
               -- 补齐(储值卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      CAST(price AS NUMERIC(30, 2)) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '4'
               UNION ALL
               -- 退款(储值卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '4'
               UNION ALL
               -- 无配镜单退款(储值卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '4'
               UNION ALL
               -- 挂号费(储值卡)
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      CAST(price AS NUMERIC(30, 2)) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '4'
               UNION ALL
               -- 退挂号费(储值卡)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a4,
                      0                                   AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '7'
                      AND conid = '4'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      CAST(price AS NUMERIC(30, 2)) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '4'
               UNION ALL
               
               SELECT dptid                         AS dptid,
                      dptname                       AS dptname,
                      0                             AS a1,
                      0                             AS a2,
                      0                             AS a3,
                      -Abs(CAST(price AS NUMERIC(30, 2))) AS a4,
                      0                             AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '4'
               -------------------------------------------------------------------------------------------------------------------------------------------------
               UNION ALL
               -- 全款(积分)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '1'
                      AND conid = '2'
               UNION ALL
               -- 订金(积分)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '2'
                      AND conid = '2'
               UNION ALL
               -- 补齐(积分)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '3'
                      AND conid = '2'
               UNION ALL
               -- 退款(积分)
               SELECT dptid                                AS dptid,
                      dptname                              AS dptname,
                      0                                    AS a1,
                      0                                    AS a2,
                      0                                    AS a3,
                      0                                    AS a4,
                      -Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '4'
                      AND conid = '2'
               UNION ALL
               -- 无配镜单退款(积分)
               SELECT dptid                                AS dptid,
                      dptname                              AS dptname,
                      0                                    AS a1,
                      0                                    AS a2,
                      0                                    AS a3,
                      0                                    AS a4,
                      -Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '5'
                      AND conid = '2'
               UNION ALL
               -- 挂号费(积分)
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '6'
                      AND conid = '2'
                UNION ALL
                -- 退挂号费(积分)
                SELECT dptid                                AS dptid,
                       dptname                              AS dptname,
                       0                                    AS a1,
                       0                                    AS a2,
                       0                                    AS a3,
                       0                                    AS a4,
                       -Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
                FROM   #saleslog
                WHERE  paytype = '7'
                       AND conid = '2'
               UNION ALL
               
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '8'
                      AND conid = '2'
               UNION ALL
               
               SELECT dptid                               AS dptid,
                      dptname                             AS dptname,
                      0                                   AS a1,
                      0                                   AS a2,
                      0                                   AS a3,
                      0                                   AS a4,
                      -Abs(CAST(iprice AS NUMERIC(30, 2))) AS a5,
                      0                             AS a6
               FROM   #saleslog
               WHERE  paytype = '10'
                      AND conid = '2'
)TEMP
        GROUP  BY dptname,
                  dptid)TEMP
ORDER  BY dptid,
          a6 DESC

DROP TABLE #saleslog

DROP TABLE #salesDepartments ]]></Query>
</TableData>
<TableData name="ds5" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startTime"/>
<O>
<![CDATA[2014-04-01]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O>
<![CDATA[2014-04-10]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select departmentID into #salesDepartments from sales_createShopCodeTab('${departmentid}')
select S_CR_RD_ShopCode,sum(S_CR_RD_Money) as fxfy from S_CR_RepairsCostDetails
where convert(varchar(10), S_CR_RD_CasherDate, 23) >='${startTime}'
and convert(varchar(10), S_CR_RD_CasherDate, 23) <='${endTime}' 
and ((ISNULL('${departmentid}','')<>'' AND S_CR_RD_ShopCode  in (select departmentID from #salesDepartments)) OR (ISNULL('${departmentid}','')=''))
group by S_CR_RD_ShopCode
drop table #salesDepartments]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.page.First">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-First')}]]></Text>
<IconName>
<![CDATA[first]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Previous">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Previous')}]]></Text>
<IconName>
<![CDATA[previous]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.PageNavi">
<WidgetAttr/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Next">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Next')}]]></Text>
<IconName>
<![CDATA[next]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Last">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Last')}]]></Text>
<IconName>
<![CDATA[last]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.Export">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Export')}]]></Text>
<IconName>
<![CDATA[export]]></IconName>
<Buttons pdf="true" excelP="true" excelO="true" excelS="true" word="true" image="true" html="true"/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<Report class="com.fr.report.WorkSheet" name="数据页签">
<ReportPageAttr>
<HR F="0" T="7"/>
<FR F="10" T="10"/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[914400,914400,723900,914400,914400,914400,914400,914400,914400,914400,914400,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[576000,0,2438400,288000,419100,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,1728000,2438400,1728000,2324100,1584000,1584000,1584000,1584000,2362200,1600200,0,2743200,0,0,0,0,0,0,0,0,0,0,0,0,1752600,2743200]]></ColumnWidth>
<CellElementList>
<C c="2" r="0" cs="37" s="0">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="1" cs="37" s="1">
<O>
<![CDATA[收银员工作量统计]]></O>
<Expand/>
</C>
<C c="2" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="7" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="8" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="10" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="11" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="15" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="16" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="17" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="18" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="19" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="23" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="38" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="3" cs="2" s="2">
<O>
<![CDATA[部门名称：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="3" cs="14" s="3">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="ShopCodeName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="20" r="3" cs="19" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="查询日期：" + $startTime + " 至 " + $endTime]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="4" cs="2" s="2">
<O>
<![CDATA[订金方式：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="4" cs="14" s="3">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="customAmountName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="18" r="4" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="19" r="4" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="4" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="23" r="4">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="4">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="38" r="4">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="5" cs="2" s="2">
<O>
<![CDATA[查询方式：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="5" cs="14" s="3">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="queryWay"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="18" r="5" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="19" r="5" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="5" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="23" r="5">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="5">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="38" r="5">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="6" cs="2" s="2">
<O>
<![CDATA[查看分类：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="6" cs="14" s="3">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="lookWay"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="18" r="6" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="19" r="6" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="6" s="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="23" r="6">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="6">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="38" r="6">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="7" cs="3" s="5">
<O>
<![CDATA[销售门店]]></O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand extendable="1"/>
</C>
<C c="5" r="7" s="6">
<O>
<![CDATA[镜片]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[1]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[2]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="6" r="7" s="6">
<O>
<![CDATA[镜架]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[3]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[4]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="7" r="7" s="6">
<O>
<![CDATA[太阳镜]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[5]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[6]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="8" r="7" s="6">
<O>
<![CDATA[镜架配件]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[7]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[8]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="9" r="7" s="6">
<O>
<![CDATA[隐形配件]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[39]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[40]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="10" r="7" s="6">
<O>
<![CDATA[隐形]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[9]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[10]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="11" r="7" s="6">
<O>
<![CDATA[护理液]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[11]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[12]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="12" r="7" s="6">
<O>
<![CDATA[老花镜]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[13]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[14]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="13" r="7" s="6">
<O>
<![CDATA[视光]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[15]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[16]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="14" r="7" s="6">
<O>
<![CDATA[耗材]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[17]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[18]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="15" r="7" s="6">
<O>
<![CDATA[商品应收]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[19]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[20]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="16" r="7" s="6">
<O>
<![CDATA[附加费]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[21]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[22]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="17" r="7" s="6">
<O>
<![CDATA[配镜应收]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[23]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[24]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="18" r="7" s="6">
<O>
<![CDATA[检查数]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[25]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[26]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="19" r="7" s="6">
<O>
<![CDATA[检查费]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[27]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[28]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="20" r="7" s="6">
<O>
<![CDATA[配镜数]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[29]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[30]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="21" r="7" s="6">
<O>
<![CDATA[维修费]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[21]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[22]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="22" r="7" s="6">
<O>
<![CDATA[应收合计]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[31]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[32]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="23" r="7" s="6">
<O>
<![CDATA[欠款]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[33]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[34]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="24" r="7" s="6">
<O>
<![CDATA[实收合计]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[35]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[36]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="25" r="7" s="6">
<O>
<![CDATA[实收合计]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[35]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[36]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="38" r="7" s="6">
<O>
<![CDATA[订金]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[37]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[38]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="1" r="8">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="departmentId"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0" order="2">
<SortFormula>
<![CDATA[SWITCH($order, "1", -TODOUBLE(F9), "2", TODOUBLE(F9), "3", -TODOUBLE(G9), "4", TODOUBLE(G9), "5", -TODOUBLE(H9), "6", TODOUBLE(H9), "7", -TODOUBLE(I9), "8", TODOUBLE(I9), "9", -TODOUBLE(K9), "10", TODOUBLE(K9), "11", -TODOUBLE(L9), "12", TODOUBLE(L9), "13", -TODOUBLE(M9), "14", TODOUBLE(M9), "15", -TODOUBLE(N9), "16", TODOUBLE(N9), "17", -TODOUBLE(O9), "18", TODOUBLE(O9), "19", -TODOUBLE(P9), "20", TODOUBLE(P9), "21", -TODOUBLE(Q9), "22", TODOUBLE(Q9), "23", -TODOUBLE(R9), "24", TODOUBLE(R9), "25", -TODOUBLE(S9), "26", TODOUBLE(S9), "27", -TODOUBLE(T9), "28", TODOUBLE(T9), "29", -TODOUBLE(U9), "30", TODOUBLE(U9), "31", -TODOUBLE(W9), "32", TODOUBLE(W9), "33", -TODOUBLE(X9), "34", TODOUBLE(X9), "35", -TODOUBLE(Y9), "36", TODOUBLE(Y9), "37", -TODOUBLE(AM9), "38", TODOUBLE(AM9), "39", -TODOUBLE(J9), "40", TODOUBLE(J9))]]></SortFormula>
</Expand>
</C>
<C c="2" r="8" cs="3" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="departmentName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="countperfrom"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$countperfrom]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierOnlyStoreRpt3.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&countperfrom="+countperfrom+"&logincompanyid="+logincompanyid;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="5" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="glassesAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[3]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt3.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="6" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="frameAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[1]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt3.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="7" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="eyeglassesAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[6]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt3.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="8" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="frameAssistAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[2]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[1]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="9" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="yxAssistAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[2]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C10]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[2]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="10" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="contactAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[4]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="11" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="contactAssistAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[5]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="12" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="oldAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[8]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="13" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="shineAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[9]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="14" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="othersAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[7]]></O>
</Parameter>
<Parameter>
<Attributes name="startTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endTime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="iscustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="accessoriesType"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyStore_brandRpt.cpt&__bypagesize__=false&categoryid="+categoryid+"&startTime="+startTime+"&endTime="+endTime+"&departmentid="+departmentid+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&iscustomize="+iscustomize+"&viewname="+EncodeUtf8(viewname)+"&logincompanyid="+logincompanyid+"&accessoriesType="+accessoriesType;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="15" r="8" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(F9 + G9 + H9 + I9 +J9 + K9 + L9 + M9 + N9 + O9))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="16" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="amount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="17" r="8" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(P9, Q9))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="18" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="inspectionNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="19" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="inspectionAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="20" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="glassesBillNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="21" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="wxAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="22" r="8" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(R9, T9, V9))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="23" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="arrearsAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="24" r="8" s="7">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="hj"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[3]]></O>
</Parameter>
<Parameter>
<Attributes name="begintime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endtime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopcode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyTypeDetails.cpt&__bypagesize__=false&categoryid="+categoryid+"&begintime="+begintime+"&endtime="+endtime+"&shopcode="+shopcode+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&viewname="+EncodeUtf8(viewname);

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="25" r="8" s="7">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(AB9 + AD9 + AF9 + AH9 + AJ9 + AL9))]]></Attributes>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="categoryid"/>
<O>
<![CDATA[3]]></O>
</Parameter>
<Parameter>
<Attributes name="begintime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$startTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endtime"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endTime]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopcode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E5]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="ShopCodeName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="queryWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E6]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="lookWay"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=E7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="viewname"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C2]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="countperfrom"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$countperfrom]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_CashierManyTypeDetails.cpt&__bypagesize__=false&categoryid="+categoryid+"&begintime="+begintime+"&endtime="+endtime+"&shopcode="+shopcode+"&customAmountName="+EncodeUtf8(customAmountName)+"&ShopCodeName="+EncodeUtf8(ShopCodeName)+"&queryWay="+EncodeUtf8(queryWay)+"&lookWay="+EncodeUtf8(lookWay)+"&showCompanyName="+EncodeUtf8(showCompanyName)+"&isShow="+isShow+"&viewname="+EncodeUtf8(viewname)+"&countperfrom="+countperfrom+"&logincompanyid="+logincompanyid;

openWindowForReport(DataURL);

]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand/>
</C>
<C c="26" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="xj"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="27" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("1", $countperfrom) != 0, AA9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="28" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="jf"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="29" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("2", $countperfrom) != 0, AC9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="30" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="yhk"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="31" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("3", $countperfrom) != 0, AE9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="32" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="czk"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="33" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("4", $countperfrom) != 0, AG9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="34" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="zl"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="35" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("7", $countperfrom) != 0, AI9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="36" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="qt"/>
<Condition class="com.fr.data.condition.ListCondition">
<JoinCondition join="0">
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[1]]></CNUMBER>
<CNAME>
<![CDATA[dptid]]></CNAME>
<Compare op="0">
<SimpleDSColumn dsName="ds1" columnName="departmentId"/>
</Compare>
</Condition>
</JoinCondition>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="37" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=IF(FIND("6", $countperfrom) != 0, AK9, 0.00)]]></Attributes>
</O>
<Expand/>
</C>
<C c="38" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="customizeAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="9" cs="3" s="10">
<O>
<![CDATA[合计：]]></O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="5" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(F9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="6" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(G9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="7" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(H9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="8" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(I9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="9" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(J9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="10" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(K9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="11" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(L9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="12" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(M9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="13" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(N9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="14" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(O9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="15" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(P9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="16" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(Q9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="17" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(R9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="18" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(S9)]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="19" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(T9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="20" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(U9)]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="21" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(V9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="22" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(W9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="23" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(X9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="24" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(Y9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="25" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(Z9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="38" r="9" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(AM9))]]></Attributes>
</O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="2" r="10" cs="7" s="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期:" + TODAY()]]></Attributes>
</O>
<Expand/>
</C>
<C c="23" r="10" cs="16" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="页次:第 " + $$page_number + " 页/共 " + $$totalPage_number + " 页"]]></Attributes>
</O>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<Margin top="986400" left="0" bottom="986400" right="0"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="黑体" style="1" size="112"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="72" foreground="-16776961" underline="1"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
</StyleList>
</WorkBook>
