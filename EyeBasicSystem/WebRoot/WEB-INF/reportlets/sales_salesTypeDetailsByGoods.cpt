<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT dbo.S_SE_SalesBasic.S_SE_SB_SalesID,
       dbo.S_SE_SalesBasic.S_SE_SB_ShopCode,
       dbo.S_SE_SalesBasic.S_SE_SB_TakeGlassData,
       dbo.S_SE_SalesBasic.S_SE_SB_SalesType,
       dbo.S_SE_SalesBasic.S_SE_SB_PosDatetime,
       dbo.S_SE_SalesBasic.S_SE_SB_PriceSum,
       dbo.S_SE_SalesBasic.S_SE_SB_SalesValue,
       dbo.S_SE_SalesBasic.S_SE_SB_DiscountRate,
       dbo.S_SE_SalesDetail.S_SE_SD_SalesItemID,
       dbo.S_SE_SalesDetail.S_SE_SD_SalesItemName,
       dbo.S_SE_SalesDetail.S_SE_SD_Number,
       dbo.S_SE_SalesDetail.S_SE_SD_PriceSum,
       dbo.S_SE_SalesDetail.S_SE_SD_SalesValue,
       dbo.S_SE_SalesDetail.S_SE_SD_Sprice,
       dbo.S_SE_SalesDetail.S_SE_SD_DiscountNum,
       dbo.S_SE_SalesDetail.S_SE_SD_CommoditiesFlag,
       S_SE_SD_DiscountRate
FROM   dbo.S_SE_SalesBasic
       INNER JOIN dbo.S_SE_SalesDetail
         ON dbo.S_SE_SalesBasic.S_SE_SB_SalesID = dbo.S_SE_SalesDetail.S_SE_SD_SalesID
WHERE  ( ( Isnull('${salesid}', '') <> ''
           AND Isnull('${salesid}', '') = S_SE_SB_SalesID )
          OR ( Isnull('${salesid}', '') = '' ) )
UNION ALL
SELECT dbo.S_SE_SalesBasic.S_SE_SB_SalesID,
       dbo.S_SE_SalesBasic.S_SE_SB_ShopCode,
       dbo.S_SE_SalesBasic.S_SE_SB_TakeGlassData,
       dbo.S_SE_SalesBasic.S_SE_SB_SalesType,
       dbo.S_SE_SalesBasic.S_SE_SB_PosDatetime,
       -dbo.S_SE_SalesBasic.S_SE_SB_PriceSum,
       -dbo.S_SE_SalesBasic.S_SE_SB_SalesValue,
       dbo.S_SE_SalesBasic.S_SE_SB_DiscountRate,
       dbo.S_SE_SalesDetail.S_SE_SD_SalesItemID,
       dbo.S_SE_SalesDetail.S_SE_SD_SalesItemName,
       -dbo.S_SE_SalesDetail.S_SE_SD_Number,
       -dbo.S_SE_SalesDetail.S_SE_SD_PriceSum,
       -dbo.S_SE_SalesDetail.S_SE_SD_SalesValue,
       -dbo.S_SE_SalesDetail.S_SE_SD_Sprice,
       dbo.S_SE_SalesDetail.S_SE_SD_DiscountNum,
       dbo.S_SE_SalesDetail.S_SE_SD_CommoditiesFlag,
       S_SE_SD_DiscountRate
FROM   dbo.S_SE_SalesBasic
       INNER JOIN dbo.S_SE_SalesDetail
         ON dbo.S_SE_SalesBasic.S_SE_SB_SalesID = dbo.S_SE_SalesDetail.S_SE_SD_SalesID
WHERE  S_SE_SB_WithdrawFlag = '1'
       AND ( ( Isnull('${salesid}', '') <> ''
               AND Isnull('${salesid}', '') = S_SE_SB_SalesID )
              OR ( Isnull('${salesid}', '') = '' ) ) 
union all
SELECT S_SE_SB_SalesID,
       S_SE_SB_ShopCode,
       S_SE_SB_TakeGlassData,
       S_SE_SB_SalesType,
       S_SE_SB_PosDatetime,
       S_SE_SB_PriceSum,
       S_SE_SB_SalesValue,
       S_SE_SB_DiscountRate,
       S_SE_SD_SalesItemID,
       S_SE_SD_SalesItemName,
       S_SE_SD_Number,
       S_SE_SD_PriceSum,
       S_SE_SD_SalesValue,
       S_SE_SD_Sprice,
       S_SE_SD_DiscountNum,
       S_SE_SD_CommoditiesFlag,
       S_SE_SD_DiscountRate
FROM   dbo.S_SE_SalesBasic_Finished
       INNER JOIN dbo.S_SE_SalesDetail_Finished
         ON S_SE_SB_SalesID = S_SE_SD_SalesID
WHERE  ( ( Isnull('${salesid}', '') <> ''
           AND Isnull('${salesid}', '') = S_SE_SB_SalesID )
          OR ( Isnull('${salesid}', '') = '' ) )
UNION ALL
SELECT S_SE_SB_SalesID,
       S_SE_SB_ShopCode,
       S_SE_SB_TakeGlassData,
       S_SE_SB_SalesType,
       S_SE_SB_PosDatetime,
       -S_SE_SB_PriceSum,
       -S_SE_SB_SalesValue,
       S_SE_SB_DiscountRate,
       S_SE_SD_SalesItemID,
       S_SE_SD_SalesItemName,
       -S_SE_SD_Number,
       -S_SE_SD_PriceSum,
       -S_SE_SD_SalesValue,
       -S_SE_SD_Sprice,
       S_SE_SD_DiscountNum,
       S_SE_SD_CommoditiesFlag,
       S_SE_SD_DiscountRate
FROM   dbo.S_SE_SalesBasic_Finished
       INNER JOIN dbo.S_SE_SalesDetail_Finished
         ON S_SE_SB_SalesID = S_SE_SD_SalesID
WHERE  S_SE_SB_WithdrawFlag = '1'
       AND ( ( Isnull('${salesid}', '') <> ''
               AND Isnull('${salesid}', '') = S_SE_SB_SalesID )
              OR ( Isnull('${salesid}', '') = '' ) ) ]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1
 isnull(sum(isnull(S_SE_Amount,0)*isnull(S_SE_Number,0)),0) as fujia from S_SE_AdditionalCDetail where S_SE_SalesID='${salesid}'
]]></Query>
</TableData>
<TableData name="ds4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select isnull(sum(a1),0) as yj,isnull(sum(a2),0) as ys from (
select S_SE_SB_PriceSum as a1,S_SE_SB_SalesValue as a2 from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' and S_SE_SB_SalesID='${salesid}'
union all
select -S_SE_SB_PriceSum as a1,-S_SE_SB_SalesValue as a2 from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' and S_SE_SB_SalesID='${salesid}' and S_SE_SB_WithdrawFlag='1'
union all
select S_SE_SB_PriceSum as a1,S_SE_SB_SalesValue as a2 from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' and S_SE_SB_SalesID='${salesid}'
union all
select -S_SE_SB_PriceSum as a1,-S_SE_SB_SalesValue as a2 from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' and S_SE_SB_SalesID='${salesid}' and S_SE_SB_WithdrawFlag='1'
)temp]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.page.First">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-First')}]]></Text>
<IconName>
<![CDATA[first]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Previous">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Previous')}]]></Text>
<IconName>
<![CDATA[previous]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.PageNavi">
<WidgetAttr/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Next">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Next')}]]></Text>
<IconName>
<![CDATA[next]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Last">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Last')}]]></Text>
<IconName>
<![CDATA[last]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.Export">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Export')}]]></Text>
<IconName>
<![CDATA[export]]></IconName>
<Buttons pdf="true" excelP="true" excelO="true" excelS="true" word="true" image="true" html="true"/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="3"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[1371600,1485900,495300,914400,914400,914400,914400,723900,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[6629400,6591300,6781800,3657600,4724400,5067300,2743200,2743200,2743200,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="6" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" cs="6" s="1">
<O>
<![CDATA[销售结款方式统计表(商品明细)]]></O>
<Expand/>
</C>
<C c="0" r="3" s="2">
<O>
<![CDATA[配镜单号]]></O>
<Expand/>
</C>
<C c="1" r="3" s="2">
<O>
<![CDATA[商品代码]]></O>
<Expand/>
</C>
<C c="2" r="3" s="2">
<O>
<![CDATA[商品名称]]></O>
<Expand/>
</C>
<C c="3" r="3" s="2">
<O>
<![CDATA[商品数量]]></O>
<Expand/>
</C>
<C c="4" r="3" s="2">
<O>
<![CDATA[原价金额]]></O>
<Expand/>
</C>
<C c="5" r="3" s="2">
<O>
<![CDATA[应收金额]]></O>
<Expand/>
</C>
<C c="0" r="4" rs="2" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SB_SalesID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SD_SalesItemID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SD_SalesItemName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SD_Number"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SD_PriceSum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="S_SE_SD_SalesValue"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="5" cs="2" s="4">
<O>
<![CDATA[其他费用：]]></O>
<Expand leftParentDefault="false" left="A5"/>
</C>
<C c="3" r="5" cs="3" s="5">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="fujia"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="6" cs="3" s="6">
<O>
<![CDATA[合计:]]></O>
<Expand/>
</C>
<C c="3" r="6" s="7">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(D5)]]></Attributes>
</O>
<Expand/>
</C>
<C c="4" r="6" s="8">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="yj"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="6" s="8">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="ys"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="7" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期:" + today()]]></Attributes>
</O>
<Expand/>
</C>
<C c="5" r="7" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="页次:第 "+$$page_number+" 页/共 "+$$totalPage_number+" 页"]]></Attributes>
</O>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="101808000" height="144000000"/>
<Margin top="0" left="0" bottom="0" right="0"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<StyleList>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="黑体" style="1" size="112"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[###0.00]]></Format>
<FRFont name="SimSun" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="黑体" style="1" size="80" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[###0.00]]></Format>
<FRFont name="黑体" style="1" size="80" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
