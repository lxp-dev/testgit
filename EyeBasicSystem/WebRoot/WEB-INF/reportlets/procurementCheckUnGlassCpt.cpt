<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="endtime"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="begintime"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodscategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
C_ST_I_BillID,
convert(varchar(10),C_ST_I_AuditDate,23) as C_ST_I_AuditDate,
C_ST_I_SupplierId,
B_SP_SupplierName,
substring(C_ST_POE_GoodsID,1,7) as C_ST_POE_GoodsID,
B_BD_brandName as B_GI_GoodsName,
isnull(sum(temp.C_ST_PE_OrderNumber),0) as C_ST_PE_OrderNumber,
sum(C_ST_IE_GoodsQuantity) as C_ST_IE_GoodsQuantity,
case
when temp1.C_ST_POE_CoincidenceRate = '' or temp1.C_ST_POE_CoincidenceRate is null then '100.00%'
else temp1.C_ST_POE_CoincidenceRate 
end as C_ST_POE_CoincidenceRate,
temp1.C_ST_PC_BillDate as C_ST_PC_BillDate,
case 
	when temp1.C_ST_POE_Pack = '1' then '√'
	when temp1.C_ST_POE_Pack = '0' then '×'
end as C_ST_POE_Pack,
case 
	when temp1.C_ST_POE_App = '1' then '√'
	when temp1.C_ST_POE_App = '0' then '×'
end as C_ST_POE_App,
sum(cast(isnull(temp1.C_ST_POE_UnqualifiedQuantity,0) as int)) as C_ST_POE_UnqualifiedQuantity,
cast(cast(sum(cast(isnull(temp1.C_ST_POE_UnqualifiedQuantity,0) as int))/sum(C_ST_IE_GoodsQuantity)*100 as numeric(18, 2)) as varchar) + '%' as C_ST_POE_UnqualifiedRate
from C_ST_InventoryEntry
inner join C_ST_Inventory on C_ST_IE_BillID = C_ST_I_BillID and C_ST_I_BillID like 'pin%'

left join (
select C_ST_PE_PurchaseOrderID,C_ST_PE_OrderNumber,C_ST_PE_goodsID from dbo.C_ST_PO
inner join dbo.C_ST_PoEntry on C_ST_P_ID = C_ST_PE_PurchaseOrderID ) temp
on C_ST_I_SourceBillId = temp.C_ST_PE_PurchaseOrderID and C_ST_PE_goodsID = C_ST_IE_GoodsId
left join (
select C_ST_PC_BillSource,C_ST_POE_GoodsID,C_ST_POE_CoincidenceRate,C_ST_POE_Pack,C_ST_POE_App,
C_ST_POE_UnqualifiedQuantity,C_ST_POE_UnqualifiedRate,C_ST_PC_BillDate
from dbo.C_ST_ProcurementCheckEntry
inner join dbo.C_ST_ProcurementCheck on C_ST_PC_BillID = C_ST_POE_BillID )temp1
on temp1.C_ST_PC_BillSource = C_ST_I_BillID and temp1.C_ST_POE_GoodsID = C_ST_IE_GoodsId
inner join B_Supplier on B_SP_ID = C_ST_I_SupplierId
inner join B_Brand on B_BD_ID = substring(C_ST_POE_GoodsID,6,2) and B_BD_SupplierID = C_ST_I_SupplierId
where 1=1 
 AND ( ( '${supplierID}' IS NOT NULL
                             AND '${supplierID}' <> ''
                             AND C_ST_I_SupplierId = '${supplierID}' )
                            OR ( '${supplierID}' IS NULL
                                 OR '${supplierID}' = '' ) )
 AND convert(varchar(10),temp1.C_ST_PC_BillDate,23) >= '${begintime}'
 AND convert(varchar(10),temp1.C_ST_PC_BillDate,23) <= '${endtime}'
 AND ( ( '${goodscategoryID}' IS NOT NULL
                             AND '${goodscategoryID}' <> ''
                             AND substring(substring(C_ST_POE_GoodsID,1,7),1,1) = '${goodscategoryID}')
                            OR ( '${goodscategoryID}' IS NULL
                                 OR '${goodscategoryID}' = '' ) )
AND substring(substring(C_ST_POE_GoodsID,1,7),1,1) <> '3'
AND substring(substring(C_ST_POE_GoodsID,1,7),1,1) <> '4'
AND substring(substring(C_ST_POE_GoodsID,1,7),1,1) <> '5'
group by 
C_ST_I_BillID,
C_ST_I_AuditDate,
C_ST_I_SupplierId,
B_SP_SupplierName,
substring(C_ST_POE_GoodsID,1,7),
B_BD_brandName,
temp1.C_ST_POE_CoincidenceRate,
temp1.C_ST_POE_Pack,
temp1.C_ST_POE_App,
temp1.C_ST_PC_BillDate]]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="6"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[1028700,685800,1562100,723900,723900,723900,723900,914400,914400,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[2552700,5105400,6096000,2247900,4953000,2171700,2286000,1981200,2400300,2324100,2819400,2209800,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="8" s="0">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="1" cs="4" s="1">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="TRVC/QR-07-013  " + DATE(YEAR(), MONTH(), DAY())]]></Attributes>
</O>
<Expand/>
</C>
<C c="0" r="2" cs="12" s="2">
<O>
<![CDATA[非镜片商品进货检验记录]]></O>
<Expand/>
</C>
<C c="1" r="3" cs="2">
<O>
<![CDATA[镜架、成镜、辅料及其他材料类]]></O>
<Expand/>
</C>
<C c="7" r="3" cs="2" s="3">
<O>
<![CDATA[TY/Q]]></O>
<Expand/>
</C>
<C c="1" r="4">
<O>
<![CDATA[]]></O>
<Expand/>
</C>
<C c="0" r="5" rs="2" s="4">
<O>
<![CDATA[日期]]></O>
<Expand/>
</C>
<C c="1" r="5" rs="2" s="4">
<O>
<![CDATA[收货单号]]></O>
<Expand/>
</C>
<C c="2" r="5" rs="2" s="4">
<O>
<![CDATA[制造商]]></O>
<Expand/>
</C>
<C c="3" r="5" rs="2" s="4">
<O>
<![CDATA[商品代码]]></O>
<Expand/>
</C>
<C c="4" r="5" rs="2" s="4">
<O>
<![CDATA[商品名称]]></O>
<Expand/>
</C>
<C c="5" r="5" rs="2" s="4">
<O>
<![CDATA[订单数量]]></O>
<Expand/>
</C>
<C c="6" r="5" rs="2" s="4">
<O>
<![CDATA[收货数量]]></O>
<Expand/>
</C>
<C c="7" r="5" rs="2" s="4">
<O>
<![CDATA[符合率]]></O>
<Expand/>
</C>
<C c="8" r="5" cs="2" s="4">
<O>
<![CDATA[检验内容]]></O>
<Expand/>
</C>
<C c="10" r="5" rs="2" s="4">
<O>
<![CDATA[不合格数量]]></O>
<Expand/>
</C>
<C c="11" r="5" rs="2" s="4">
<O>
<![CDATA[不合格率]]></O>
<Expand/>
</C>
<C c="8" r="6" s="4">
<O>
<![CDATA[包装标识]]></O>
<Expand/>
</C>
<C c="9" r="6" s="4">
<O>
<![CDATA[外观质量]]></O>
<Expand/>
</C>
<C c="0" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_I_AuditDate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_I_BillID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="B_SP_SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_GoodsID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="B_GI_GoodsName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_PE_OrderNumber"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_IE_GoodsQuantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_CoincidenceRate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_Pack"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_App"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_UnqualifiedQuantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="7" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="C_ST_POE_UnqualifiedRate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="8" s="6">
<Expand/>
</C>
<C c="1" r="8" s="5">
<Expand/>
</C>
<C c="2" r="8" s="6">
<Expand/>
</C>
<C c="3" r="8" s="6">
<Expand/>
</C>
<C c="4" r="8" s="6">
<O>
<![CDATA[合计：]]></O>
<Expand/>
</C>
<C c="5" r="8" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(f8)]]></Attributes>
</O>
<Expand/>
</C>
<C c="6" r="8" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(g8)]]></Attributes>
</O>
<Expand/>
</C>
<C c="7" r="8" s="6">
<Expand/>
</C>
<C c="8" r="8" s="6">
<Expand/>
</C>
<C c="9" r="8" s="6">
<Expand/>
</C>
<C c="10" r="8" s="6">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(k8)]]></Attributes>
</O>
<Expand/>
</C>
<C c="11" r="8" s="6">
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1"/>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="112"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="120"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
</StyleList>
</WorkBook>
