<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 ('查询日期:' + '${bgnDate}' + ' ～ '+'${endDate}') as queryDate]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesCost"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxCyljp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endretailamount"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgistealthclassyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodsbigclass"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minCylyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodssmallclass"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgispecjj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnretailamount"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxCylyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphlh"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiismutiluminosityjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiusetypeyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bandID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgieyeglassmaterialtypejp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiframesizejj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="pjlx"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="isCustomize"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphlh"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minCyljp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgirefractivejp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgicolorjj"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT departmentID
INTO   #salesDepartments
FROM   Sales_createshopcodetab('${shopCode}')

--------*********************************************------------------------------------
IF ( '${bgnDate}' < CONVERT(VARCHAR(10), Getdate(), 120) )
  BEGIN
      IF ( '${endDate}' < CONVERT(VARCHAR(10), Getdate(), 120) )
        BEGIN
            SELECT t2.goodsid,
                   t2.goodsname,
                   t2.xsNum2,
                   t2.thNum2,
                   t2.shNum2,
                   t2.thje2,
                   t2.xsje2,
                   t2.shje2,
                   CAST(Isnull(t2.bhsje2, 0.00)AS DECIMAL(18, 2)) AS bhsje2,
                   t2.mlje2,
                   CASE
                     WHEN Isnull(t2.shje2, 0.00) = 0.00 THEN '0%'
                     ELSE CAST(CAST(t2.mlje2 / t2.shje2 * 100 AS DECIMAL(18, 2)) AS VARCHAR(20)) + '%'
                   END                                            AS xsmll2
            FROM   (SELECT CategoryID                         AS goodsid,
                           B_GC_GoodsCategoryName             AS goodsname,
                           SUM(xsNum)                         AS xsNum2,
                           SUM(thNum)                         AS thNum2,
                           SUM(xsNum) + SUM(thNum)            AS shNum2,
                           SUM(thje)                          AS thje2,
                           SUM(xsje)                          AS xsje2,
                           SUM(thje) + SUM(xsje)              AS shje2,
                           SUM(bhsje)                         AS bhsje2,
                           SUM(thje) + SUM(xsje) - SUM(bhsje) AS mlje2
                    FROM   (SELECT R_SD_DSE_ShopCode                      AS ShopCode,
                                   R_RC_DSE_SupplierID                    AS SupplierID,
                                   R_RC_DSE_SupplierName                  AS SupplierName,
                                   Isnull(R_SD_DSE_GoodsNum, 0)           AS xsNum,
                                   0                                      AS thNum,
                                   0                                      AS thje,
                                   Isnull(R_SD_DSE_GoodsAmount, 0)        AS xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
                                   B_GI_ViewGoodsName                     AS goodsname,
                                   R_RC_DSE_GoodsID                       AS GoodsID,
                                   R_RC_DSE_BandID                        AS brandid,
                                   R_RC_DSE_BandName                      AS BrandName,
                                   R_RC_DSE_GoodsCategoryID               AS CategoryID
                            FROM   R_RC_DaySalesEntry
                                   LEFT JOIN B_GoodsInfo
                                     ON B_GI_GoodsID = R_RC_DSE_GoodsID
                            WHERE  R_SD_DSE_SalesType = '1'
                                   AND ( ( Isnull('${shopCode}', '') <> ''
                                           AND R_SD_DSE_ShopCode IN (SELECT departmentID
                                                                     FROM   #salesDepartments) )
                                          OR Isnull('${shopCode}', '') = '' )
                                   AND ( ( Isnull('${bgnDate}', '') <> ''
                                           AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) >= '${bgnDate}' )
                                          OR Isnull('${bgnDate}', '') = '' )
                                   AND ( ( Isnull('${endDate}', '') <> ''
                                           AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) <= '${endDate}' )
                                          OR Isnull('${endDate}', '') = '' )
                                   AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                           AND R_RC_DSE_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                          OR Isnull('${goodsCategoryID}', '') = '' )
                                   AND ( ( Isnull('${supplierID}', '') <> ''
                                           AND R_RC_DSE_SupplierID = Isnull('${supplierID}', '') )
                                          OR Isnull('${supplierID}', '') = '' )
                                   AND ( ( Isnull('${bandID}', '') <> ''
                                           AND R_RC_DSE_BandID = Isnull('${bandID}', '') )
                                          OR Isnull('${bandID}', '') = '' )
                                   AND ( ( Isnull('${goodsID}', '') <> ''
                                           AND R_RC_DSE_GoodsID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                          OR Isnull('${goodsID}', '') = '' )
                                   AND ( ( Isnull('${goodsName}', '') <> ''
                                           AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                          OR Isnull('${goodsName}', '') = '' )
                                   AND ( ( '${bgispecjj}' <> ''
                                           AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                          OR ( '${bgispecjj}' = '' ) ) --型号
                                   AND ( ( '${bgicolorjj}' <> ''
                                           AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                          OR ( '${bgicolorjj}' = '' ) ) --色号
                                   AND ( ( '${bgiframesizejj}' <> ''
                                           AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                          OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                   AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                           AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                          OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                   AND ( ( '${bgirefractivejp}' <> ''
                                           AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                          OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                   AND ( ( '${bgiismutiluminosityjp}' <> ''
                                           AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                          OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                   AND ( ( '${minSphjp}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                          OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                   AND ( ( '${maxSphjp}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                          OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                   AND ( ( '${minCyljp}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                          OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                   AND ( ( '${maxCyljp}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                          OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                   AND ( ( '${bgiusetypeyj}' <> ''
                                           AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                          OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                   AND ( ( '${bgistealthclassyj}' <> ''
                                           AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                          OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                   AND ( ( '${minSphyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                          OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                   AND ( ( '${maxSphyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                          OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                   AND ( ( '${minCylyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                          OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                   AND ( ( '${maxCylyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                          OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                   AND ( ( '${minSphlh}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                          OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                   AND ( ( '${maxSphlh}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                          OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                   AND ( ( '${bgiothergoodsbigclass}' <> ''
                                           AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                          OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                   AND ( ( '${bgiothergoodssmallclass}' <> ''
                                           AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                          OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                   AND ( ( '${bgnretailamount}' <> ''
                                           AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) )
                                          OR ( '${bgnretailamount}' = '' ) )
                                   AND ( ( '${endretailamount}' <> ''
                                           AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) )
                                          OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
                            UNION ALL
                            SELECT R_SD_DSE_ShopCode                      AS ShopCode,
                                   R_RC_DSE_SupplierID                    AS SupplierID,
                                   R_RC_DSE_SupplierName                  AS SupplierName,
                                   0                                      AS xsNum,
                                   Isnull(R_SD_DSE_GoodsNum, 0)           AS thNum,
                                   Isnull(R_SD_DSE_GoodsAmount, 0)        AS thje,
                                   0                                      AS xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
                                   B_GI_ViewGoodsName                     AS goodsname,
                                   R_RC_DSE_GoodsID                       AS GoodsID,
                                   R_RC_DSE_BandID                        AS brandid,
                                   R_RC_DSE_BandName                      AS BrandName,
                                   R_RC_DSE_GoodsCategoryID               AS CategoryID
                            FROM   R_RC_DaySalesEntry
                                   LEFT JOIN B_GoodsInfo
                                     ON B_GI_GoodsID = R_RC_DSE_GoodsID
                            WHERE  R_SD_DSE_SalesType = '2'
                                   AND ( ( Isnull('${shopCode}', '') <> ''
                                           AND R_SD_DSE_ShopCode IN (SELECT departmentID
                                                                     FROM   #salesDepartments) )
                                          OR Isnull('${shopCode}', '') = '' )
                                   AND ( ( Isnull('${bgnDate}', '') <> ''
                                           AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) >= '${bgnDate}' )
                                          OR Isnull('${bgnDate}', '') = '' )
                                   AND ( ( Isnull('${endDate}', '') <> ''
                                           AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) <= '${endDate}' )
                                          OR Isnull('${endDate}', '') = '' )
                                   AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                           AND R_RC_DSE_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                          OR Isnull('${goodsCategoryID}', '') = '' )
                                   AND ( ( Isnull('${supplierID}', '') <> ''
                                           AND R_RC_DSE_SupplierID = Isnull('${supplierID}', '') )
                                          OR Isnull('${supplierID}', '') = '' )
                                   AND ( ( Isnull('${bandID}', '') <> ''
                                           AND R_RC_DSE_BandID = Isnull('${bandID}', '') )
                                          OR Isnull('${bandID}', '') = '' )
                                   AND ( ( Isnull('${goodsID}', '') <> ''
                                           AND R_RC_DSE_GoodsID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                          OR Isnull('${goodsID}', '') = '' )
                                   AND ( ( Isnull('${goodsName}', '') <> ''
                                           AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                          OR Isnull('${goodsName}', '') = '' )
                                   AND ( ( '${bgispecjj}' <> ''
                                           AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                          OR ( '${bgispecjj}' = '' ) ) --型号
                                   AND ( ( '${bgicolorjj}' <> ''
                                           AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                          OR ( '${bgicolorjj}' = '' ) ) --色号
                                   AND ( ( '${bgiframesizejj}' <> ''
                                           AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                          OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                   AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                           AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                          OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                   AND ( ( '${bgirefractivejp}' <> ''
                                           AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                          OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                   AND ( ( '${bgiismutiluminosityjp}' <> ''
                                           AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                          OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                   AND ( ( '${minSphjp}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                          OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                   AND ( ( '${maxSphjp}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                          OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                   AND ( ( '${minCyljp}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                          OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                   AND ( ( '${maxCyljp}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                          OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                   AND ( ( '${bgiusetypeyj}' <> ''
                                           AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                          OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                   AND ( ( '${bgistealthclassyj}' <> ''
                                           AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                          OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                   AND ( ( '${minSphyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                          OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                   AND ( ( '${maxSphyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                          OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                   AND ( ( '${minCylyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                          OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                   AND ( ( '${maxCylyj}' <> ''
                                           AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                          OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                   AND ( ( '${minSphlh}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                          OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                   AND ( ( '${maxSphlh}' <> ''
                                           AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                          OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                   AND ( ( '${bgiothergoodsbigclass}' <> ''
                                           AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                          OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                   AND ( ( '${bgiothergoodssmallclass}' <> ''
                                           AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                          OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                   AND ( ( '${bgnretailamount}' <> ''
                                           AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) )
                                          OR ( '${bgnretailamount}' = '' ) )
                                   AND ( ( '${endretailamount}' <> ''
                                           AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) )
                                          OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
)TEMP
                           LEFT JOIN B_GoodsCategory
                             ON CategoryID = B_GC_ID
                    GROUP  BY CategoryID,
                              B_GC_GoodsCategoryName)t2
            ORDER  BY t2.goodsid
        END
      ELSE
        BEGIN
            SELECT t2.goodsid,
                   t2.goodsname,
                   t2.xsNum2,
                   t2.thNum2,
                   t2.shNum2,
                   t2.thje2,
                   t2.xsje2,
                   t2.shje2,
                   CAST(Isnull(t2.bhsje2, 0.00)AS DECIMAL(18, 2)) AS bhsje2,
                   t2.mlje2,
                   CASE
                     WHEN Isnull(t2.shje2, 0.00) = 0.00 THEN '0%'
                     ELSE CAST(CAST(t2.mlje2 / t2.shje2 * 100 AS DECIMAL(18, 2)) AS VARCHAR(20)) + '%'
                   END                                            AS xsmll2
            FROM   (SELECT CategoryID                         AS goodsid,
                           B_GC_GoodsCategoryName             AS goodsname,
                           SUM(xsNum)                         AS xsNum2,
                           SUM(thNum)                         AS thNum2,
                           SUM(xsNum) + SUM(thNum)            AS shNum2,
                           SUM(thje)                          AS thje2,
                           SUM(xsje)                          AS xsje2,
                           SUM(thje) + SUM(xsje)              AS shje2,
                           SUM(bhsje)                         AS bhsje2,
                           SUM(thje) + SUM(xsje) - SUM(bhsje) AS mlje2
                    FROM   (SELECT CategoryID,
                                   ShopCode,
                                   SupplierID   AS SupplierID,
                                   SupplierName AS SupplierName,
                                   brandid      AS BrandID,
                                   BrandName    AS BrandName,
                                   GoodsID      AS goodsid,
                                   goodsname    AS goodsname,
                                   SUM(xsNum)   AS xsNum,
                                   SUM(thNum)   AS thNum,
                                   SUM(thje)    AS thje,
                                   SUM(xsje)    AS xsje,
                                   SUM(bhsje)   AS bhsje
                            FROM   (SELECT R_SD_DSE_ShopCode                      AS ShopCode,
                                           R_RC_DSE_GoodsCategoryID               AS CategoryID,
                                           R_RC_DSE_SupplierID                    AS SupplierID,
                                           R_RC_DSE_SupplierName                  AS SupplierName,
                                           R_RC_DSE_BandID                        AS brandid,
                                           R_RC_DSE_BandName                      AS BrandName,
                                           Isnull(R_SD_DSE_GoodsNum, 0)           AS xsNum,
                                           R_RC_DSE_GoodsID                       AS GoodsID,
                                           B_GI_ViewGoodsName                     AS goodsname,
                                           0                                      AS thNum,
                                           0                                      AS thje,
                                           Isnull(R_SD_DSE_GoodsAmount, 0)        AS xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
                                    FROM   R_RC_DaySalesEntry
                                           LEFT JOIN B_GoodsInfo
                                             ON B_GI_GoodsID = R_RC_DSE_GoodsID
                                    WHERE  R_SD_DSE_SalesType = '1'
                                           AND ( ( Isnull('${shopCode}', '') <> ''
                                                   AND R_SD_DSE_ShopCode IN (SELECT departmentID
                                                                             FROM   #salesDepartments) )
                                                  OR Isnull('${shopCode}', '') = '' )
                                           AND ( ( Isnull('${bgnDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) >= '${bgnDate}' )
                                                  OR Isnull('${bgnDate}', '') = '' )
                                           AND ( ( Isnull('${endDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) <= CONVERT(CHAR(10), Dateadd(DAY, -1, '${endDate}'), 120) )
                                                  OR Isnull('${endDate}', '') = '' )
                                           AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                                   AND R_RC_DSE_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                                  OR Isnull('${goodsCategoryID}', '') = '' )
                                           AND ( ( Isnull('${supplierID}', '') <> ''
                                                   AND R_RC_DSE_SupplierID = Isnull('${supplierID}', '') )
                                                  OR Isnull('${supplierID}', '') = '' )
                                           AND ( ( Isnull('${bandID}', '') <> ''
                                                   AND R_RC_DSE_BandID = Isnull('${bandID}', '') )
                                                  OR Isnull('${bandID}', '') = '' )
                                           AND ( ( Isnull('${goodsID}', '') <> ''
                                                   AND R_RC_DSE_GoodsID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                                  OR Isnull('${goodsID}', '') = '' )
                                           AND ( ( Isnull('${goodsName}', '') <> ''
                                                   AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                                  OR Isnull('${goodsName}', '') = '' )
                                           AND ( ( '${bgispecjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                                  OR ( '${bgispecjj}' = '' ) ) --型号
                                           AND ( ( '${bgicolorjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                                  OR ( '${bgicolorjj}' = '' ) ) --色号
                                           AND ( ( '${bgiframesizejj}' <> ''
                                                   AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                                  OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                           AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                                  OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                           AND ( ( '${bgirefractivejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                                  OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                           AND ( ( '${bgiismutiluminosityjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                                  OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                           AND ( ( '${minSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                                  OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${maxSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                                  OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${minCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                                  OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${maxCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                                  OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${bgiusetypeyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                                  OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                           AND ( ( '${bgistealthclassyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                                  OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                           AND ( ( '${minSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                                  OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${maxSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                                  OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${minCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                                  OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${maxCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                                  OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${minSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                                  OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                           AND ( ( '${maxSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                                  OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                           AND ( ( '${bgiothergoodsbigclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                                  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                           AND ( ( '${bgiothergoodssmallclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                                  OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                           AND ( ( '${bgnretailamount}' <> ''
                                                   AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) )
                                                  OR ( '${bgnretailamount}' = '' ) )
                                           AND ( ( '${endretailamount}' <> ''
                                                   AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) )
                                                  OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
                                    UNION ALL
                                    SELECT R_SD_DSE_ShopCode                      AS ShopCode,
                                           R_RC_DSE_GoodsCategoryID               AS CategoryID,
                                           R_RC_DSE_SupplierID                    AS SupplierID,
                                           R_RC_DSE_SupplierName                  AS SupplierName,
                                           R_RC_DSE_BandID                        AS brandid,
                                           R_RC_DSE_BandName                      AS BrandName,
                                           0                                      AS xsNum,
                                           R_RC_DSE_GoodsID                       AS GoodsID,
                                           B_GI_ViewGoodsName                     AS goodsname,
                                           Isnull(R_SD_DSE_GoodsNum, 0)           AS thNum,
                                           Isnull(R_SD_DSE_GoodsAmount, 0)        AS thje,
                                           0                                      AS xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
                                    FROM   R_RC_DaySalesEntry
                                           LEFT JOIN B_GoodsInfo
                                             ON B_GI_GoodsID = R_RC_DSE_GoodsID
                                    WHERE  R_SD_DSE_SalesType = '2'
                                           AND ( ( Isnull('${shopCode}', '') <> ''
                                                   AND R_SD_DSE_ShopCode IN (SELECT departmentID
                                                                             FROM   #salesDepartments) )
                                                  OR Isnull('${shopCode}', '') = '' )
                                           AND ( ( Isnull('${bgnDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) >= '${bgnDate}' )
                                                  OR Isnull('${bgnDate}', '') = '' )
                                           AND ( ( Isnull('${endDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), R_SD_DSE_Date, 120) <= CONVERT(CHAR(10), Dateadd(DAY, -1, '${endDate}'), 120) )
                                                  OR Isnull('${endDate}', '') = '' )
                                           AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                                   AND R_RC_DSE_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                                  OR Isnull('${goodsCategoryID}', '') = '' )
                                           AND ( ( Isnull('${supplierID}', '') <> ''
                                                   AND R_RC_DSE_SupplierID = Isnull('${supplierID}', '') )
                                                  OR Isnull('${supplierID}', '') = '' )
                                           AND ( ( Isnull('${bandID}', '') <> ''
                                                   AND R_RC_DSE_BandID = Isnull('${bandID}', '') )
                                                  OR Isnull('${bandID}', '') = '' )
                                           AND ( ( Isnull('${goodsID}', '') <> ''
                                                   AND R_RC_DSE_GoodsID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                                  OR Isnull('${goodsID}', '') = '' )
                                           AND ( ( Isnull('${goodsName}', '') <> ''
                                                   AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                                  OR Isnull('${goodsName}', '') = '' )
                                           AND ( ( '${bgispecjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                                  OR ( '${bgispecjj}' = '' ) ) --型号
                                           AND ( ( '${bgicolorjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                                  OR ( '${bgicolorjj}' = '' ) ) --色号
                                           AND ( ( '${bgiframesizejj}' <> ''
                                                   AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                                  OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                           AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                                  OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                           AND ( ( '${bgirefractivejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                                  OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                           AND ( ( '${bgiismutiluminosityjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                                  OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                           AND ( ( '${minSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                                  OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${maxSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                                  OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${minCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                                  OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${maxCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                                  OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${bgiusetypeyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                                  OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                           AND ( ( '${bgistealthclassyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                                  OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                           AND ( ( '${minSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                                  OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${maxSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                                  OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${minCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                                  OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${maxCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                                  OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${minSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                                  OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                           AND ( ( '${maxSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                                  OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                           AND ( ( '${bgiothergoodsbigclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                                  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                           AND ( ( '${bgiothergoodssmallclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                                  OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                           AND ( ( '${bgnretailamount}' <> ''
                                                   AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) )
                                                  OR ( '${bgnretailamount}' = '' ) )
                                           AND ( ( '${endretailamount}' <> ''
                                                   AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) )
                                                  OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
)TEMP
                            GROUP  BY CategoryID,
                                      ShopCode,
                                      SupplierID,
                                      SupplierName,
                                      brandid,
                                      BrandName,
                                      GoodsID,
                                      goodsname
                            UNION ALL
                            SELECT CategoryID,
                                   ShopCode,
                                   SupplierID   AS SupplierID,
                                   SupplierName AS SupplierName,
                                   brandid      AS brandid,
                                   brandName    AS brandName,
                                   GoodsID      AS goodsid,
                                   goodsname    AS goodsname,
                                   SUM(xsNum)   AS xsNum,
                                   SUM(thNum)   AS thNum,
                                   SUM(thje)    AS thje,
                                   SUM(xsje)    AS xsje,
                                   SUM(bhsje)   AS bhsje
                            FROM   (SELECT S_SE_SB_ShopCode                                              AS ShopCode,
                                           S_SE_SD_CommoditiesFlag                                       AS CategoryID,
                                           B_SP_ID                                                       AS SupplierID,
                                           B_SP_SupplierName                                             AS SupplierName,
                                           B_BD_ID                                                       AS brandid,
                                           B_BD_brandName                                                AS brandName,
                                           S_SE_SD_SalesItemID                                           AS GoodsID,
                                           B_GI_ViewGoodsName                                            AS goodsname,
                                           Isnull(SUM(Isnull(S_SE_SD_Number, 0)), 0)                     AS xsNum,
                                           0                                                             AS thNum,
                                           0                                                             AS thje,
                                           Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)                 AS xsje,
                                     (CASE 
                                         WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje
                                    FROM   S_SE_SalesBasic_Today
                                           INNER JOIN S_SE_SalesDetail_Today
                                             ON S_SE_SB_SalesID = S_SE_SD_SalesID
                                           LEFT JOIN B_GoodsInfo
                                             ON S_SE_SD_SalesItemID = B_GI_GoodsID
                                           LEFT JOIN B_Brand
                                             ON B_BD_ID = B_GI_BrandID
                                                AND B_GI_SupplierID = B_BD_SupplierID
                                           LEFT JOIN B_Supplier
                                             ON B_GI_SupplierID = B_SP_ID
                                    WHERE  S_SE_SB_ValueFlag = '1'
                                           AND ( ( Isnull('${shopCode}', '') <> ''
                                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                                            FROM   #salesDepartments) )
                                                  OR Isnull('${shopCode}', '') = '' )
                                           AND ( ( Isnull('${bgnDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), S_SE_SB_PosDatetime, 120) >= CONVERT(VARCHAR(10), Getdate(), 23) )
                                                  OR Isnull('${bgnDate}', '') = '' )
                                           AND ( ( Isnull('${endDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), S_SE_SB_PosDatetime, 120) <= '${endDate}' )
                                                  OR Isnull('${endDate}', '') = '' )
                                           AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                                   AND B_GI_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                                  OR Isnull('${goodsCategoryID}', '') = '' )
                                           AND ( ( Isnull('${supplierID}', '') <> ''
                                                   AND B_GI_SupplierID = Isnull('${supplierID}', '') )
                                                  OR Isnull('${supplierID}', '') = '' )
                                           AND ( ( Isnull('${bandID}', '') <> ''
                                                   AND B_GI_BrandID = Isnull('${bandID}', '') )
                                                  OR Isnull('${bandID}', '') = '' )
                                           AND ( ( Isnull('${goodsID}', '') <> ''
                                                   AND S_SE_SD_SalesItemID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                                  OR Isnull('${goodsID}', '') = '' )
                                           AND ( ( Isnull('${goodsName}', '') <> ''
                                                   AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                                  OR Isnull('${goodsName}', '') = '' )
                                           AND ( ( '${bgispecjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                                  OR ( '${bgispecjj}' = '' ) ) --型号
                                           AND ( ( '${bgicolorjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                                  OR ( '${bgicolorjj}' = '' ) ) --色号
                                           AND ( ( '${bgiframesizejj}' <> ''
                                                   AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                                  OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                           AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                                  OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                           AND ( ( '${bgirefractivejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                                  OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                           AND ( ( '${bgiismutiluminosityjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                                  OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                           AND ( ( '${minSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                                  OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${maxSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                                  OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${minCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                                  OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${maxCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                                  OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${bgiusetypeyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                                  OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                           AND ( ( '${bgistealthclassyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                                  OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                           AND ( ( '${minSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                                  OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${maxSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                                  OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${minCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                                  OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                           AND ( ( '${maxCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                                  OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${minSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                                  OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                           AND ( ( '${maxSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                                  OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                           AND ( ( '${bgiothergoodsbigclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                                  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                           AND ( ( '${bgiothergoodssmallclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                                  OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                           AND ( ( '${bgnretailamount}' <> ''
                                                   AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) )
                                                  OR ( '${bgnretailamount}' = '' ) )
                                           AND ( ( '${endretailamount}' <> ''
                                                   AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) )
                                                  OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
                                    GROUP  BY S_SE_SD_SalesItemID,
                                              B_GI_ViewGoodsName,
                                              B_BD_ID,
                                              S_SE_SD_CommoditiesFlag,
                                              S_SE_SB_ShopCode,
                                              B_SP_ID,
                                              B_SP_SupplierName,
                                              B_BD_brandName
                                    UNION ALL
                                    SELECT S_SE_SB_ShopCode                                               AS ShopCode,
                                           S_SE_SD_CommoditiesFlag                                        AS CategoryID,
                                           B_SP_ID                                                        AS SupplierID,
                                           B_SP_SupplierName                                              AS SupplierName,
                                           B_BD_ID                                                        AS brandid,
                                           B_BD_brandName                                                 AS brandName,
                                           S_SE_SD_SalesItemID                                            AS GoodsID,
                                           B_GI_ViewGoodsName                                             AS goodsname,
                                           0                                                              AS xsNum,
                                           -Isnull(SUM(Isnull(S_SE_SD_Number, 0)), 0)                     AS thNum,
                                           -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)                 AS thje,
                                           0                                                              AS xsje,
                                     (CASE 
                                         WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0)  
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje
                                    FROM   S_SE_SalesBasic_Today
                                           INNER JOIN S_SE_SalesDetail_Today
                                             ON S_SE_SB_SalesID = S_SE_SD_SalesID
                                           LEFT JOIN B_GoodsInfo
                                             ON S_SE_SD_SalesItemID = B_GI_GoodsID
                                           LEFT JOIN B_Brand
                                             ON B_BD_ID = B_GI_BrandID
                                                AND B_GI_SupplierID = B_BD_SupplierID
                                           LEFT JOIN B_Supplier
                                             ON B_GI_SupplierID = B_SP_ID
                                    WHERE  S_SE_SB_ValueFlag = '1'
                                           AND S_SE_SB_WithdrawFlag = '1'
                                           AND ( ( Isnull('${shopCode}', '') <> ''
                                                   AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                                            FROM   #salesDepartments) )
                                                  OR Isnull('${shopCode}', '') = '' )
                                           AND ( ( Isnull('${bgnDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 120) >= CONVERT(VARCHAR(10), Getdate(), 23) )
                                                  OR Isnull('${bgnDate}', '') = '' )
                                           AND ( ( Isnull('${endDate}', '') <> ''
                                                   AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 120) <= '${endDate}' )
                                                  OR Isnull('${endDate}', '') = '' )
                                           AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                                   AND B_GI_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                                  OR Isnull('${goodsCategoryID}', '') = '' )
                                           AND ( ( Isnull('${supplierID}', '') <> ''
                                                   AND B_GI_SupplierID = Isnull('${supplierID}', '') )
                                                  OR Isnull('${supplierID}', '') = '' )
                                           AND ( ( Isnull('${bandID}', '') <> ''
                                                   AND B_GI_BrandID = Isnull('${bandID}', '') )
                                                  OR Isnull('${bandID}', '') = '' )
                                           AND ( ( Isnull('${goodsID}', '') <> ''
                                                   AND S_SE_SD_SalesItemID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                                  OR Isnull('${goodsID}', '') = '' )
                                           AND ( ( Isnull('${goodsName}', '') <> ''
                                                   AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                                  OR Isnull('${goodsName}', '') = '' )
                                           AND ( ( '${bgispecjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                                  OR ( '${bgispecjj}' = '' ) ) --型号
                                           AND ( ( '${bgicolorjj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                                  OR ( '${bgicolorjj}' = '' ) ) --色号
                                           AND ( ( '${bgiframesizejj}' <> ''
                                                   AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                                  OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                           AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                                  OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                           AND ( ( '${bgirefractivejp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                                  OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                           AND ( ( '${bgiismutiluminosityjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                                  OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                           AND ( ( '${minSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                                  OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${maxSphjp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                                  OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                           AND ( ( '${minCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                                  OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${maxCyljp}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                                  OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                           AND ( ( '${bgiusetypeyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                                  OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                           AND ( ( '${bgistealthclassyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                                  OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                           AND ( ( '${minSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                                  OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${maxSphyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                                  OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                           AND ( ( '${minCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                                  OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${maxCylyj}' <> ''
                                                   AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                                  OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                           AND ( ( '${minSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                                  OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                           AND ( ( '${maxSphlh}' <> ''
                                                   AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                                  OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                           AND ( ( '${bgiothergoodsbigclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                                  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                           AND ( ( '${bgiothergoodssmallclass}' <> ''
                                                   AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                                  OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                           AND ( ( '${bgnretailamount}' <> ''
                                                   AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) )
                                                  OR ( '${bgnretailamount}' = '' ) )
                                           AND ( ( '${endretailamount}' <> ''
                                                   AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) )
                                                  OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识
                                    GROUP  BY S_SE_SD_SalesItemID,
                                              B_GI_ViewGoodsName,
                                              B_BD_ID,
                                              S_SE_SD_CommoditiesFlag,
                                              S_SE_SB_ShopCode,
                                              B_SP_ID,
                                              B_SP_SupplierName,
                                              B_BD_brandName)TEMP
                            GROUP  BY CategoryID,
                                      ShopCode,
                                      SupplierID,
                                      SupplierName,
                                      brandid,
                                      brandName,
                                      goodsid,
                                      goodsname)TEMP
                           LEFT JOIN B_GoodsCategory
                             ON CategoryID = B_GC_ID
                    GROUP  BY CategoryID,
                              B_GC_GoodsCategoryName)t2
            ORDER  BY t2.goodsid
        END
  END
ELSE
  BEGIN
      SELECT t2.goodsid,
             t2.goodsname,
             t2.xsNum2,
             t2.thNum2,
             t2.shNum2,
             t2.thje2,
             t2.xsje2,
             t2.shje2,
             CAST(Isnull(t2.bhsje2, 0.00)AS DECIMAL(18, 2)) AS bhsje2,
             t2.mlje2,
             CASE
               WHEN Isnull(t2.shje2, 0.00) = 0.00 THEN '0%'
               ELSE CAST(CAST(t2.mlje2 / t2.shje2 * 100 AS DECIMAL(18, 2)) AS VARCHAR(20)) + '%'
             END                                            AS xsmll2
      FROM   (SELECT CategoryID                         AS goodsid,
                     B_GC_GoodsCategoryName             AS goodsname,
                     SUM(xsNum)                         AS xsNum2,
                     SUM(thNum)                         AS thNum2,
                     SUM(xsNum) + SUM(thNum)            AS shNum2,
                     SUM(thje)                          AS thje2,
                     SUM(xsje)                          AS xsje2,
                     SUM(thje) + SUM(xsje)              AS shje2,
                     SUM(bhsje)                         AS bhsje2,
                     SUM(thje) + SUM(xsje) - SUM(bhsje) AS mlje2
              FROM   (SELECT CategoryID,
                             ShopCode,
                             SupplierID   AS SupplierID,
                             SupplierName AS SupplierName,
                             brandid      AS brandid,
                             brandName    AS brandName,
                             goodsid      AS goodsid,
                             goodsname    AS goodsname,
                             SUM(xsNum)   AS xsNum,
                             SUM(thNum)   AS thNum,
                             SUM(thje)    AS thje,
                             SUM(xsje)    AS xsje,
                             SUM(bhsje)   AS bhsje
                      FROM   (SELECT S_SE_SB_ShopCode                                              AS ShopCode,
                                     S_SE_SD_CommoditiesFlag                                       AS CategoryID,
                                     B_SP_ID                                                       AS SupplierID,
                                     B_SP_SupplierName                                             AS SupplierName,
                                     B_BD_ID                                                       AS brandid,
                                     B_BD_brandName                                                AS brandName,
                                     S_SE_SD_SalesItemID                                           AS GoodsID,
                                     B_GI_ViewGoodsName                                            AS goodsname,
                                     Isnull(SUM(Isnull(S_SE_SD_Number, 0)), 0)                     AS xsNum,
                                     0                                                             AS thNum,
                                     0                                                             AS thje,
                                     Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)                 AS xsje,
                                     (CASE 
                                         WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje
                              FROM   S_SE_SalesBasic_Today
                                     INNER JOIN S_SE_SalesDetail_Today
                                       ON S_SE_SB_SalesID = S_SE_SD_SalesID
                                     LEFT JOIN B_GoodsInfo
                                       ON S_SE_SD_SalesItemID = B_GI_GoodsID
                                     LEFT JOIN B_Brand
                                       ON B_BD_ID = B_GI_BrandID
                                          AND B_GI_SupplierID = B_BD_SupplierID
                                     LEFT JOIN B_Supplier
                                       ON B_GI_SupplierID = B_SP_ID
                              WHERE  S_SE_SB_ValueFlag = '1'
                                     
                                     AND ( ( Isnull('${shopCode}', '') <> ''
                                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                                      FROM   #salesDepartments) )
                                            OR Isnull('${shopCode}', '') = '' )
                                     AND ( ( Isnull('${bgnDate}', '') <> ''
                                             AND CONVERT(VARCHAR(10), S_SE_SB_PosDatetime, 120) >= '${bgnDate}' )
                                            OR Isnull('${bgnDate}', '') = '' )
                                     AND ( ( Isnull('${endDate}', '') <> ''
                                             AND CONVERT(VARCHAR(10), S_SE_SB_PosDatetime, 120) <='${endDate}' )
                                            OR Isnull('${endDate}', '') = '' )
                                     AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                             AND B_GI_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                            OR Isnull('${goodsCategoryID}', '') = '' )
                                     AND ( ( Isnull('${supplierID}', '') <> ''
                                             AND B_GI_SupplierID = Isnull('${supplierID}', '') )
                                            OR Isnull('${supplierID}', '') = '' )
                                     AND ( ( Isnull('${bandID}', '') <> ''
                                             AND B_GI_BrandID = Isnull('${bandID}', '') )
                                            OR Isnull('${bandID}', '') = '' )
                                     AND ( ( Isnull('${goodsID}', '') <> ''
                                             AND S_SE_SD_SalesItemID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                            OR Isnull('${goodsID}', '') = '' )
                                     AND ( ( Isnull('${goodsName}', '') <> ''
                                             AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                            OR Isnull('${goodsName}', '') = '' )
                                     AND ( ( '${bgispecjj}' <> ''
                                             AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                            OR ( '${bgispecjj}' = '' ) ) --型号
                                     AND ( ( '${bgicolorjj}' <> ''
                                             AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                            OR ( '${bgicolorjj}' = '' ) ) --色号
                                     AND ( ( '${bgiframesizejj}' <> ''
                                             AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                            OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                     AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                             AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                            OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                     AND ( ( '${bgirefractivejp}' <> ''
                                             AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                            OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                     AND ( ( '${bgiismutiluminosityjp}' <> ''
                                             AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                            OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                     AND ( ( '${minSphjp}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                            OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                     AND ( ( '${maxSphjp}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                            OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                     AND ( ( '${minCyljp}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                            OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                     AND ( ( '${maxCyljp}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                            OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                     AND ( ( '${bgiusetypeyj}' <> ''
                                             AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                            OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                     AND ( ( '${bgistealthclassyj}' <> ''
                                             AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                            OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                     AND ( ( '${minSphyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                            OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                     AND ( ( '${maxSphyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                            OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                     AND ( ( '${minCylyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                            OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                     AND ( ( '${maxCylyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                            OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                     AND ( ( '${minSphlh}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                            OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${maxSphlh}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                            OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${bgiothergoodsbigclass}' <> ''
                                             AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                            OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                     AND ( ( '${bgiothergoodssmallclass}' <> ''
                                             AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                            OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                     AND ( ( '${bgnretailamount}' <> ''
                                             AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) )
                                            OR ( '${bgnretailamount}' = '' ) )
                                     AND ( ( '${endretailamount}' <> ''
                                             AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) )
                                            OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识

                              GROUP  BY S_SE_SD_SalesItemID,
                                        B_GI_ViewGoodsName,
                                        B_BD_ID,
                                        S_SE_SD_CommoditiesFlag,
                                        S_SE_SB_ShopCode,
                                        B_SP_ID,
                                        B_SP_SupplierName,
                                        B_BD_brandName
                              UNION ALL
                              SELECT S_SE_SB_ShopCode                                               AS ShopCode,
                                     S_SE_SD_CommoditiesFlag                                        AS CategoryID,
                                     B_SP_ID                                                        AS SupplierID,
                                     B_SP_SupplierName                                              AS SupplierName,
                                     B_BD_ID                                                        AS brandid,
                                     B_BD_brandName                                                 AS brandName,
                                     S_SE_SD_SalesItemID                                            AS GoodsID,
                                     B_GI_ViewGoodsName                                             AS goodsname,
                                     0                                                              AS xsNum,
                                     -Isnull(SUM(Isnull(S_SE_SD_Number, 0)), 0)                     AS thNum,
                                     -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)                 AS thje,
                                     0                                                              AS xsje,
                                     (CASE 
                                         WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0)  
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE 0.00 END )AS bhsje
                              FROM   S_SE_SalesBasic_Today
                                     INNER JOIN S_SE_SalesDetail_Today
                                       ON S_SE_SB_SalesID = S_SE_SD_SalesID
                                     LEFT JOIN B_GoodsInfo
                                       ON S_SE_SD_SalesItemID = B_GI_GoodsID
                                     LEFT JOIN B_Brand
                                       ON B_BD_ID = B_GI_BrandID
                                          AND B_GI_SupplierID = B_BD_SupplierID
                                     LEFT JOIN B_Supplier
                                       ON B_GI_SupplierID = B_SP_ID
                              WHERE  S_SE_SB_ValueFlag = '1'
                                     AND S_SE_SB_WithdrawFlag = '1'
                                     AND ( ( Isnull('${shopCode}', '') <> ''
                                             AND S_SE_SB_ShopCode IN (SELECT departmentID
                                                                      FROM   #salesDepartments) )
                                            OR Isnull('${shopCode}', '') = '' )
                                     AND ( ( Isnull('${bgnDate}', '') <> ''
                                             AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 120) >= '${bgnDate}' )
                                            OR Isnull('${bgnDate}', '') = '' )
                                     AND ( ( Isnull('${endDate}', '') <> ''
                                             AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 120) <= '${endDate}' )
                                            OR Isnull('${endDate}', '') = '' )
                                     AND ( ( Isnull('${goodsCategoryID}', '') <> ''
                                             AND B_GI_GoodsCategoryID = Isnull('${goodsCategoryID}', '') )
                                            OR Isnull('${goodsCategoryID}', '') = '' )
                                     AND ( ( Isnull('${supplierID}', '') <> ''
                                             AND B_GI_SupplierID = Isnull('${supplierID}', '') )
                                            OR Isnull('${supplierID}', '') = '' )
                                     AND ( ( Isnull('${bandID}', '') <> ''
                                             AND B_GI_BrandID = Isnull('${bandID}', '') )
                                            OR Isnull('${bandID}', '') = '' )
                                     AND ( ( Isnull('${goodsID}', '') <> ''
                                             AND S_SE_SD_SalesItemID LIKE '%' + Isnull('${goodsID}', '') + '%' )
                                            OR Isnull('${goodsID}', '') = '' )
                                     AND ( ( Isnull('${goodsName}', '') <> ''
                                             AND B_GI_ViewGoodsName LIKE '%' + Isnull('${goodsName}', '') + '%' )
                                            OR Isnull('${goodsName}', '') = '' )
                                     AND ( ( '${bgispecjj}' <> ''
                                             AND B_GoodsInfo.B_GI_Spec = '${bgispecjj}' )
                                            OR ( '${bgispecjj}' = '' ) ) --型号
                                     AND ( ( '${bgicolorjj}' <> ''
                                             AND B_GoodsInfo.B_GI_Color = '${bgicolorjj}' )
                                            OR ( '${bgicolorjj}' = '' ) ) --色号
                                     AND ( ( '${pjlx}' <> ''
                                             AND B_GoodsInfo.B_GI_AccessoriesType = '${pjlx}' )
                                            OR ( '${pjlx}' = '' ) ) --配件类型
                                     AND ( ( '${bgiframesizejj}' <> ''
                                             AND B_GoodsInfo.B_GI_FrameSize = '${bgiframesizejj}' )
                                            OR ( '${bgiframesizejj}' = '' ) ) --尺寸
                                     AND ( ( '${bgieyeglassmaterialtypejp}' <> ''
                                             AND B_GoodsInfo.B_GI_EyeGlassMaterialType = '${bgieyeglassmaterialtypejp}' )
                                            OR ( '${bgieyeglassmaterialtypejp}' = '' ) ) --镜片材料分类
                                     AND ( ( '${bgirefractivejp}' <> ''
                                             AND B_GoodsInfo.B_GI_Refractive = '${bgirefractivejp}' )
                                            OR ( '${bgirefractivejp}' = '' ) ) --镜片折射率
                                     AND ( ( '${bgiismutiluminosityjp}' <> ''
                                             AND B_GoodsInfo.B_GI_isMutiLuminosity = '${bgiismutiluminosityjp}' )
                                            OR ( '${bgiismutiluminosityjp}' = '' ) ) --镜片光度分类
                                     AND ( ( '${minSphjp}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphjp}' AS FLOAT) )
                                            OR ( '${minSphjp}' = '' ) ) --镜片球镜范围
                                     AND ( ( '${maxSphjp}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphjp}' AS FLOAT) )
                                            OR ( '${maxSphjp}' = '' ) ) --镜片球镜范围
                                     AND ( ( '${minCyljp}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCyljp}' AS FLOAT) )
                                            OR ( '${minCyljp}' = '' ) ) --镜片柱镜范围
                                     AND ( ( '${maxCyljp}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCyljp}' AS FLOAT) )
                                            OR ( '${maxCyljp}' = '' ) ) --镜片柱镜范围
                                     AND ( ( '${bgiusetypeyj}' <> ''
                                             AND B_GoodsInfo.B_GI_UseType = '${bgiusetypeyj}' )
                                            OR ( '${bgiusetypeyj}' = '' ) ) --隐形使用类型
                                     AND ( ( '${bgistealthclassyj}' <> ''
                                             AND B_GoodsInfo.B_GI_StealthClass = '${bgistealthclassyj}' )
                                            OR ( '${bgistealthclassyj}' = '' ) ) --抛弃型分类
                                     AND ( ( '${minSphyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphyj}' AS FLOAT) )
                                            OR ( '${minSphyj}' = '' ) ) --隐形球镜范围
                                     AND ( ( '${maxSphyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphyj}' AS FLOAT) )
                                            OR ( '${maxSphyj}' = '' ) ) --隐形球镜范围
                                     AND ( ( '${minCylyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl >= CAST('${minCylyj}' AS FLOAT) )
                                            OR ( '${minCylyj}' = '' ) ) --隐形柱镜范围
                                     AND ( ( '${maxCylyj}' <> ''
                                             AND B_GoodsInfo.B_GI_Cyl <= CAST('${maxCylyj}' AS FLOAT) )
                                            OR ( '${maxCylyj}' = '' ) ) --隐形柱镜范围
                                     AND ( ( '${minSphlh}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) )
                                            OR ( '${minSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${maxSphlh}' <> ''
                                             AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) )
                                            OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
                                     AND ( ( '${bgiothergoodsbigclass}' <> ''
                                             AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )
                                            OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
                                     AND ( ( '${bgiothergoodssmallclass}' <> ''
                                             AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' )
                                            OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
                                     AND ( ( '${bgnretailamount}' <> ''
                                             AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) )
                                            OR ( '${bgnretailamount}' = '' ) )
                                     AND ( ( '${endretailamount}' <> ''
                                             AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) )
                                            OR ( '${endretailamount}' = '' ) )
AND ( ( '${isCustomize}' <> '' AND B_GoodsInfo.B_GI_isCustomize = '${isCustomize}' ) OR ( '${isCustomize}' = '' ) ) --定做标识

                              GROUP  BY S_SE_SD_SalesItemID,
                                        B_GI_ViewGoodsName,
                                        B_BD_ID,
                                        S_SE_SD_CommoditiesFlag,
                                        S_SE_SB_ShopCode,
                                        B_SP_ID,
                                        B_SP_SupplierName,
                                        B_BD_brandName)TEMP
                      GROUP  BY CategoryID,
                                ShopCode,
                                SupplierID,
                                SupplierName,
                                BrandID,
                                brandName,
                                goodsid,
                                goodsname)TEMP
                     LEFT JOIN B_Departments
                       ON B_DP_DepartmentID = ShopCode
                     LEFT JOIN B_GoodsCategory
                       ON CategoryID = B_GC_ID
              GROUP  BY CategoryID,
                        B_GC_GoodsCategoryName)t2
      ORDER  BY t2.goodsid
  END

DROP TABLE #salesDepartments ]]></Query>
</TableData>
<TableData name="ds4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select departmentID into #salesDepartments from sales_createShopCodeTab('${shopCode}')

select sum(xiaoshou) as xiaoshou from (
select isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' 
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')

union all
select -isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
union all
select isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' 
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')

union all
select -isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')

)temp

drop table #salesDepartments]]></Query>
</TableData>
<TableData name="ds5" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 B_SP_SupplierName from B_Supplier where B_SP_ID = '${supplierID}']]></Query>
</TableData>
<TableData name="ds6" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
if('${goodsCategoryID}' <> '')
begin
	select B_GC_GoodsCategoryName as GoodsCategoryName
	from B_GoodsCategory
	where ((isnull('${goodsCategoryID}','')='' and B_GC_ID in (select B_GC_ID  from 		B_GoodsCategory)) or (isnull('${goodsCategoryID}','')<>'' and B_GC_ID='${goodsCategoryID}'))
end
else
begin
	select '全部' as GoodsCategoryName
end]]></Query>
</TableData>
<TableData name="ds7" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select departmentID into #shopCode from sales_createShopCodeTab('${shopCode}')
select '附加费用' as fjname,
sum(sNumber) as sNumber,
sum(samount) as samount,
sum(tNumber) as tNumber,
sum(tamount) as tamount,
sum(sNumber)+sum(tNumber) as hNumber,
sum(samount)+sum(tamount) as hamount
 from
(
    select
         isnull(S_SE_Number,0) as sNumber
        ,cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0')as decimal(18, 2)) as samount,
        0 as tNumber,
        0.00 as tamount,
     S_se_SalesBasic.S_SE_SB_ShopCode as ShopCode
    from
        S_se_SalesBasic
    left join
        S_SE_AdditionalCDetail
    on S_SE_AdditionalCDetail.S_SE_SalesID  = S_se_SalesBasic.s_se_sb_salesid
    where 1=1
 and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and S_se_SalesBasic.s_se_sb_ValueFlag = '1'
    and convert(varchar(10),s_se_sb_PosDatetime,23) >= '${bgnDate}'
    and convert(varchar(10),s_se_sb_PosDatetime,23) <= '${endDate}'
    Union All
    select
        0 as sNumber,
        0.00 as samount,
        -cast(isnull(S_SE_Number,0) as decimal(18, 2)) as tNumber,
        -cast(cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0') as varchar(32)) as decimal(18, 2))  as tamount,       
        S_se_SalesBasic.S_SE_SB_ShopCode
	 from 
        S_se_SalesBasic
    left join 
        S_SE_AdditionalCDetail
	on S_SE_AdditionalCDetail.S_SE_SalesID = S_se_SalesBasic.s_se_sb_salesid
	where 1=1
   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and S_se_SalesBasic.s_se_sb_ValueFlag = '1'
    and convert(varchar(10), S_SE_SB_WithdrawDate, 23) >=  '${bgnDate}'
	and convert(varchar(10), S_SE_SB_WithdrawDate, 23) <='${endDate}'
	and s_se_sb_withdrawflag = 1
union all

    select
         isnull(S_SE_Number,0) as sNumber
        ,cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0')as decimal(18, 2)) as samount,
        0 as tNumber,
        0.00 as tamount,
     S_SE_SB_ShopCode as ShopCode
    from
        S_SE_SalesBasic_Finished
    left join
        S_SE_AdditionalCDetail
    on S_SE_AdditionalCDetail.S_SE_SalesID  = s_se_sb_salesid
    where 1=1
 and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10),s_se_sb_PosDatetime,23) >= '${bgnDate}'
    and convert(varchar(10),s_se_sb_PosDatetime,23) <= '${endDate}'
    Union All
    select
        0 as sNumber,
        0.00 as samount,
        -cast(isnull(S_SE_Number,0) as decimal(18, 2)) as tNumber,
        -cast(cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0') as varchar(32)) as decimal(18, 2))  as tamount,       
        S_SE_SB_ShopCode
	 from 
        S_SE_SalesBasic_Finished
    left join 
        S_SE_AdditionalCDetail
	on S_SE_AdditionalCDetail.S_SE_SalesID = s_se_sb_salesid
	where 1=1
   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10), S_SE_SB_WithdrawDate, 23) >=  '${bgnDate}'
	and convert(varchar(10), S_SE_SB_WithdrawDate, 23) <='${endDate}'
	and s_se_sb_withdrawflag = 1

)temp
DROP TABLE #shopCode]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.page.First">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-First')}]]></Text>
<IconName>
<![CDATA[first]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Previous">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Previous')}]]></Text>
<IconName>
<![CDATA[previous]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.PageNavi">
<WidgetAttr/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Next">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Next')}]]></Text>
<IconName>
<![CDATA[next]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Last">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Last')}]]></Text>
<IconName>
<![CDATA[last]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.Export">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Export')}]]></Text>
<IconName>
<![CDATA[export]]></IconName>
<Buttons pdf="true" excelP="true" excelO="true" excelS="true" word="true" image="true" html="true"/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<ReportExportAttr>
<ExcelExportAttr hideColumn="false" hideRow="false"/>
<PDFExportAttr/>
<HTMLExportAttr/>
</ReportExportAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="7"/>
<FR/>
<HC/>
<FC/>
<UPFCR COLUMN="false" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[914400,1333500,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[576000,0,0,0,5981700,2592000,2592000,2592000,2592000,2592000,2592000,2592000,0,2592000,2743200,0,2592000,3086100,0,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" s="0">
<Expand/>
</C>
<C c="1" r="0" s="0">
<Expand/>
</C>
<C c="2" r="0" cs="17" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" s="0">
<Expand/>
</C>
<C c="1" r="1" s="0">
<Expand/>
</C>
<C c="2" r="1" cs="17" s="1">
<O>
<![CDATA[商品销售分析表（类别）]]></O>
<Expand/>
</C>
<C c="0" r="2" s="2">
<Expand/>
</C>
<C c="1" r="2" s="2">
<Expand/>
</C>
<C c="2" r="2" s="2">
<Expand/>
</C>
<C c="3" r="2" s="2">
<Expand/>
</C>
<C c="4" r="2" s="3">
<O>
<![CDATA[查询日期：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="2" cs="14" s="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate + " 至 " + $endDate]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="0" r="3" s="2">
<Expand/>
</C>
<C c="1" r="3" s="2">
<Expand/>
</C>
<C c="2" r="3" s="2">
<Expand/>
</C>
<C c="3" r="3" s="2">
<Expand/>
</C>
<C c="4" r="3" s="2">
<O>
<![CDATA[制造商：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="3" cs="14" s="2">
<O t="DSColumn">
<Attributes dsName="ds5" columnName="B_SP_SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="0" r="4" s="2">
<Expand/>
</C>
<C c="1" r="4" s="2">
<Expand/>
</C>
<C c="2" r="4" s="2">
<Expand/>
</C>
<C c="3" r="4" s="2">
<Expand/>
</C>
<C c="4" r="4" s="2">
<O>
<![CDATA[销售门店：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="4" cs="14" s="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentNames]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="0" r="5" s="2">
<Expand/>
</C>
<C c="1" r="5" s="2">
<Expand/>
</C>
<C c="2" r="5" s="2">
<Expand/>
</C>
<C c="3" r="5" s="2">
<Expand/>
</C>
<C c="4" r="5" s="2">
<O>
<![CDATA[商品类别：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="5" cs="14" s="3">
<O t="DSColumn">
<Attributes dsName="ds6" columnName="GoodsCategoryName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="0" r="6" s="4">
<Expand/>
</C>
<C c="1" r="6" s="5">
<Expand/>
</C>
<C c="2" r="6" rs="2" s="6">
<O>
<![CDATA[类别代码]]></O>
<Expand/>
</C>
<C c="3" r="6" s="4">
<Expand/>
</C>
<C c="4" r="6" rs="2" s="6">
<O>
<![CDATA[类别名称]]></O>
<Expand/>
</C>
<C c="5" r="6" cs="13" s="6">
<O>
<![CDATA[销售信息小计]]></O>
<Expand/>
</C>
<C c="18" r="6" s="4">
<Expand/>
</C>
<C c="0" r="7" s="4">
<Expand/>
</C>
<C c="1" r="7" s="5">
<Expand/>
</C>
<C c="3" r="7" s="4">
<Expand/>
</C>
<C c="5" r="7" s="7">
<O>
<![CDATA[销售数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[1]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[2]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="6" r="7" s="7">
<O>
<![CDATA[退货数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[3]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[4]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="7" r="7" s="7">
<O>
<![CDATA[实售数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[5]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[6]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="8" r="7" s="7">
<O>
<![CDATA[销售金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[7]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[8]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="9" r="7" s="7">
<O>
<![CDATA[退款金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[9]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[10]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="10" r="7" s="7">
<O>
<![CDATA[实售金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[11]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[12]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="11" r="7" s="7">
<O>
<![CDATA[金额占比]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[13]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[14]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="12" r="7" s="4">
<Expand/>
</C>
<C c="13" r="7" s="7">
<O>
<![CDATA[成本金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[15]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[16]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="14" r="7" s="7">
<O>
<![CDATA[成本占比]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[21]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[22]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="15" r="7" s="4">
<Expand/>
</C>
<C c="16" r="7" s="7">
<O>
<![CDATA[毛利金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[17]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[18]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="17" r="7" s="7">
<O>
<![CDATA[销售毛利率]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[19]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[20]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="18" r="7" s="4">
<Expand/>
</C>
<C c="1" r="8" s="8">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="CategoryID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="goodsid"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0" order="2">
<SortFormula>
<![CDATA[SWITCH($order, "1", -TODOUBLE(F9), "2", TODOUBLE(F9), "3", -TODOUBLE(G9), "4", TODOUBLE(G9), "5", -TODOUBLE(H9), "6", TODOUBLE(H9), "7", -TODOUBLE(I9), "8", TODOUBLE(I9), "9", -TODOUBLE(J9), "10", TODOUBLE(J9), "11", -TODOUBLE(K9), "12", TODOUBLE(K9), "13", -TODOUBLE(M9), "14", TODOUBLE(M9), "15", -TODOUBLE(N9), "16", TODOUBLE(N9), "17", -TODOUBLE(Q9), "18", TODOUBLE(Q9), "19", -TODOUBLE(S9), "20", TODOUBLE(S9), "21", -TODOUBLE(P9), "22", TODOUBLE(P9), "23", -TODOUBLE(S9), "24", TODOUBLE(S9), "25", -TODOUBLE(S9), "26", TODOUBLE(S9), "27", -TODOUBLE(S9), "28", TODOUBLE(S9), "29", -TODOUBLE(S9), "30", TODOUBLE(S9), "31", -TODOUBLE(S9), "32", TODOUBLE(S9), "33", -TODOUBLE(S9), "34", TODOUBLE(S9), "35", -TODOUBLE(S9), "36", TODOUBLE(S9), "37", -TODOUBLE(S9), "38", TODOUBLE(S9), "39", -TODOUBLE(S9), "40", TODOUBLE(S9))]]></SortFormula>
</Expand>
</C>
<C c="4" r="8" s="10">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="goodsname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="bgnDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$customAmountName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopCode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopCode]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentNames"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentNames]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="querySystematics"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$querySystematics]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgispecjj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgispecjj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgicolorjj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgicolorjj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiframesizejj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiframesizejj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgieyeglassmaterialtypejp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgieyeglassmaterialtypejp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgirefractivejp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgirefractivejp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiismutiluminosityjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiismutiluminosityjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minCyljp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minCyljp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxCyljp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxCyljp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiusetypeyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiusetypeyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgistealthclassyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgistealthclassyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minCylyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minCylyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxCylyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxCylyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodsbigclass"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiothergoodsbigclass]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodssmallclass"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiothergoodssmallclass]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphlh"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphlh]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphlh"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphlh]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="pjlx"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$pjlx]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopcol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopcol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesnumcol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesnumcol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="moneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$moneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="costmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$costmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="zmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$zmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="zmoneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$zmoneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$supplierID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bandID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bandID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgnretailamount"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnretailamount]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endretailamount"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endretailamount]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="costmoneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$costmoneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesCost"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesCost]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isCustomize"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isCustomize]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_goodsSalesAnalysisNew_supplier2.cpt&__bypagesize__=false&bgnDate="+bgnDate+"&endDate="+endDate
+"&goodsCategoryID="+goodsCategoryID+"&customAmountName="+EncodeUtf8(customAmountName)+"&shopCode="+shopCode+"&departmentNames="+EncodeUtf8
(departmentNames)+"&querySystematics="+EncodeUtf8(querySystematics)+"&isShow="+isShow+"&bgispecjj="+bgispecjj+"&bgicolorjj="+bgicolorjj
+"&bgiframesizejj="+bgiframesizejj+"&bgieyeglassmaterialtypejp="+bgieyeglassmaterialtypejp+"&bgirefractivejp="+bgirefractivejp
+"&bgiismutiluminosityjp="+bgiismutiluminosityjp+"&minSphjp="+minSphjp+"&maxSphjp="+maxSphjp+"&minCyljp="+minCyljp+"&maxCyljp="+maxCyljp+"&bgiusetypeyj="+bgiusetypeyj
+"&bgistealthclassyj="+bgistealthclassyj+"&minSphyj="+minSphyj+"&maxSphyj="+maxSphyj+"&minCylyj="+minCylyj+"&maxCylyj="+maxCylyj
+"&bgiothergoodsbigclass="+bgiothergoodsbigclass+"&bgiothergoodssmallclass="+bgiothergoodssmallclass+"&minSphlh="+minSphlh+"&maxSphlh="+maxSphlh+"&pjlx="+pjlx
+"&shopcol="+shopcol+"&salesnumcol="+salesnumcol+"&salesmoneycol="+salesmoneycol+"&moneyratecol="+moneyratecol+"&costmoneycol="+costmoneycol+"&zmoneycol="+zmoneycol
+"&zmoneyratecol="+zmoneyratecol+"&supplierID="+supplierID+"&bandID="+bandID+"&goodsName="+EncodeUtf8(goodsName)+"&goodsID="+goodsID
+"&bgnretailamount="+bgnretailamount+"&salesCost="+salesCost+"&endretailamount="+endretailamount+"&costmoneyratecol="+costmoneyratecol+"&showCompanyName="+showCompanyName+"&isCustomize="+isCustomize;

openWindowForReport(DataURL);]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="5" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="6" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="7" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="9" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="10" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="8" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((K9 / K10) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=K9 / K10]]></Attributes>
</O>
<Expand/>
</C>
<C c="13" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="bhsje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="14" r="8" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((N9 / N10) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="15" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=N9 / N10]]></Attributes>
</O>
<Expand/>
</C>
<C c="16" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="mlje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="17" r="8" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsmll2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="18" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=Q9 / K9]]></Attributes>
</O>
<Expand/>
</C>
<C c="1" r="9" s="8">
<Expand/>
</C>
<C c="2" r="9" cs="3" s="11">
<O>
<![CDATA[合计：]]></O>
<Expand/>
</C>
<C c="5" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(F9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(G9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="7" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(H9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="8" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(I9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(J9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="10" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(K9))]]></Attributes>
</O>
<Expand/>
</C>
<C c="11" r="9" s="12">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(N9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="9" s="12">
<Expand/>
</C>
<C c="15" r="9">
<Expand/>
</C>
<C c="16" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Q9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="17" r="9" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((Q10 / K10) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="10" s="13">
<O t="DSColumn">
<Attributes dsName="ds7" columnName="fjname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="10" cs="5" s="14">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="("+$bgnDate + " 至 " + $endDate+")"]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="10" s="13">
<O t="DSColumn">
<Attributes dsName="ds7" columnName="hamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="10" s="9">
<Expand/>
</C>
<C c="12" r="10" s="9">
<Expand/>
</C>
<C c="13" r="10" s="9">
<Expand/>
</C>
<C c="14" r="10" s="9">
<Expand/>
</C>
<C c="15" r="10" s="9">
<Expand/>
</C>
<C c="16" r="10" s="9">
<Expand/>
</C>
<C c="17" r="10" s="9">
<Expand/>
</C>
<C c="4" r="11" s="15">
<O>
<![CDATA[总合计：]]></O>
<Expand/>
</C>
<C c="5" r="11" cs="6" s="11">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(K9)+K11)]]></Attributes>
</O>
<Expand/>
</C>
<C c="11" r="11" s="16">
<Expand/>
</C>
<C c="12" r="11" s="16">
<Expand/>
</C>
<C c="13" r="11" s="16">
<Expand/>
</C>
<C c="14" r="11" s="16">
<Expand/>
</C>
<C c="15" r="11" s="16">
<Expand/>
</C>
<C c="16" r="11" s="16">
<Expand/>
</C>
<C c="17" r="11" s="16">
<Expand/>
</C>
<C c="1" r="12" s="17">
<Expand/>
</C>
<C c="2" r="12" cs="16" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期：" + today()]]></Attributes>
</O>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="4" r="13">
<Expand/>
</C>
<C c="8" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="11" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="16" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="30240000" height="47520000"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80" foreground="-16776961" underline="1"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="宋体" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="宋体" style="0" size="72"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
