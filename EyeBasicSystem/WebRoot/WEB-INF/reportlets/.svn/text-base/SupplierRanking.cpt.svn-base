<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20100331">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="startdate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="enddate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select GoodsCategoryName,SupplierName,isnull(sum(SalseValue)-sum(UnitPrice),0) as maoli,sum(SalseValue) as SalseValue,sum(count1) as count1,sum(UnitPrice) as UnitPrice, tid from (

select CostPrice, B_GI_RetailPrice, substring(goodsid,1,1) as tid,
    substring(goodsid,3,2) as sid,
    substring(goodsid,6,2) as gid,
	B_SP_SupplierName as SupplierName,
	B_GC_GoodsCategoryName as GoodsCategoryName,
	B_GI_GoodsName, 
	SUM(count1) AS count1, 
	SUM(SalseValue) AS SalseValue,
	sum(UnitPrice) AS UnitPrice
from (
SELECT 
			 B_GoodsInfo.B_GI_GoodsCategoryID       AS b_gi_GoodsCategoryID,
			 B_GoodsCategory.B_GC_GoodsCategoryName as B_GC_GoodsCategoryName,
             B_GoodsInfo.B_GI_SupplierID            AS b_gi_SupplierID,
			 B_Supplier.B_SP_SupplierName           as B_SP_SupplierName,
             B_GoodsInfo.b_gi_GoodsName             AS b_gi_GoodsName,
             B_GoodsInfo.B_GI_GoodsID               AS goodsid,
			 B_GoodsInfo.B_GI_BrandID               as BrandID,
             B_Brand.B_BD_brandName                 AS brandName,
             B_GoodsInfo.B_GI_Spec                  AS spec,
             B_GoodsInfo.B_GI_CostPrice             AS CostPrice,
             B_GoodsInfo.B_GI_RetailPrice           AS B_GI_RetailPrice,
             SUM(TEMP.NUMBER)           AS count1,
             SUM(TEMP.notTaxRateAmount) AS UnitPrice,
             SUM(TEMP.salesValue)       AS SalseValue
      FROM   (SELECT s_se_sb_shopcode                         AS shopcode,
                     S_SE_SD_SalesItemID                      AS salesItemID,
                     B_BD_brandName                           AS brandName,
                     B_GI_Spec                                AS spec,
                     B_GI_CostPrice                           AS costPrice,
                     B_GI_RetailPrice                         AS retailPrice,
                     B_GI_GoodsCategoryID,
                     B_GI_SupplierID,
                     B_GI_BrandID,
                     SUM(S_SE_SD_Number)                      AS NUMBER,
                     SUM(S_SE_SD_Number * S_SE_SD_CostsPrive) AS notTaxRateAmount,
                     SUM(S_SE_SD_SalesValue)                  AS salesValue
              FROM   S_se_SalesBasic
                     INNER JOIN S_se_SalesDetail
                       ON S_SE_Sb_SalesID = S_SE_SD_SalesID
                     INNER JOIN B_GoodsInfo
                       ON S_SE_SD_SalesItemID = B_GI_GoodsID
                     INNER JOIN B_Brand
                       ON B_GI_BrandID = B_BD_ID
                          AND B_BD_SupplierID = Substring(S_SE_SD_SalesItemID, 3, 2)
                          AND S_SE_SB_ValueFlag = '1'
                     AND CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) >= '${startdate}'
                     AND CONVERT(VARCHAR(10), s_se_sb_PosDatetime, 23) <= '${enddate}'
              GROUP  BY s_se_sb_shopcode,
                        S_SE_SD_SalesItemID,
                        B_BD_brandName,
                        B_GI_Spec,
                        B_GI_CostPrice,
                        B_GI_RetailPrice,
                        B_GI_GoodsCategoryID,
                        B_GI_SupplierID,
                        B_GI_BrandID
             
              UNION ALL
              SELECT s_se_sb_shopcode                          AS shopcode,
                     S_SE_SD_SalesItemID                       AS salesItemID,
                     B_BD_brandName                            AS brandName,
                     B_GI_Spec                                 AS spec,
                     B_GI_CostPrice                            AS costPrice,
                     B_GI_RetailPrice                          AS retailPrice,
                     B_GI_GoodsCategoryID,
                     B_GI_SupplierID,
                     B_GI_BrandID,
                     -SUM(S_SE_SD_Number)                      AS NUMBER,
                     -SUM(S_SE_SD_Number * S_SE_SD_CostsPrive) AS notTaxRateAmount,
                     -SUM(S_SE_SD_SalesValue)                  AS salesValue
              FROM   S_se_SalesBasic
                     INNER JOIN S_se_SalesDetail
                       ON s_se_sb_salesid = s_se_sd_salesid
                     INNER JOIN B_GoodsInfo
                       ON S_SE_SD_SalesItemID = B_GI_GoodsID
                     INNER JOIN B_Brand
                       ON B_GI_BrandID = B_BD_ID
                          AND B_BD_SupplierID = Substring(S_SE_SD_SalesItemID, 3, 2)
              WHERE  s_se_sb_valueflag = '1'
                  
                     AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) >= '${startdate}'
                     AND CONVERT(VARCHAR(10), S_SE_SB_WithdrawDate, 23) <= '${enddate}'
                     AND s_se_sb_withdrawflag = 1
                     
              GROUP  BY s_se_sb_shopcode,
                        S_SE_SD_SalesItemID,
                        B_BD_brandName,
                        B_GI_Spec,
                        B_GI_CostPrice,
                        B_GI_RetailPrice,
                        B_GI_GoodsCategoryID,
                        B_GI_SupplierID,
                        B_GI_BrandID) TEMP
	  inner join b_goodsinfo ON b_goodsinfo.B_GI_GoodsID = TEMP.salesItemID
	  INNER JOIN B_Brand ON B_goodsinfo.B_GI_BrandID = B_BD_ID AND B_goodsinfo.B_GI_SupplierID = B_BD_SupplierID
	  inner join B_Supplier on B_goodsinfo.B_GI_SupplierID = B_SP_ID
	  inner join B_GoodsCategory on B_GC_ID = B_goodsinfo.B_GI_GoodsCategoryID
      GROUP  BY B_GoodsInfo.B_GI_GoodsCategoryID,
			 B_GoodsCategory.B_GC_GoodsCategoryName,
             B_GoodsInfo.B_GI_SupplierID,
			 B_Supplier.B_SP_SupplierName,
             B_GoodsInfo.b_gi_GoodsName,
             B_GoodsInfo.B_GI_GoodsID,
			 B_GoodsInfo.B_GI_BrandID,
             B_Brand.B_BD_brandName,
             B_GoodsInfo.B_GI_Spec,
             B_GoodsInfo.B_GI_CostPrice,
             B_GoodsInfo.B_GI_RetailPrice
) temp2
where substring(goodsid,3,2)<>'zz'
group by goodsid,
CostPrice,B_GI_RetailPrice
,substring(goodsid,1,1)
,substring(goodsid,3,2)
,substring(goodsid,6,2)
,B_GI_GoodsName,
B_GC_GoodsCategoryName,
B_SP_SupplierName
)as gongyingshang 

group by GoodsCategoryName,SupplierName,tid
order by tid, SalseValue desc]]></Query>
</TableData>
</TableDataMap>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportSettings orientation="1" headerHeight="0.0" footerHeight="0.0">
<Margin top="0.27" left="0.7500000000000001" bottom="0.27" right="0.7500000000000001"/>
</ReportSettings>
<ReportPageAttr>
<HR F="0" T="2"/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
<RowHeight defaultValue="19">
<![CDATA[40,19,30,19,19,19,19,19,19,19,19]]></RowHeight>
<ColumnWidth defaultValue="72">
<![CDATA[101,289,136,136,138,145,24,72,72,72,72]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="5" s="0">
<O>
<![CDATA[制造商销售排名报表]]></O>
<Expand/>
</C>
<C c="5" r="0">
<Expand/>
</C>
<C c="6" r="0">
<Expand/>
</C>
<C c="0" r="1" cs="2">
<Expand/>
</C>
<C c="0" r="2" s="1">
<O>
<![CDATA[商品类别]]></O>
<Expand/>
</C>
<C c="1" r="2" s="1">
<O>
<![CDATA[制造商名称]]></O>
<Expand/>
</C>
<C c="2" r="2" s="1">
<O>
<![CDATA[销售金额合计]]></O>
<Expand/>
</C>
<C c="3" r="2" s="1">
<O>
<![CDATA[销售数量]]></O>
<Expand/>
</C>
<C c="4" r="2" s="1">
<O>
<![CDATA[价税金额成本]]></O>
<Expand/>
</C>
<C c="5" r="2" s="1">
<O>
<![CDATA[毛利金额]]></O>
<Expand/>
</C>
<C c="0" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="GoodsCategoryName"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="SupplierName"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="SalseValue"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="count1"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="UnitPrice"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="3" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="maoli"/>
<Complex/>
<RG class="com.fr.report.cellElement.core.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
</CellElementList>
</Report>
<StyleList>
<Style horizontal_alignment="0">
<FRFont name="SimSun" style="1" size="18"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0">
<FRFont name="SimSun" style="1" size="12"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0">
<FRFont name="SimSun" style="0" size="12"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
</StyleList>
</WorkBook>
