<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[X011120130610060215]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT DISTINCT S_SE_SB_SalesID                                                    AS '配镜单号',
                S_SE_SB_OrdersType                                                 AS '配镜单类型ID',
                S_ME_CI_Name                                                       AS '会员姓名',
                S_ME_CI_Phone                                                      AS '会员电话',
                S_ME_CI_MemberId                                                   AS '会员卡号',
                --add by ZK begin
                CASE
                  WHEN S_SE_SB_OrdersType = '1' THEN '框镜成品'
                  WHEN S_SE_SB_OrdersType = '2' THEN '框镜订做'
                  WHEN S_SE_SB_OrdersType = '3' THEN '隐形成品'
                  WHEN S_SE_SB_OrdersType = '4' THEN '隐形订做'
                  WHEN S_SE_SB_OrdersType = '5' THEN '辅料'
                  ELSE S_SE_SB_OrdersType
                END                                                                AS '配镜单类型名称',
                --add by ZK end
                CASE
                  WHEN S_SE_SB_RecipeType = '1' THEN '远用     '
                  WHEN S_SE_SB_RecipeType = '2' THEN '近用     '
                  WHEN S_SE_SB_RecipeType = '3' THEN '渐进/双光'
                  WHEN S_SE_SB_RecipeType = '4' THEN '隐形     '
                  ELSE '辅料     '
                END                                                                AS '处方类型',
                S_SE_SB_BallGlassOD                                                AS '右眼球镜',
                S_SE_SB_BallGlassOS                                                AS '左眼球镜',
                S_SE_SB_PostGlassOD                                                AS '右眼柱镜',
                S_SE_SB_PostGlassOS                                                AS '左眼柱镜',
                S_SE_SB_AxesOD                                                     AS '右眼轴向',
                S_SE_SB_AxesOS                                                     AS '左眼轴向',
                S_SE_SB_ADDOD                                                      AS '右眼add',
                S_SE_SB_ADDOS                                                      AS '左眼add ',
                CASE
                  WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOD1
                  ELSE S_SE_SB_ArriseGlassOD1
                END                                                                AS '右眼三棱镜',
                CASE
                  WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOS1
                  ELSE S_SE_SB_ArriseGlassOS1
                END                                                                AS '左眼三棱镜',
                CASE
                  WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOD
                  ELSE S_SE_SB_BasisOD1
                END                                                                AS '右眼基底1',
                CASE
                  WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOS
                  ELSE S_SE_SB_BasisOS1
                END                                                                AS '左眼基底1',
                S_SE_SB_BasisOD1                                                   AS '右眼基底1',
                S_SE_SB_BasisOS1                                                   AS '左眼基底1',
                S_SE_SB_PrismOD                                                    AS '右眼棱镜',
                S_SE_SB_PrismOS                                                    AS '左眼棱镜',
                CASE
                  WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOD
                  WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOD
                  WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOD
                  ELSE ''
                END                                                                AS '右眼瞳距',
                CASE
                  WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOs
                  WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOs
                  WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOs
                  ELSE ''
                END                                                                AS '左眼瞳距',
                CASE
                  WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOd
                  WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOd
                  WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOd
                  ELSE ''
                END                                                                AS '右眼VA',
                CASE
                  WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOS
                  WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOs
                  WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOS
                  ELSE ''
                END                                                                AS '左眼VA',
                sp.id                                                              AS '收银员',
                yp.id                                                              AS '验光师',
                xp.id                                                              AS '销售员',
                CONVERT(VARCHAR(16), S_SE_SB_SalesDatetime, 25)                    AS '配镜日期',
                CONVERT(VARCHAR(16), S_SE_SB_TakeGlassData, 25)                    AS '取镜日期',
                xshop.B_DP_DepartmentName                                          AS '销售门店',
                qshop.B_DP_DepartmentName                                          AS '取镜地点',
                Isnull(S_SE_TM_MaiilAddress, '')                                   AS '邮寄地址',
                S_SE_SB_PupilHeightOD                                              AS '右眼瞳高',
                S_SE_SB_PupilHeightOS                                              AS '左眼瞳高',
                -CAST(( S_SE_SB_PriceSum - S_SE_SB_SalesValue ) AS NUMERIC(18, 2)) AS '折扣差价',
                S_SE_SB_SalesValue                                                 AS '应收金额',
                S_SM_SM_Title                                                      AS '套餐标题',
	      S_SE_SB_SalesRemark												   		AS '销售备注'
FROM   S_SE_SalesBasic
       LEFT JOIN SYS_PersonInfo sp
         ON sp.ID = S_SE_SB_PosID
       LEFT JOIN S_OP_Inspection
         ON S_SE_SB_OptometryID = S_OP_IP_OptometryID
       LEFT JOIN SYS_PersonInfo yp
         ON yp.id = S_OP_IP_UserName
       LEFT JOIN SYS_PersonInfo xp
         ON xp.id = S_SE_SB_SalerID
       LEFT JOIN B_Departments xshop
         ON S_SE_SB_ShopCode = xshop.B_DP_DepartmentID
       LEFT JOIN B_Departments qshop
         ON S_SE_SB_Location = qshop.B_DP_DepartmentID
       LEFT JOIN (SELECT TOP 1 *
                  FROM   S_SE_ToMail
                  WHERE  S_SE_TM_LinkSalesID = '${salesid}') mail
         ON S_SE_SB_SalesID = mail.S_SE_TM_LinkSalesID
       LEFT JOIN dbo.S_ME_CustomerInfo
         ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
       LEFT JOIN S_SM_SetMeal
         ON S_SE_SB_SetMealID = S_SM_SM_ID
WHERE  S_SE_SB_SalesID = '${salesid}'
       AND S_SE_SB_SwapGoodsFlag IN ( '1', '2' )
UNION ALL
SELECT S_SE_SB_SalesID,
       S_SE_SB_OrdersType,
       S_ME_CI_Name,
       S_ME_CI_Phone,
       S_ME_CI_MemberId,
       --add by ZK begin
       CASE
                  WHEN S_SE_SB_OrdersType = '1' THEN '框镜成品'
                  WHEN S_SE_SB_OrdersType = '2' THEN '框镜订做'
                  WHEN S_SE_SB_OrdersType = '3' THEN '隐形成品'
                  WHEN S_SE_SB_OrdersType = '4' THEN '隐形订做'
                  WHEN S_SE_SB_OrdersType = '5' THEN '辅料'
         ELSE S_SE_SB_OrdersType
       END                                                                AS ordersTypeName,
       --add by ZK end
       CASE
         WHEN S_SE_SB_RecipeType = '1' THEN '远用     '
         WHEN S_SE_SB_RecipeType = '2' THEN '近用     '
         WHEN S_SE_SB_RecipeType = '3' THEN '渐进/双光'
         WHEN S_SE_SB_RecipeType = '4' THEN '隐形     '
         ELSE '辅料     '
       END                                                                AS S_SE_SB_RecipeType,
       S_SE_SB_BallGlassOD,
       S_SE_SB_BallGlassOS,
       S_SE_SB_PostGlassOD,
       S_SE_SB_PostGlassOS,
       S_SE_SB_AxesOD,
       S_SE_SB_AxesOS,
       S_SE_SB_ADDOD,
       S_SE_SB_ADDOS,
       CASE
         WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOD1
         ELSE S_SE_SB_ArriseGlassOD1
       END                                                                AS S_SE_SB_ArriseGlassOD1,
       CASE
         WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOS1
         ELSE S_SE_SB_ArriseGlassOS1
       END                                                                AS S_SE_SB_ArriseGlassOS1,
       CASE
         WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOD
         ELSE S_SE_SB_BasisOD1
       END                                                                AS S_SE_SB_BasisOD1,
       CASE
         WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOS
         ELSE S_SE_SB_BasisOS1
       END                                                                AS S_SE_SB_BasisOS1,
       S_SE_SB_BasisOD1,
       S_SE_SB_BasisOS1,
       S_SE_SB_PrismOD,
       S_SE_SB_PrismOS,
       CASE
         WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOD
         WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOD
         WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOD
         ELSE ''
       END                                                                AS tjod,
       CASE
         WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOs
         WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOs
         WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOs
         ELSE ''
       END                                                                AS tjos,
       CASE
         WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOd
         WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOd
         WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOd
         ELSE ''
       END                                                                AS vaod,
       CASE
         WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOS
         WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOs
         WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOS
         ELSE ''
       END                                                                AS vaos,
       sp.id                                                              AS sperson,
       yp.id                                                              AS yperson,
       xp.id                                                              AS xperson,
       CONVERT(VARCHAR(16), S_SE_SB_SalesDatetime, 25)                    AS sdate,
       CONVERT(VARCHAR(16), S_SE_SB_TakeGlassData, 25)                    AS qdate,
       xshop.B_DP_DepartmentName                                          AS xshop,
       qshop.B_DP_DepartmentName                                          AS qshop,
       Isnull(S_SE_TM_MaiilAddress, '')                                   AS MaiilAddress,
       S_SE_SB_PupilHeightOD,
       S_SE_SB_PupilHeightOS,
       -CAST(( S_SE_SB_PriceSum - S_SE_SB_SalesValue ) AS NUMERIC(18, 2)) AS zkvalue,
       SUM(S_SE_SD_SalesValue)                                            AS S_SE_SB_SalesValue,
       S_SM_SM_Title,
       S_SE_SB_SalesRemark					  AS '销售备注'
FROM   S_SE_SalesDetail
       INNER JOIN S_SE_SalesBasic
         ON S_SE_SB_SalesID = S_SE_SD_SalesID
       LEFT JOIN SYS_PersonInfo sp
         ON sp.ID = S_SE_SB_PosID
       LEFT JOIN S_OP_Inspection
         ON S_SE_SB_OptometryID = S_OP_IP_OptometryID
       LEFT JOIN SYS_PersonInfo yp
         ON yp.id = S_OP_IP_UserName
       LEFT JOIN SYS_PersonInfo xp
         ON xp.id = S_SE_SB_SalerID
       LEFT JOIN B_Departments xshop
         ON S_SE_SB_ShopCode = xshop.B_DP_DepartmentID
       LEFT JOIN B_Departments qshop
         ON S_SE_SB_Location = qshop.B_DP_DepartmentID
       LEFT JOIN (SELECT TOP 1 *
                  FROM   S_SE_ToMail
                  WHERE  S_SE_TM_LinkSalesID = '${salesid}') mail
         ON S_SE_SB_SalesID = mail.S_SE_TM_LinkSalesID
       LEFT JOIN dbo.S_ME_CustomerInfo
         ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
       LEFT JOIN S_SM_SetMeal
         ON S_SE_SB_SetMealID = S_SM_SM_ID
WHERE  S_SE_SB_SalesID = '${salesid}'
       AND S_SE_SB_SwapGoodsFlag = '3'
       AND S_SE_SD_ExchageFlag = '1'
GROUP  BY S_SE_SB_SalesID,
          S_SE_SB_OrdersType,
          S_ME_CI_Name,
          S_ME_CI_Phone,
          S_ME_CI_MemberId,
          CASE
            WHEN S_SE_SB_RecipeType = '1' THEN '远用     '
            WHEN S_SE_SB_RecipeType = '2' THEN '近用     '
            WHEN S_SE_SB_RecipeType = '3' THEN '渐进/双光'
            WHEN S_SE_SB_RecipeType = '4' THEN '隐形     '
            ELSE '辅料     '
          END,
          S_SE_SB_BallGlassOD,
          S_SE_SB_BallGlassOS,
          S_SE_SB_PostGlassOD,
          S_SE_SB_PostGlassOS,
          S_SE_SB_AxesOD,
          S_SE_SB_AxesOS,
          S_SE_SB_ADDOD,
          S_SE_SB_ADDOS,
          CASE
            WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOD1
            ELSE S_SE_SB_ArriseGlassOD1
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_EyeCurvatureOS1
            ELSE S_SE_SB_ArriseGlassOS1
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOD
            ELSE S_SE_SB_BasisOD1
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '4' THEN S_SE_SB_DiameterOS
            ELSE S_SE_SB_BasisOS1
          END,
          S_SE_SB_BasisOD1,
          S_SE_SB_BasisOS1,
          S_SE_SB_PrismOD,
          S_SE_SB_PrismOS,
          CASE
            WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOD
            WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOD
            WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOD
            ELSE ''
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_InterHighOs
            WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_InterDistanceOs
            WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_InterHighOs
            ELSE ''
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOd
            WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOd
            WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOd
            ELSE ''
          END,
          CASE
            WHEN S_SE_SB_RecipeType = '1' THEN S_SE_SB_FarVAOS
            WHEN S_SE_SB_RecipeType = '2' THEN S_SE_SB_CloseVAOs
            WHEN S_SE_SB_RecipeType = '3' THEN S_SE_SB_FarVAOS
            ELSE ''
          END,
          sp.id,
          yp.id,
          xp.id,
          CONVERT(VARCHAR(16), S_SE_SB_SalesDatetime, 25),
          CONVERT(VARCHAR(16), S_SE_SB_TakeGlassData, 25),
          xshop.B_DP_DepartmentName,
          qshop.B_DP_DepartmentName,
          Isnull(S_SE_TM_MaiilAddress, ''),
          S_SE_SB_PupilHeightOD,
          S_SE_SB_PupilHeightOS,
          -CAST(( S_SE_SB_PriceSum - S_SE_SB_SalesValue ) AS NUMERIC(18, 2)),
          S_SM_SM_Title,
	S_SE_SB_SalesRemark]]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select S_SE_SD_Requirement as '特殊加工要求' from S_SE_SpecialPDetail
 where S_SE_SD_SalesID = '${salesid}']]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select
S_SE_CostsName AS '附加费名称',
S_SE_Number AS '数量',
cast(S_SE_Amount * S_SE_Number as numeric(18,2)) as '金额合计'
from S_SE_AdditionalCDetail
where S_SE_SalesID = '${salesid}']]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[723900,1726560,1028700,647700,342900,609600,1008000,1008000,1080000,806400,806400,806400,806400,914400,800100,647700,723900,730080,792000,792000,792000,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[38100,38100,1752600,304800,1409700,685800,381000,1943100,76200,990600,914400,1409700,381000,685800,342900,838200,1714500,1676400,1257300,609600,1943100,2628900,1333440,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" s="0">
<Expand/>
</C>
<C c="1" r="0" s="0">
<Expand/>
</C>
<C c="2" r="0" s="0">
<Expand/>
</C>
<C c="3" r="0" s="0">
<Expand/>
</C>
<C c="4" r="0" s="0">
<Expand/>
</C>
<C c="5" r="0" s="0">
<Expand/>
</C>
<C c="6" r="0" s="0">
<Expand/>
</C>
<C c="7" r="0" s="0">
<Expand/>
</C>
<C c="8" r="0" s="0">
<Expand/>
</C>
<C c="9" r="0" s="0">
<Expand/>
</C>
<C c="10" r="0" s="0">
<Expand/>
</C>
<C c="11" r="0" s="0">
<Expand/>
</C>
<C c="12" r="0" s="0">
<Expand/>
</C>
<C c="13" r="0" s="0">
<Expand/>
</C>
<C c="14" r="0" s="0">
<Expand/>
</C>
<C c="15" r="0" s="0">
<Expand/>
</C>
<C c="16" r="0" s="0">
<Expand/>
</C>
<C c="17" r="0" s="0">
<Expand/>
</C>
<C c="18" r="0" s="0">
<Expand/>
</C>
<C c="19" r="0" s="0">
<Expand/>
</C>
<C c="20" r="0" s="0">
<Expand/>
</C>
<C c="21" r="0" s="0">
<Expand/>
</C>
<C c="22" r="0" s="0">
<Expand/>
</C>
<C c="0" r="1" s="0">
<Expand/>
</C>
<C c="1" r="1" s="0">
<Expand/>
</C>
<C c="2" r="1" s="0">
<Expand/>
</C>
<C c="3" r="1" s="0">
<Expand/>
</C>
<C c="4" r="1" s="0">
<Expand/>
</C>
<C c="5" r="1" s="0">
<Expand/>
</C>
<C c="6" r="1" s="0">
<Expand/>
</C>
<C c="7" r="1" s="0">
<Expand/>
</C>
<C c="8" r="1" s="0">
<Expand/>
</C>
<C c="9" r="1" s="0">
<Expand/>
</C>
<C c="10" r="1" s="0">
<Expand/>
</C>
<C c="11" r="1" s="0">
<Expand/>
</C>
<C c="12" r="1" s="0">
<Expand/>
</C>
<C c="13" r="1" s="0">
<Expand/>
</C>
<C c="14" r="1" s="0">
<Expand/>
</C>
<C c="15" r="1" s="0">
<Expand/>
</C>
<C c="16" r="1" s="0">
<Expand/>
</C>
<C c="17" r="1" s="0">
<Expand/>
</C>
<C c="18" r="1" s="0">
<Expand/>
</C>
<C c="19" r="1" s="0">
<Expand/>
</C>
<C c="20" r="1" s="0">
<Expand/>
</C>
<C c="21" r="1" s="0">
<Expand/>
</C>
<C c="22" r="1" s="0">
<Expand/>
</C>
<C c="0" r="2" s="0">
<Expand/>
</C>
<C c="1" r="2" s="0">
<Expand/>
</C>
<C c="2" r="2" s="0">
<Expand/>
</C>
<C c="3" r="2" s="0">
<Expand/>
</C>
<C c="4" r="2" s="0">
<Expand dir="0"/>
</C>
<C c="5" r="2" s="0">
<Expand/>
</C>
<C c="6" r="2" s="0">
<Expand/>
</C>
<C c="7" r="2" s="0">
<Expand dir="0"/>
</C>
<C c="8" r="2" s="0">
<Expand dir="0"/>
</C>
<C c="9" r="2" s="0">
<Expand/>
</C>
<C c="10" r="2" s="0">
<Expand/>
</C>
<C c="11" r="2" s="0">
<Expand/>
</C>
<C c="12" r="2" s="0">
<Expand/>
</C>
<C c="13" r="2" s="0">
<Expand/>
</C>
<C c="14" r="2" s="0">
<Expand/>
</C>
<C c="15" r="2" s="0">
<Expand/>
</C>
<C c="16" r="2" s="0">
<Expand/>
</C>
<C c="17" r="2" s="0">
<Expand/>
</C>
<C c="18" r="2" cs="3" s="1">
<O>
<![CDATA[销售类型：]]></O>
<Expand/>
</C>
<C c="21" r="2" cs="2" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="配镜单类型名称"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="3" s="0">
<Expand/>
</C>
<C c="1" r="3" s="0">
<Expand/>
</C>
<C c="2" r="3" s="0">
<Expand/>
</C>
<C c="3" r="3" s="0">
<Expand/>
</C>
<C c="4" r="3" cs="3" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="会员姓名"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="3" s="0">
<Expand/>
</C>
<C c="8" r="3" s="0">
<Expand/>
</C>
<C c="9" r="3" cs="6" s="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="会员电话"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="15" r="3" s="0">
<Expand/>
</C>
<C c="17" r="3" cs="3" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="会员卡号"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="20" r="3" cs="3" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="配镜单号"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="5" s="0">
<Expand/>
</C>
<C c="1" r="5" s="0">
<Expand/>
</C>
<C c="2" r="5" cs="3" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="处方类型"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="5" s="0">
<Expand/>
</C>
<C c="6" r="5" s="0">
<Expand/>
</C>
<C c="7" r="5" s="0">
<Expand/>
</C>
<C c="8" r="5" s="0">
<Expand/>
</C>
<C c="9" r="5" s="0">
<Expand/>
</C>
<C c="10" r="5" s="0">
<Expand/>
</C>
<C c="11" r="5" s="0">
<Expand/>
</C>
<C c="12" r="5" s="0">
<Expand/>
</C>
<C c="13" r="5" s="0">
<Expand/>
</C>
<C c="14" r="5" s="0">
<Expand/>
</C>
<C c="15" r="5" s="0">
<Expand/>
</C>
<C c="16" r="5" s="0">
<Expand/>
</C>
<C c="17" r="5" s="0">
<Expand/>
</C>
<C c="18" r="5" s="0">
<Expand/>
</C>
<C c="19" r="5" s="0">
<Expand/>
</C>
<C c="20" r="5" s="0">
<Expand/>
</C>
<C c="21" r="5" s="0">
<Expand/>
</C>
<C c="22" r="5" s="0">
<Expand/>
</C>
<C c="0" r="6" s="0">
<Expand/>
</C>
<C c="1" r="6" s="0">
<Expand/>
</C>
<C c="2" r="6" s="0">
<Expand/>
</C>
<C c="4" r="6" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼球镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="6" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼柱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="6" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="6" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="13" r="6" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼基底1"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="16" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼瞳距"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="17" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼瞳高"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="18" r="6" s="6">
<Expand/>
</C>
<C c="19" r="6" s="6">
<Expand/>
</C>
<C c="20" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼VA"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="21" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼add"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="22" r="6" s="0">
<Expand/>
</C>
<C c="0" r="7" s="0">
<Expand/>
</C>
<C c="1" r="7" s="0">
<Expand/>
</C>
<C c="2" r="7" s="0">
<Expand/>
</C>
<C c="4" r="7" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼球镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="7" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼柱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="7" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="7" cs="2" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="13" r="7" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼基底1"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="16" r="7" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼瞳距"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="17" r="7" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼瞳高"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="18" r="7" s="6">
<Expand/>
</C>
<C c="19" r="7" s="6">
<Expand/>
</C>
<C c="20" r="7" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼VA"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="21" r="7" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼add "/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="22" r="7" s="0">
<Expand/>
</C>
<C c="0" r="8" s="0">
<Expand/>
</C>
<C c="1" r="8" s="0">
<Expand/>
</C>
<C c="2" r="8" s="0">
<Expand/>
</C>
<C c="3" r="8" s="0">
<Expand/>
</C>
<C c="4" r="8" s="0">
<Expand/>
</C>
<C c="5" r="8" s="0">
<Expand/>
</C>
<C c="6" r="8" s="0">
<Expand/>
</C>
<C c="7" r="8" s="0">
<Expand/>
</C>
<C c="8" r="8" s="0">
<Expand/>
</C>
<C c="9" r="8" s="0">
<Expand/>
</C>
<C c="10" r="8" s="0">
<Expand/>
</C>
<C c="11" r="8" s="0">
<Expand/>
</C>
<C c="12" r="8" s="0">
<Expand/>
</C>
<C c="13" r="8" s="0">
<Expand/>
</C>
<C c="14" r="8" s="0">
<Expand/>
</C>
<C c="15" r="8" s="0">
<Expand/>
</C>
<C c="16" r="8" s="0">
<Expand/>
</C>
<C c="17" r="8" s="0">
<Expand/>
</C>
<C c="18" r="8" s="0">
<Expand/>
</C>
<C c="19" r="8" s="0">
<Expand/>
</C>
<C c="20" r="8" s="0">
<Expand/>
</C>
<C c="21" r="8" s="0">
<Expand/>
</C>
<C c="22" r="8" s="0">
<Expand/>
</C>
<C c="0" r="9" s="0">
<Expand/>
</C>
<C c="2" r="9" cs="21" rs="5" s="0">
<O t="SubReport">
<SubReportAttr extendOwnerParameter="true"/>
<packee class="com.fr.main.impl.LinkWorkBookTemplate">
<Path>
<![CDATA[print_saleschild1.cpt]]></Path>
</packee>
<KVS/>
</O>
<Expand/>
</C>
<C c="0" r="10" s="0">
<Expand/>
</C>
<C c="1" r="10">
<Expand/>
</C>
<C c="0" r="11" s="0">
<Expand/>
</C>
<C c="1" r="11">
<Expand/>
</C>
<C c="0" r="12" s="0">
<Expand/>
</C>
<C c="1" r="12">
<Expand/>
</C>
<C c="0" r="13" s="0">
<Expand/>
</C>
<C c="1" r="13">
<Expand/>
</C>
<C c="6" r="14">
<Expand/>
</C>
<C c="7" r="14" cs="16" s="2">
<O t="SubReport">
<SubReportAttr/>
<packee class="com.fr.main.impl.LinkWorkBookTemplate">
<Path>
<![CDATA[print_saleschild3.cpt]]></Path>
</packee>
<KVS/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="15">
<Expand/>
</C>
<C c="7" r="15" cs="16" s="2">
<O t="SubReport">
<SubReportAttr extendOwnerParameter="true"/>
<packee class="com.fr.main.impl.LinkWorkBookTemplate">
<Path>
<![CDATA[print_saleschild2.cpt]]></Path>
</packee>
<KVS/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="16" cs="14" rs="2" s="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售备注"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="18" r="16">
<Expand/>
</C>
<C c="19" r="16">
<Expand/>
</C>
<C c="20" r="16" cs="3" s="7">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="应收金额"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[IF($wFlag==1, $$$, IF($wFlag==-1, ($$$ * -1), $$$))]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="17">
<Expand/>
</C>
<C c="18" r="17">
<Expand/>
</C>
<C c="19" r="17">
<Expand/>
</C>
<C c="20" r="17" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="应收金额"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[IF($wFlag==1, CNMONEY($$$), IF($wFlag==-1, "(退) " + CNMONEY($$$), CNMONEY($$$)))]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="18" s="4">
<Expand/>
</C>
<C c="1" r="18" s="4">
<Expand/>
</C>
<C c="2" r="18" s="4">
<Expand/>
</C>
<C c="3" r="18" cs="4" s="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="收银员"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="18" cs="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="验光师"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="13" r="18" cs="4" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售员"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="19" r="18" s="6">
<Expand/>
</C>
<C c="21" r="18" cs="2" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="套餐标题"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="19" s="4">
<Expand/>
</C>
<C c="1" r="19" s="4">
<Expand/>
</C>
<C c="2" r="19" s="4">
<Expand/>
</C>
<C c="3" r="19" s="4">
<Expand/>
</C>
<C c="4" r="19" s="4">
<Expand/>
</C>
<C c="5" r="19" cs="6" s="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="配镜日期"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="19" s="4">
<Expand/>
</C>
<C c="12" r="19" s="4">
<Expand/>
</C>
<C c="13" r="19" cs="5" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="取镜日期"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="18" r="19" s="4">
<Expand/>
</C>
<C c="19" r="19" s="4">
<Expand/>
</C>
<C c="20" r="19" s="4">
<Expand/>
</C>
<C c="21" r="19" cs="2" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售门店"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="20" s="4">
<Expand/>
</C>
<C c="1" r="20" s="4">
<Expand/>
</C>
<C c="2" r="20" s="4">
<Expand/>
</C>
<C c="3" r="20" s="4">
<Expand/>
</C>
<C c="4" r="20" s="4">
<Expand/>
</C>
<C c="5" r="20" cs="5" s="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="取镜地点"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="20" s="4">
<Expand/>
</C>
<C c="11" r="20" s="4">
<Expand/>
</C>
<C c="12" r="20" s="4">
<Expand/>
</C>
<C c="13" r="20" s="4">
<Expand/>
</C>
<C c="14" r="20" cs="9" s="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="邮寄地址"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0" printBackground="false">
<PaperSetting>
<PaperSize width="27504000" height="17424000"/>
<Margin top="0" left="0" bottom="0" right="0"/>
</PaperSetting>
<Background name="NullBackground"/>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="true" windowPosition="1" align="0"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<Format class="com.fr.base.CoreDecimalFormat">
<![CDATA[###0.00]]></Format>
<FRFont name="SimSun" style="1" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
