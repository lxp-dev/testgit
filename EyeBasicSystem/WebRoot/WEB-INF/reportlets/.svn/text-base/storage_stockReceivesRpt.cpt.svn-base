<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="goodsNamerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="instockIDrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="financeAuditPersonNamerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="startTimerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="receiptpersonnamerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="sourceBillIDrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="billIDrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsIDrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="selcstpsupplieridrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="createStartTimerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="createEndTimerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="selbspcategoryidrpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="auditStaterpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endTimerpt"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[DECLARE @billIDrpt                 VARCHAR(50),
        @sourceBillIDrpt           VARCHAR(50),
        @selcstpsupplieridrpt      VARCHAR(50),
        @instockIDrpt              VARCHAR(50),
        @auditStaterpt             VARCHAR(50),
        @startTimerpt              VARCHAR(50),
        @endTimerpt                VARCHAR(50),
        @createStartTimerpt              VARCHAR(50),
        @createEndTimerpt                VARCHAR(50),
        @receiptpersonnamerpt      VARCHAR(50),
        @financeAuditPersonNamerpt VARCHAR(50),
        @selbspcategoryidrpt       VARCHAR(50),
        @goodsNamerpt              VARCHAR(50),
        @goodsIDrpt                VARCHAR(50)

SET @billIDrpt = '${billIDrpt}'
SET @sourceBillIDrpt = '${sourceBillIDrpt}'
SET @selcstpsupplieridrpt = '${selcstpsupplieridrpt}'
SET @instockIDrpt = '${instockIDrpt}'
SET @auditStaterpt = '${auditStaterpt}'
SET @startTimerpt = '${startTimerpt}'
SET @endTimerpt = '${endTimerpt}'
SET @createStartTimerpt = '${createStartTimerpt}'
SET @createEndTimerpt = '${createEndTimerpt}'
SET @receiptpersonnamerpt = '${receiptpersonnamerpt}'
SET @financeAuditPersonNamerpt = '${financeAuditPersonNamerpt}'
SET @selbspcategoryidrpt = '${selbspcategoryidrpt}'
SET @goodsNamerpt = '${goodsNamerpt}'
SET @goodsIDrpt = '${goodsIDrpt}'

SELECT Isnull(C_ST_I_DeliveryID, '')                     AS DeliveryID,
       C_ST_IE_BillID                                    AS BillID,
       B_GI_SupplierID                                   AS SupplierID,
       B_SP_SupplierName                                 AS SupplierName,
       SUM(C_ST_IE_CostPriceAmount)                      AS CostPriceAmount,
       CONVERT(VARCHAR(10), C_ST_I_FinanceAuditDate, 23) AS FinanceAuditDate
FROM   C_ST_INVENTORYENTRY
       LEFT JOIN C_ST_Inventory
         ON C_ST_I_BillID = C_ST_IE_BillID
       LEFT JOIN B_WAREHOUSE
         ON B_WH_ID = C_ST_IE_InStockId
       LEFT JOIN SYS_PersonInfo a
         ON a.id = C_ST_I_AuditPerson
       LEFT JOIN SYS_PersonInfo b
         ON b.id = C_ST_I_FinanceAuditPerson
       LEFT JOIN B_GoodsInfo
         ON B_GI_GoodsID = C_ST_IE_GoodsId
       LEFT JOIN B_Supplier
         ON B_SP_ID = B_GI_SupplierID
WHERE  ( Isnull(@billIDrpt, '') = ''
          OR C_ST_IE_BillID = @billIDrpt )
       AND ( Isnull(@sourceBillIDrpt, '') = ''
              OR C_ST_I_SourceBillId = @sourceBillIDrpt )
       AND ( Isnull(@selcstpsupplieridrpt, '') = ''
              OR C_ST_I_SupplierId = @selcstpsupplieridrpt )
       AND ( Isnull(@instockIDrpt, '') = ''
              OR C_ST_I_InStockId = @instockIDrpt )
       AND ( Isnull(@auditStaterpt, '') = ''
              OR C_ST_I_FinanceAuditState = @auditStaterpt )
       AND ( Isnull(@startTimerpt, '') = ''
              OR CONVERT(VARCHAR(10), C_ST_I_FinanceAuditDate, 23) >= @startTimerpt )
       AND ( Isnull(@endTimerpt, '') = ''
              OR CONVERT(VARCHAR(10), C_ST_I_FinanceAuditDate, 23) <= @endTimerpt )
              
       AND ( Isnull(@createStartTimerpt, '') = ''
              OR CONVERT(VARCHAR(10), C_ST_I_billDate, 23) >= @createStartTimerpt )
       AND ( Isnull(@createEndTimerpt, '') = ''
              OR CONVERT(VARCHAR(10), C_ST_I_billDate, 23) <= @createEndTimerpt )
              
       AND ( Isnull(@receiptpersonnamerpt, '') = ''
              OR a.personName LIKE '%' + @receiptpersonnamerpt + '%' )
       AND ( Isnull(@financeAuditPersonNamerpt, '') = ''
              OR b.personName LIKE '%' + @financeAuditPersonNamerpt + '%' )
       AND ( Isnull(@selbspcategoryidrpt, '') = ''
              OR B_GI_GoodsCategoryID = @selbspcategoryidrpt )
       AND ( Isnull(@goodsNamerpt, '') = ''
              OR B_GI_GoodsName LIKE '%' + @goodsNamerpt + '%' )
       AND ( Isnull(@goodsIDrpt, '') = ''
              OR B_GI_GoodsID LIKE '%' + @goodsIDrpt + '%' )
       AND C_ST_IE_BillID LIKE 'PIN%'
GROUP  BY C_ST_I_DeliveryID,
          C_ST_IE_BillID,
          B_GI_SupplierID,
          B_SP_SupplierName,
          C_ST_I_FinanceAuditDate
ORDER  BY C_ST_I_FinanceAuditDate ]]></Query>
</TableData>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters/>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="3" T="3"/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[914400,952500,914400,914400,914400,914400,914400,723900,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[576000,0,1638300,495300,381000,2933700,2667000,2133600,2133600,7924800,3276600,3619500,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" s="0">
<Expand/>
</C>
<C c="2" r="0" cs="10" s="1">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" s="2">
<Expand/>
</C>
<C c="2" r="1" cs="10" s="3">
<O>
<![CDATA[采购结算单]]></O>
<Expand/>
</C>
<C c="2" r="3" cs="4" s="4">
<O>
<![CDATA[运单号]]></O>
<Expand/>
</C>
<C c="6" r="3" cs="3" s="4">
<O>
<![CDATA[收货单号]]></O>
<Expand/>
</C>
<C c="9" r="3" s="4">
<O>
<![CDATA[制造商]]></O>
<Expand/>
</C>
<C c="10" r="3" s="4">
<O>
<![CDATA[审核日期]]></O>
<Expand/>
</C>
<C c="11" r="3" s="4">
<O>
<![CDATA[价税合计]]></O>
<Expand/>
</C>
<C c="0" r="4" s="5">
<Expand/>
</C>
<C c="1" r="4">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="SupplierID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="4" cs="4" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="DeliveryID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="4" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="BillID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="4" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="4" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="FinanceAuditDate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="11" r="4" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="CostPriceAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="5" s="7">
<Expand/>
</C>
<C c="1" r="5" s="7">
<Expand/>
</C>
<C c="2" r="5" cs="9" s="8">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA['按制造商 '+$$$ + ' 小计：']]></Result>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="B5"/>
</C>
<C c="11" r="5" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(L5))]]></Attributes>
</O>
<Expand/>
</C>
<C c="0" r="6" s="10">
<Expand/>
</C>
<C c="1" r="6" s="10">
<Expand/>
</C>
<C c="2" r="6" cs="9" s="11">
<O>
<![CDATA[合计:]]></O>
<Expand dir="1"/>
</C>
<C c="11" r="6" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(L6))]]></Attributes>
</O>
<Expand dir="1"/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting>
<Margin top="0" left="719999" bottom="0" right="0"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="120"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
</StyleList>
</WorkBook>
