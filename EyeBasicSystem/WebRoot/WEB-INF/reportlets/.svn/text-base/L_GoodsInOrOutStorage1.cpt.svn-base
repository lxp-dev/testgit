<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
if ('${shopCode}' <> 'suoyou')
begin

select goodsCategoryID,goodsCategoryName,
       isnull(sum(qcgoodsQuantity),0) as qcgoodsQuantity,isnull(sum(qcnottaxrateamount),0) as qcnottaxrateamount,
       isnull(sum(bqgoodsQuantity),0) as bqgoodsQuantity,isnull(sum(bqnottaxrateamount),0) as bqnottaxrateamount,
       isnull(sum(fcgoodsQuantity),0) as fcgoodsQuantity,isnull(sum(fcnottaxrateamount),0) as fcnottaxrateamount,
       isnull(sum(fcshouru),0) as fcshouru

  from (

select goodsCategoryID,supplierID,brandID,goodsID as goodsID,goodsName as goodsName,
       goodsCategoryName,supplierName,brandName,
       sum(qcgoodsQuantity) as qcgoodsQuantity,sum(qcnottaxrateamount) as qcnottaxrateamount,
       0 as bqgoodsQuantity,0 as bqnottaxrateamount,0 as fcgoodsQuantity,0 as fcnottaxrateamount,0 as fcshouru

 from (
select L_CT_CT_GoodsID as goodsID,B_GI_GoodsName as goodsName,sum(L_CT_CT_GoodsQuantity) as qcgoodsQuantity,
       sum(L_CT_CT_Goodsnottaxrateamount) as qcnottaxrateamount,B_GI_GoodsCategoryID as goodsCategoryID,
       B_GI_SupplierID as supplierID,B_GI_BrandID as brandID,
       B_GC_GoodsCategoryName as goodsCategoryName,B_SP_SupplierName as supplierName,B_BD_brandName as brandName
  from L_CT_CostingTemplate inner join B_GoodsInfo on L_CT_CT_GoodsID=B_GI_GoodsID
		inner join B_Brand on B_GI_SupplierID=B_BD_SupplierID and B_GI_BrandID=B_BD_ID
		inner join B_Supplier on B_GI_SupplierID=B_SP_ID
		inner join B_GoodsCategory on B_GI_GoodsCategoryID=B_GC_ID
  where 1=1 and (isnull('${shopCode}','')<>'suoyou' and L_CT_CT_DepartmentID=isnull('${shopCode}',''))
        and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by L_CT_CT_GoodsID,B_GI_GoodsName,B_GI_GoodsCategoryID,B_GI_SupplierID,B_GI_BrandID
           ,B_GC_GoodsCategoryName,B_SP_SupplierName,B_BD_brandName
union all
select R_IO_GIO_GoodsID as goodsID,R_IO_GIO_GoodsName as goodsName,sum(isnull(R_IO_GIO_GoodsInNum,0)-isnull(R_IO_GIO_GoodsOutNum,0)) as qcgoodsQuantity,
       sum(isnull(R_IO_GIO_InNotTaxRateAmount,0)-isnull(R_IO_GIO_OutAvgNotTaxRate,0)) as qcnottaxrateamount,
       R_IO_GIO_GoodsCategoryID as goodsCategoryID,R_IO_GIO_SupplierID as supplierID,R_IO_GIO_BandID as brandID,
       R_IO_GIO_GoodsCategoryName as goodsCategoryName,R_IO_GIO_SupplierName as supplierName,R_IO_GIO_BandName as bandName
  from R_IO_GoodsInOrOutByDpt
  where R_IO_GIO_Date < isnull('${bgnDate}','')
        and (isnull('${shopCode}','')<>'suoyou' and R_IO_GIO_DepartmentID=isnull('${shopCode}',''))
        and ((isnull('${goodsCategoryID}','')<>'' and R_IO_GIO_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by R_IO_GIO_GoodsID,R_IO_GIO_GoodsName,R_IO_GIO_GoodsCategoryID,R_IO_GIO_SupplierID,R_IO_GIO_BandID
           ,R_IO_GIO_GoodsCategoryName,R_IO_GIO_SupplierName,R_IO_GIO_BandName
   
)temp
  group by goodsCategoryID,supplierID,brandID,goodsID,goodsName,goodsCategoryName,supplierName,brandName

union all

select  R_IO_GIO_GoodsCategoryID as goodsCategoryID,R_IO_GIO_SupplierID as supplierID,R_IO_GIO_BandID as brandID,R_IO_GIO_GoodsID as goodsID,R_IO_GIO_GoodsName as goodsName,
        R_IO_GIO_GoodsCategoryName as goodsCategoryName,R_IO_GIO_SupplierName as supplierName,R_IO_GIO_BandName as bandName,
        0 as qcgoodsQuantity,0 as qcnottaxrateamount,
        isnull(sum(R_IO_GIO_GoodsInNum),0) as bqgoodsQuantity,isnull(sum(R_IO_GIO_InNotTaxRateAmount),0) as bqnottaxrateamount,
        isnull(sum(R_IO_GIO_GoodsOutNum),0) as fcgoodsQuantity,isnull(sum(R_IO_GIO_OutAvgNotTaxRate),0) as fcnottaxrateamount,
        isnull(sum(R_IO_GIO_SalesValue),0) as fcshouru
        
  from R_IO_GoodsInOrOutByDpt
  where R_IO_GIO_Date >= isnull('${bgnDate}','') and R_IO_GIO_Date <= isnull('${endDate}','')
        and (isnull('${shopCode}','')<>'suoyou' and R_IO_GIO_DepartmentID=isnull('${shopCode}',''))
        and ((isnull('${goodsCategoryID}','')<>'' and R_IO_GIO_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by R_IO_GIO_GoodsCategoryID,R_IO_GIO_SupplierID,R_IO_GIO_BandID,R_IO_GIO_GoodsID,R_IO_GIO_GoodsName,
           R_IO_GIO_GoodsCategoryName,R_IO_GIO_SupplierName,R_IO_GIO_BandName

)temp
  group by goodsCategoryID,goodsCategoryName
  order by goodsCategoryID

end
begin

select goodsCategoryID,goodsCategoryName,
       isnull(sum(qcgoodsQuantity),0) as qcgoodsQuantity,isnull(sum(qcnottaxrateamount),0) as qcnottaxrateamount,
       isnull(sum(bqgoodsQuantity),0) as bqgoodsQuantity,isnull(sum(bqnottaxrateamount),0) as bqnottaxrateamount,
       isnull(sum(fcgoodsQuantity),0) as fcgoodsQuantity,isnull(sum(fcnottaxrateamount),0) as fcnottaxrateamount,
       isnull(sum(fcshouru),0) as fcshouru

  from (

select goodsCategoryID,supplierID,brandID,goodsID as goodsID,goodsName as goodsName,
       goodsCategoryName,supplierName,brandName,
       sum(qcgoodsQuantity) as qcgoodsQuantity,sum(qcnottaxrateamount) as qcnottaxrateamount,
       0 as bqgoodsQuantity,0 as bqnottaxrateamount,0 as fcgoodsQuantity,0 as fcnottaxrateamount,0 as fcshouru

 from (
select L_CT_CT_GoodsID as goodsID,B_GI_GoodsName as goodsName,sum(L_CT_CT_GoodsQuantity) as qcgoodsQuantity,
       sum(L_CT_CT_Goodsnottaxrateamount) as qcnottaxrateamount,B_GI_GoodsCategoryID as goodsCategoryID,
       B_GI_SupplierID as supplierID,B_GI_BrandID as brandID,
       B_GC_GoodsCategoryName as goodsCategoryName,B_SP_SupplierName as supplierName,B_BD_brandName as brandName
  from L_CT_CostingTemplate inner join B_GoodsInfo on L_CT_CT_GoodsID=B_GI_GoodsID
		inner join B_Brand on B_GI_SupplierID=B_BD_SupplierID and B_GI_BrandID=B_BD_ID
		inner join B_Supplier on B_GI_SupplierID=B_SP_ID
		inner join B_GoodsCategory on B_GI_GoodsCategoryID=B_GC_ID
  where 1=1 
        and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by L_CT_CT_GoodsID,B_GI_GoodsName,B_GI_GoodsCategoryID,B_GI_SupplierID,B_GI_BrandID
           ,B_GC_GoodsCategoryName,B_SP_SupplierName,B_BD_brandName
union all
select R_IO_GIO_GoodsID as goodsID,R_IO_GIO_GoodsName as goodsName,sum(isnull(R_IO_GIO_GoodsInNum,0)-isnull(R_IO_GIO_GoodsOutNum,0)) as qcgoodsQuantity,
       sum(isnull(R_IO_GIO_InNotTaxRateAmount,0)-isnull(R_IO_GIO_OutAvgNotTaxRate,0)) as qcnottaxrateamount,
       R_IO_GIO_GoodsCategoryID as goodsCategoryID,R_IO_GIO_SupplierID as supplierID,R_IO_GIO_BandID as brandID,
       R_IO_GIO_GoodsCategoryName as goodsCategoryName,R_IO_GIO_SupplierName as supplierName,R_IO_GIO_BandName as bandName
  from R_IO_GoodsInOrOutAll
  where R_IO_GIO_Date < isnull('${bgnDate}','')
        and ((isnull('${goodsCategoryID}','')<>'' and R_IO_GIO_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by R_IO_GIO_GoodsID,R_IO_GIO_GoodsName,R_IO_GIO_GoodsCategoryID,R_IO_GIO_SupplierID,R_IO_GIO_BandID
           ,R_IO_GIO_GoodsCategoryName,R_IO_GIO_SupplierName,R_IO_GIO_BandName
   
)temp
  group by goodsCategoryID,supplierID,brandID,goodsID,goodsName,goodsCategoryName,supplierName,brandName

union all

select  R_IO_GIO_GoodsCategoryID as goodsCategoryID,R_IO_GIO_SupplierID as supplierID,R_IO_GIO_BandID as brandID,R_IO_GIO_GoodsID as goodsID,R_IO_GIO_GoodsName as goodsName,
        R_IO_GIO_GoodsCategoryName as goodsCategoryName,R_IO_GIO_SupplierName as supplierName,R_IO_GIO_BandName as bandName,
        0 as qcgoodsQuantity,0 as qcnottaxrateamount,
        isnull(sum(R_IO_GIO_GoodsInNum),0) as bqgoodsQuantity,isnull(sum(R_IO_GIO_InNotTaxRateAmount),0) as bqnottaxrateamount,
        isnull(sum(R_IO_GIO_GoodsOutNum),0) as fcgoodsQuantity,isnull(sum(R_IO_GIO_OutAvgNotTaxRate),0) as fcnottaxrateamount,
        isnull(sum(R_IO_GIO_SalesValue),0) as fcshouru
        
  from R_IO_GoodsInOrOutAll
  where R_IO_GIO_Date >= isnull('${bgnDate}','') and R_IO_GIO_Date <= isnull('${endDate}','')
        and ((isnull('${goodsCategoryID}','')<>'' and R_IO_GIO_GoodsCategoryID=isnull('${goodsCategoryID}','')) or (isnull('${goodsCategoryID}','')=''))

  group by R_IO_GIO_GoodsCategoryID,R_IO_GIO_SupplierID,R_IO_GIO_BandID,R_IO_GIO_GoodsID,R_IO_GIO_GoodsName,
           R_IO_GIO_GoodsCategoryName,R_IO_GIO_SupplierName,R_IO_GIO_BandName

)temp
  group by goodsCategoryID,goodsCategoryName
  order by goodsCategoryID


end
]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="departmentName"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 ('查询日期:' + '${bgnDate}' + '--' + '${endDate}' + '    查询部门:' + '${departmentName}' ) as queryDate
]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.page.First">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-First')}]]></Text>
<IconName>
<![CDATA[first]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Previous">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Previous')}]]></Text>
<IconName>
<![CDATA[previous]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.PageNavi">
<WidgetAttr/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Next">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Next')}]]></Text>
<IconName>
<![CDATA[next]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Last">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Last')}]]></Text>
<IconName>
<![CDATA[last]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.Export">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Export')}]]></Text>
<IconName>
<![CDATA[export]]></IconName>
<Buttons pdf="true" excelP="true" excelO="true" excelS="true" word="true" image="true" html="true"/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.PDFPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[pdfprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<ReportExportAttr>
<ExcelExportAttr hideColumn="false" hideRow="false"/>
<PDFExportAttr/>
<HTMLExportAttr/>
</ReportExportAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="5"/>
<FR F="8" T="8"/>
<HC F="0" T="1"/>
<FC/>
<UPFCR COLUMN="true" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[1143000,1143000,989280,989280,1828800,1028700,914400,914400,762000,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[4320000,5760000,2880000,2880000,4038600,2880000,2362200,2880000,2880000,2880000,2880000,2880000,2880000,3276600,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="13" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" cs="13" s="1">
<O>
<![CDATA[商品进销存表(商品类型)]]></O>
<Expand/>
</C>
<C c="0" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="1" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="2" s="2">
<O>
<![CDATA[查询时间：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="2" cs="2" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate + " 至 " + $endDate]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="2" s="2">
<O>
<![CDATA[部门名称：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="2" cs="3" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentName]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="2">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="10" r="2" s="2">
<O>
<![CDATA[汇总方式：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="11" r="2">
<O>
<![CDATA[商品类型]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="2" s="3">
<O>
<![CDATA[]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="0" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="1" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="2" r="3" s="2">
<O>
<![CDATA[商品代码：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="3" cs="2" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsID]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="3" s="2">
<O>
<![CDATA[商品名称：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="3" cs="3" s="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsName]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="10" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="11" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[
$isShow==1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="0" r="4" rs="2" s="4">
<O>
<![CDATA[商品类型代码]]></O>
<Expand/>
</C>
<C c="1" r="4" rs="2" s="4">
<O>
<![CDATA[商品类型名称]]></O>
<Expand/>
</C>
<C c="2" r="4" cs="2" s="4">
<O>
<![CDATA[期初]]></O>
<Expand/>
</C>
<C c="4" r="4" cs="2" s="4">
<O>
<![CDATA[收入(采收收货 + 委外收货 - 采购退货)]]></O>
<Expand/>
</C>
<C c="6" r="4" cs="5" s="4">
<O>
<![CDATA[发出(销售出库 + 盘亏 - 盘盈)]]></O>
<Expand/>
</C>
<C c="11" r="4" cs="2" s="4">
<O>
<![CDATA[期末]]></O>
<Expand/>
</C>
<C c="2" r="5" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="3" r="5" s="4">
<O>
<![CDATA[不含税成本金额]]></O>
<Expand/>
</C>
<C c="4" r="5" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="5" r="5" s="4">
<O>
<![CDATA[不含税成本金额]]></O>
<Expand/>
</C>
<C c="6" r="5" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="7" r="5" s="4">
<O>
<![CDATA[不含税成本金额]]></O>
<Expand/>
</C>
<C c="8" r="5" s="4">
<O>
<![CDATA[销售不含税成本金额]]></O>
<Expand/>
</C>
<C c="9" r="5" s="4">
<O>
<![CDATA[销售毛利]]></O>
<Expand/>
</C>
<C c="10" r="5" s="4">
<O>
<![CDATA[毛利率]]></O>
<Expand/>
</C>
<C c="11" r="5" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="12" r="5" s="4">
<O>
<![CDATA[不含税成本金额]]></O>
<Expand/>
</C>
<C c="0" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="goodsCategoryID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[(ROW() - 5) % 30 = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.PageHighlightAction">
<P i="1"/>
</HighlightAction>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="1" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="goodsCategoryName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="qcgoodsQuantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="qcnottaxrateamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="bqgoodsQuantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopCode]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=A7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="brandID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="inOrOut"/>
<O>
<![CDATA[1]]></O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=L_GoodsInOrOutStorageDetail.cpt&__bypagesize__=false&shopCode="+shopCode+"&bgnDate="+bgnDate+"&endDate="+endDate+"&goodsID="+goodsID+"&goodsName="+goodsName+"&goodsCategoryID="+goodsCategoryID+"&supplierID="+supplierID+"&brandID="+brandID+"&inOrOut="+inOrOut+"&isShow"+isShow+"&logincompanyid="+logincompanyid; 
openWindowForReport(DataURL); ]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="5" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="bqnottaxrateamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="6" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="fcgoodsQuantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript1">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopCode]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=A7]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="brandID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="inOrOut"/>
<O>
<![CDATA[1]]></O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="logincompanyid"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$logincompanyid]]></Attributes>
</O>
</Parameter>
</Parameters>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=L_GoodsInOrOutStorageDetail2.cpt&__bypagesize__=false&shopCode="+shopCode+"&bgnDate="+bgnDate+"&endDate="+endDate+"&goodsID="+goodsID+"&goodsName="+goodsName+"&goodsCategoryID="+goodsCategoryID+"&supplierID="+supplierID+"&brandID="+brandID+"&inOrOut="+inOrOut+"&isShow"+isShow+"&logincompanyid="+logincompanyid;  
openWindowForReport(DataURL); ]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<Expand dir="0"/>
</C>
<C c="7" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="fcshouru"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="6" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="fcnottaxrateamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="6" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(H7 - I7))]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="6" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=if(H7 = 0, "0.00%", CONCATENATE(FuncOne(J7 / H7 * 100), "%"))]]></Attributes>
</O>
<Expand/>
</C>
<C c="11" r="6" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(C7 + E7 + G7)]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="12" r="6" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(D7 + F7 + I7))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="7" cs="2" s="7">
<O>
<![CDATA[总合计：]]></O>
<Expand dir="0"/>
</C>
<C c="2" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(C7)]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(D7))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(E7)]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(F7))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(G7)]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(H7))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(I7))]]></Attributes>
</O>
<Expand/>
</C>
<C c="9" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(j7))]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=if(H8 = 0, "0.00%", CONCATENATE(FuncOne(J8 / H8 * 100), "%"))]]></Attributes>
</O>
<Expand/>
</C>
<C c="11" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(L7)]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="12" r="7" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(M7))]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="8" cs="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期：" + today()]]></Attributes>
</O>
<Expand/>
</C>
<C c="8" r="8" cs="5" s="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="页次:第 " + $$page_number + " 页/共 " + $$totalPage_number + " 页"]]></Attributes>
</O>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="33912000" height="46411200"/>
<Margin top="986400" left="1438560" bottom="986400" right="1438560"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="112"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="88"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="76"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="76" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="76" foreground="-65536"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="76" foreground="-65536"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
