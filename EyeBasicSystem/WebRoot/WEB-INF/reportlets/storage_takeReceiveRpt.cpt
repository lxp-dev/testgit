<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="BillID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select
C_ST_I_BillID as cstibillid,--单据编号
CONVERT(VARCHAR(10),C_ST_I_billDate,23) as cstibilldate,--单据日期
C_ST_I_OutStockId as cstioutstockid,--发出仓位
B_Warehouse.B_WH_warehouseName as cstioutstockname,--发出仓位名称
C_ST_I_SupplierId as cstisupplierid,--制造商/客户
B_Customer.B_CT_CustomerName as cstisuppliername,--制造商名称/客户名称
C_ST_I_DepartmentId as cstidepartmentid,--采购/销售部门
case 
when C_ST_I_TakeType = '1' then (select B_DP_DepartmentName from B_departments where B_DP_DepartmentID=C_ST_I_DepartmentId) 
when C_ST_I_TakeType = '2' then (select B_FS_StoreName from B_Franchisee where B_FS_StoreID=C_ST_I_DepartmentId) 
end as departmentName,
C_ST_I_createPerson as csticreateperson,--制单人
C_ST_I_AuditPerson as cstiauditperson,--审核人
a.personName as csticreatepersonname,--制单人姓名
b.personName as cstiauditpersonname,--审核人姓名
C_ST_I_AuditState as cstiauditstate,--审核状态
CONVERT(VARCHAR(10),C_ST_I_AuditDate,23)as cstiauditdate,--审核日期
C_ST_I_Remark as cstiremark,--备注
C_ST_I_TakeType as taketype
 from C_ST_TakeInventory
left join B_Customer on C_ST_I_SupplierId=B_Customer.B_CT_ID
left join B_Warehouse on C_ST_I_OutStockId=B_Warehouse.B_WH_ID
left join (select ID,personName from SYS_PersonInfo)a on C_ST_I_createPerson=a.ID
left join (select ID,personName from SYS_PersonInfo)b on C_ST_I_AuditPerson=b.ID
where C_ST_I_BillID='${BillID}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="BillID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select cstiegoodsid,cstiegoodsname,sum(cstiegoodsquantity) as cstiegoodsquantity,
id as id, unitName as unitName,
 cstiecostprice,sum(cstiecostpriceamount) as cstiecostpriceamount,
warehouseName as warehouseName,remark as remark
from(
select 
C_ST_IE_ID as cstieid,-- 唯一编号
subString(C_ST_IE_GoodsId,1,7) as cstiegoodsid,--商品代码
B_GoodsInfo.B_GI_GoodsName as cstiegoodsname,--商品名称
C_ST_IE_GoodsQuantity as cstiegoodsquantity,--商品数量
B_UT_id as id,--单位id
B_UT_unitName as unitName,--单位
B_GoodsInfo.B_GI_Spec as cstiespec,--规格
C_ST_IE_NotTaxRate as cstienottaxrate,--单位成本(不含税)
C_ST_IE_NotTaxRateAmount as cstienottaxrateamount,--成本合计(不含税)
C_ST_IE_TaxRate as cstietaxrate,--税率
C_ST_IE_TakePrice as cstiecostprice,--含税单价
C_ST_IE_TakePriceAmount as cstiecostpriceamount,--价税合计
C_ST_IE_TaxAmount as cstietaxamount,--税额合计
C_ST_IE_OutStockId as cstieoutstockid,--发出仓位
B_Warehouse.B_WH_warehouseName as warehouseName ,--发出仓位名称
C_ST_IE_BarCode as cstiebarcode,--条码
C_ST_IE_Remark as remark ,--备注
CONVERT(VARCHAR(10),C_ST_IE_WarehousingDate,23) as cstiewarehousingdate--入库日期
from C_ST_TakeInventoryEntry
inner join B_GoodsInfo on C_ST_IE_GoodsId=B_GoodsInfo.B_GI_GoodsID 
inner join B_Warehouse on C_ST_IE_OutStockId=B_Warehouse.B_WH_ID
left join (select B_UT_id,B_UT_unitName from B_Unit)a on B_GoodsInfo.B_GI_UnitId=a.B_UT_id
where C_ST_IE_BillID='${BillID}' ) temp

group by cstiegoodsid,cstiegoodsname,id,unitName,cstiecostprice,warehouseName,remark]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="BillID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select sum(C_ST_IE_GoodsQuantity) as cstiegoodsquantity,--商品数量
       sum(C_ST_IE_CostPrice)as cstiecostprice,--含税单价
	   sum(C_ST_IE_CostPriceAmount) as cstiecostpriceamount--价税合计
       from C_ST_TakeInventoryEntry	where C_ST_IE_BillID='${BillID}']]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="3" T="3"/>
<FR F="9" T="9"/>
<HC/>
<FC/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[914400,914400,914400,914400,914400,914400,342900,762000,762000,762000,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[609600,2628900,952500,3581400,2209800,2705100,2628900,2667000,2667000,4229100,647700,1181100,1181100,2743200]]></ColumnWidth>
<CellElementList>
<C c="1" r="0" cs="12" s="0">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="1" cs="12" s="1">
<O>
<![CDATA[领用出库单]]></O>
<Expand/>
</C>
<C c="1" r="2" s="2">
<O>
<![CDATA[出库单号：]]></O>
<Expand/>
</C>
<C c="2" r="2" cs="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="cstibillid"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="2" s="3">
<O>
<![CDATA[制单日期：]]></O>
<Expand/>
</C>
<C c="6" r="2" cs="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="cstibilldate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="2" s="3">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="taketype"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[if($$$='1','部门：','客户：')]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="2" cs="4">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="departmentName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="3" cs="2" s="4">
<O>
<![CDATA[商品代码]]></O>
<Expand/>
</C>
<C c="3" r="3" cs="2" s="4">
<O>
<![CDATA[商品名称]]></O>
<Expand/>
</C>
<C c="5" r="3" s="4">
<O>
<![CDATA[单位]]></O>
<Expand/>
</C>
<C c="6" r="3" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="7" r="3" s="4">
<O>
<![CDATA[领料单价]]></O>
<Expand/>
</C>
<C c="8" r="3" s="4">
<O>
<![CDATA[金额合计]]></O>
<Expand/>
</C>
<C c="9" r="3" s="4">
<O>
<![CDATA[发出仓位]]></O>
<Expand/>
</C>
<C c="10" r="3" cs="3" s="4">
<O>
<![CDATA[备注]]></O>
<Expand/>
</C>
<C c="1" r="4" cs="2" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="cstiegoodsid"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="4" cs="2" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="cstiegoodsname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="4" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="unitName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="4" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="cstiegoodsquantity"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="4" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="cstiecostprice"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="8" r="4" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="cstiecostpriceamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="4" s="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="warehouseName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="4" cs="3" s="6">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="remark"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="5" cs="4" s="4">
<O>
<![CDATA[合计:]]></O>
<Expand/>
</C>
<C c="5" r="5" s="4">
<Expand/>
</C>
<C c="6" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="cstiegoodsquantity"/>
<Condition class="com.fr.data.condition.ListCondition"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.SummaryGrouper">
<FN>
<![CDATA[com.fr.data.util.function.SumFunction]]></FN>
</RG>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand/>
</C>
<C c="7" r="5" s="7">
<Expand/>
</C>
<C c="8" r="5" s="4">
<O t="DSColumn">
<Attributes dsName="ds4" columnName="cstiecostpriceamount"/>
<Condition class="com.fr.data.condition.ListCondition"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.SummaryGrouper">
<FN>
<![CDATA[com.fr.data.util.function.SumFunction]]></FN>
</RG>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand/>
</C>
<C c="9" r="5" cs="4" s="6">
<Expand/>
</C>
<C c="1" r="6" cs="9">
<Expand/>
</C>
<C c="1" r="7" s="2">
<O>
<![CDATA[备注：]]></O>
<Expand/>
</C>
<C c="2" r="7" cs="11">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="cstiremark"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="8" s="2">
<O>
<![CDATA[制单人：]]></O>
<Expand/>
</C>
<C c="2" r="8" cs="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="csticreatepersonname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="8" s="2">
<O>
<![CDATA[审核人：]]></O>
<Expand/>
</C>
<C c="5" r="8">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="cstiauditpersonname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="6" r="8" s="2">
<O>
<![CDATA[审核日期：]]></O>
<Expand/>
</C>
<C c="7" r="8" cs="2">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="cstiauditdate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="8">
<Expand/>
</C>
<C c="1" r="9">
<O>
<![CDATA[打印日期：]]></O>
<Expand/>
</C>
<C c="2" r="9" cs="2">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=TODAY()]]></Attributes>
</O>
<Expand/>
</C>
<C c="7" r="9" cs="6" s="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="页次:第 " + $$page_number + " 页/共 " + $$totalPage_number + " 页"]]></Attributes>
</O>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting>
<PaperSize width="30240000" height="21384000"/>
<Margin top="0" left="718560" bottom="0" right="0"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="108"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="108"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
