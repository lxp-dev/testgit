<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT S_SE_SB_SalesID           AS '销售单号',
       S_SE_SB_ShopCode          AS '店号',
       xsdd.B_DP_DepartmentName  AS '销售店名',
       S_ME_CI_MemberId          AS '顾客号',
       S_ME_CI_Name              AS '顾客姓名',
       ( CASE S_ME_CI_Sex
           WHEN '0' THEN '男'
           WHEN '1' THEN '女'
           ELSE ''
         END )                   AS '顾客性别',
       S_ME_CI_Phone             AS '顾客电话',
       S_ME_CI_CardType          AS '顾客卡类型',
       S_SE_SB_OptID             AS '验光号-验光基表',
       S_SE_SB_OptometryID       AS '验光病历号',
S_OP_Optometry.S_OP_OY_PersonID AS '验光师ID',
yg.personName AS '验光师姓名',
       S_SE_SB_InspectionID      AS '检查结论ID',
       S_SE_SB_TakeGlassData     AS '取镜日期',
       CONVERT(VARCHAR(10), S_SE_SB_SalesDatetime, 23)  AS '销售日期',
       S_SE_SB_OrdersType        AS '订单类型',
       ( CASE S_SE_SB_OrdersType
           WHEN '1' THEN '镜架成品片'
           WHEN '2' THEN '镜架订做片'
           WHEN '3' THEN '隐形成品片'
           WHEN '4' THEN '隐形订做片'
           WHEN '5' THEN '辅料'
           ELSE ''
         END )                   AS '订单类型名称',
       S_SE_SB_BallGlassOD       AS '右眼球镜',
       S_SE_SB_BallGlassOS       AS '左眼球镜',
       S_SE_SB_PostGlassOD       AS '右眼柱镜',
       S_SE_SB_PostGlassOS       AS '左眼柱镜',
       S_SE_SB_AxesOD            AS '右眼轴向',
       S_SE_SB_AxesOS            AS '左眼轴向',
       S_SE_SB_ADDOD             AS '右眼add',
       S_SE_SB_ADDOS             AS '左眼add',
       S_SE_SB_ArriseGlassOD1    AS '右眼三棱镜',
       S_SE_SB_ArriseGlassOS1    AS '左眼三棱镜',
       S_SE_SB_ADDOD +' '+ S_SE_SB_ArriseGlassOD1    AS '右眼add右眼三棱镜',
       S_SE_SB_ADDOS +' '+ S_SE_SB_ArriseGlassOS1    AS '左眼add左眼三棱镜',
       S_SE_SB_BasisOD1          AS '右眼基底1',
       S_SE_SB_BasisOS1          AS '左眼基底1',
       S_SE_SB_PrismOD           AS '右眼棱镜',
       S_SE_SB_PrismOS           AS '左眼棱镜',
       ( CASE S_SE_SB_RecipeType
           WHEN '1' THEN ISNULL(S_SE_SB_InterHighOD,'')
           WHEN '2' THEN ISNULL(S_SE_SB_InterDistanceOD,'')
           WHEN '3' THEN ISNULL(S_SE_SB_InterHighOD,'')
           WHEN '5' THEN ISNULL(S_SE_SB_InterHighOD,'')
           ELSE ''
         END )                   AS '右眼瞳距',
       ( CASE S_SE_SB_RecipeType
           WHEN '1' THEN ISNULL(S_SE_SB_InterHighOS,'')
           WHEN '2' THEN ISNULL(S_SE_SB_InterDistanceOS,'')
           WHEN '3' THEN ISNULL(S_SE_SB_InterHighOS,'')
           WHEN '5' THEN ISNULL(S_SE_SB_InterHighOS,'')
           ELSE ''
         END )                   AS '左眼瞳距',
       ISNULL(S_SE_SB_FarVAOD, S_SE_SB_CloseVAOD)           AS '右眼VA',
       ISNULL(S_SE_SB_FarVAOS, S_SE_SB_CloseVAOS)           AS '左眼VA',
       S_SE_SB_RecipeType        AS '处方形式',
       ( CASE S_SE_SB_RecipeType
           WHEN '1' THEN '远用'
           WHEN '2' THEN '近用'
           WHEN '3' THEN '渐进/双光'
           WHEN '4' THEN '隐形'
           WHEN '5' THEN '中用'
           WHEN '6' THEN '角膜塑形'
           WHEN '7' THEN '视觉训练'
           ELSE ''
         END )                   AS '处方形式名称',
       S_SE_SB_DignosisRe        AS '备注',
       S_SE_SB_DiameterOD        AS '隐形右眼直径',
       S_SE_SB_DiameterOS        AS '隐形左眼直径',
       S_SE_SB_ConRecipeType     AS '隐形处理方式',
       S_SE_SB_SecCheckDate      AS '复诊时间',
       S_SE_SB_SubVisitUnit      AS '复诊时间单位',
       S_SE_SB_SalesType         AS '销售类型',
       ( CASE S_SE_SB_SalesType
           WHEN '1' THEN '内方'
           WHEN '2' THEN '外方'
           WHEN '3' THEN '辅料'
           ELSE ''
         END )                   AS '销售类型',
       S_SE_SB_SalerID           AS '销售人员ID',
       xs.personName             AS '销售员姓名',
       S_SE_SB_Lryid             AS '录入员ID',
       lr.personName             AS '录入员姓名',
       S_SE_SB_FactPosDatetime       AS '收银日期',
       S_SE_SB_PosID             AS '收银员ID',
       sy.personName             AS '收银员姓名',
       S_SE_SB_PriceSum          AS '原价合计',
       S_SE_SB_SalesValue        AS '应收金额',
       S_SE_SB_EyeCurvatureOD1   AS '隐形右眼曲率1',
       S_SE_SB_EyeCurvatureOD2   AS '隐形右眼曲率2',
       S_SE_SB_EyeCurvatureOS1   AS '隐形左眼曲率1',
       S_SE_SB_EyeCurvatureOS2   AS '隐形左眼曲率2',
       S_SE_SB_DiscountRate      AS '折扣率',
       S_SE_SB_DiscountNum       AS '折扣金额',
       S_SE_SB_Psalsvalue        AS '实缴金额',
       S_SE_SB_ArrearsValue      AS '欠款金额',
       S_SE_SB_Location          AS '取镜地点',
       qjdd.B_DP_DepartmentName  AS '销售店名',
       S_SE_SB_ArrivedDate       AS '到镜日期',
       S_SE_SB_ValueFlag         AS '收费标志',
       ( CASE S_SE_SB_ValueFlag
           WHEN '0' THEN '未收费'
           WHEN '1' THEN '已收费'
           ELSE ''
         END )                   AS '收费状态',
       S_SE_SB_CheckoutFlag      AS '欠费标志',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '0' THEN '未欠费'
           WHEN '1' THEN '欠费'
           ELSE ''
         END )                   AS '欠费状态',
       S_SE_SB_InTransit         AS '配镜单当前在途状态',
       S_SE_SB_FactWithdrawDate      AS '退费日期',
       S_SE_SB_WithdrawFlag      AS '退费标示位',
       S_SE_SB_WithdrawPersonID  AS '退费人员',
       sy.personName             AS '退费人员姓名',
       S_SE_SB_MovementType      AS '活动类型ID',
       S_SE_SB_FactArrearsAppendDate AS '补齐欠款日期',
       S_SE_SB_ArrearsDate       AS '欠款日期',
       S_SE_SB_PayCash           AS '缴费现金金额',
       S_SE_SB_BankCard          AS '缴费银行卡金额',
       S_SE_SB_StoredCard        AS '缴费储值卡金额',
       S_SE_SB_Renums            AS '抹零金额',
       S_SE_SB_DiscountType      AS '折扣类型',
       S_SE_SB_DiscountPerson    AS '打折人',
       dz.personName             AS '打折人员姓名',
       S_SE_SB_DragsType         AS '委外类型',
       S_SE_SB_PupilHeightOD     AS '右眼瞳高',
       S_SE_SB_PupilHeightOS     AS '左眼瞳高',
       S_SE_SB_FavorableAmount,
       S_SE_SB_WorryType         AS '加急状态',
       S_SE_SB_Integral,
       S_SE_SB_SetMealID         AS '套餐ID',
       S_SM_SM_Title             AS '套餐名称',
       S_SE_SB_ExecStandard,
       S_SE_SB_SalesRemark       AS '销售备注',
       S_SE_SB_SourceSalesID,
       S_SE_SB_SwapGoodsFlag     AS '配镜单退款类型',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '1' THEN '整单退款'
           WHEN '2' THEN '部分退款'
           WHEN '3' THEN '部分换货'
           WHEN '4' THEN '直接退款'
           ELSE ''
         END )                   AS '配镜单退款类型名称',
       S_SE_SD_SalesItemID       AS '商品代码',
       S_SE_SD_ItemID            AS '商品条码',
       S_SE_SD_StockId           AS '仓储ID',
       B_WH_warehouseName        AS '仓位名称',
       S_SE_SD_SalesItemName     AS '商品名称',
       S_SE_SD_Sprice            AS '商品单价',
       S_SE_SD_Number            AS '数量',
B_UT_unitName AS '单位',
       S_SE_SD_UnitPrice         AS '单位成本(不含税价格)',
       S_SE_SD_CostsPrive        AS '成本价格',
       S_SE_SD_PriceSum          AS '原价合计',
       S_SE_SD_SalesValue        AS '应收金额',
B_GI_Spec AS '规格',
B_GI_Color AS '色号',
F_TT_Name AS '加工工艺',
       S_SE_SD_DiscountRate      AS '折率',
       S_SE_SD_DiscountNum       AS '折扣金额',
       S_SE_SD_GoodDescribe      AS '商品描述',
       S_SE_SD_GlassFlag         AS '右左眼标识',
       S_SE_SD_CommoditiesFlag   AS '商品类别',
(CASE S_SE_SD_CommoditiesFlag 
	WHEN '1' THEN 1
	WHEN '2' THEN 999
	WHEN '3' THEN 2
	WHEN '4' THEN 3
	WHEN '5' THEN 4
	WHEN '6' THEN 5
	WHEN '7' THEN 99
	WHEN '8' THEN 6
	WHEN '9' THEN 7
ELSE '101' END) AS '排序列',
       S_SE_SD_Updatetime        AS '更新时间',
       S_SE_SD_LargessFlag       AS '赠品标识',
       S_SE_SD_Renums            AS '抹零金额',
       S_SE_SD_IsCollect         AS '汇总销售出库单的标志',
       S_SE_SD_DiscountType      AS '折扣类型',
       S_SE_SD_DiscountSource    AS '关联打折工号、打折卡号、打折券',
       S_SE_SD_InStockId         AS '退款仓位',
       S_SE_SD_Favorable         AS '优惠金额',
       S_SE_SD_Integral          AS '积分',
       S_SE_SD_OutStorageFlag    AS '结款是否出库',
       S_SE_SD_InStorageFlag     AS '退款是否入库',
       S_SE_SD_Guaranteeperiod   AS '失效日期',
       S_SE_SD_Batch             AS '批号',
       S_SE_SD_WithdrawFlag,
       S_SE_SD_WithdrawDate,
       S_SE_SD_WithdrawPersonID,
       S_SE_SD_ExchageFlag,S_OP_OY_CustomerID
FROM   S_SE_SalesBasic
       LEFT JOIN S_SE_SalesDetail
         ON S_SE_SD_SalesID = S_SE_SB_SalesID
       LEFT JOIN B_Departments xsdd
         ON xsdd.B_DP_DepartmentID = S_SE_SB_ShopCode
       LEFT JOIN B_Departments qjdd
         ON qjdd.B_DP_DepartmentID = S_SE_SB_Location
       LEFT JOIN B_Warehouse
         ON B_WH_ID = S_SE_SD_StockId
       LEFT JOIN S_ME_CustomerInfo
         ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
       LEFT JOIN S_SM_SetMeal
         ON S_SM_SM_ID = S_SE_SB_SetMealID
       LEFT JOIN SYS_PersonInfo xs
         ON xs.ID = S_SE_SB_SalerID
       LEFT JOIN SYS_PersonInfo lr
         ON lr.ID = S_SE_SB_Lryid
       LEFT JOIN SYS_PersonInfo sy
         ON sy.ID = S_SE_SB_PosID
       LEFT JOIN SYS_PersonInfo tf
         ON tf.ID = S_SE_SB_WithdrawPersonID
       LEFT JOIN SYS_PersonInfo dz
         ON dz.ID = S_SE_SB_DiscountPerson
	INNER JOIN B_GoodsInfo ON B_GI_GoodsID = S_SE_SD_SalesItemID
	LEFT JOIN F_TechnologyType ON F_TT_ID = B_GI_FinishedGlassesType
	LEFT JOIN B_Unit ON B_UT_id = B_GI_UnitId
	LEFT JOIN S_OP_Optometry ON S_OP_OY_OptometryID = S_SE_SB_OptometryID
	LEFT JOIN SYS_PersonInfo yg ON yg.ID = S_OP_Optometry.S_OP_OY_PersonID
WHERE  S_SE_SB_SalesID = '${salesid}' 
ORDER BY [排序列]A

]]></Query>
</TableData>
<TableData name="镜架" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT S_SE_SB_SalesID           AS '销售单号',
       S_SE_SB_ShopCode          AS '店号',
       xsdd.B_DP_DepartmentName  AS '销售店名',
       S_ME_CI_MemberId          AS '顾客号',
       S_ME_CI_Name              AS '顾客姓名',
       ( CASE S_ME_CI_Sex
           WHEN '0' THEN '男'
           WHEN '1' THEN '女'
           ELSE ''
         END )                   AS '顾客性别',
       S_ME_CI_Phone             AS '顾客电话',
       S_ME_CI_CardType          AS '顾客卡类型',
       S_SE_SB_OptID             AS '验光号-验光基表',
       S_SE_SB_OptometryID       AS '验光病历号',
       S_SE_SB_InspectionID      AS '检查结论ID',
       S_SE_SB_TakeGlassData     AS '取镜日期',
       S_SE_SB_SalesDatetime     AS '销售日期',
       S_SE_SB_OrdersType        AS '订单类型',
       ( CASE S_SE_SB_OrdersType
           WHEN '1' THEN '镜架成品片'
           WHEN '2' THEN '镜架订做片'
           WHEN '3' THEN '隐形成品片'
           WHEN '4' THEN '隐形订做片'
           WHEN '5' THEN '辅料'
           ELSE ''
         END )                   AS '订单类型名称',
       S_SE_SB_BallGlassOD       AS '右眼球镜',
       S_SE_SB_BallGlassOS       AS '左眼球镜',
       S_SE_SB_PostGlassOD       AS '右眼柱镜',
       S_SE_SB_PostGlassOS       AS '左眼柱镜',
       S_SE_SB_AxesOD            AS '右眼轴向',
       S_SE_SB_AxesOS            AS '左眼轴向',
       S_SE_SB_ADDOD             AS '右眼add',
       S_SE_SB_ADDOS             AS '左眼add',
       S_SE_SB_ArriseGlassOD1    AS '右眼三棱镜',
       S_SE_SB_ArriseGlassOS1    AS '左眼三棱镜',
       S_SE_SB_BasisOD1          AS '右眼基底1',
       S_SE_SB_BasisOS1          AS '左眼基底1',
       S_SE_SB_PrismOD           AS '右眼棱镜',
       S_SE_SB_PrismOS           AS '左眼棱镜',
       ISNULL(S_SE_SB_InterHighOD, S_SE_SB_InterDistanceOD)       AS '右眼瞳距',
       ISNULL(S_SE_SB_InterHighOS, S_SE_SB_InterDistanceOS)       AS '左眼瞳距',
       ISNULL(S_SE_SB_FarVAOD, S_SE_SB_CloseVAOD)           AS '右眼VA',
       ISNULL(S_SE_SB_FarVAOS, S_SE_SB_CloseVAOS)           AS '左眼VA',
       S_SE_SB_RecipeType        AS '处方形式',
       ( CASE S_SE_SB_RecipeType
           WHEN '1' THEN '远用'
           WHEN '2' THEN '近用'
           WHEN '3' THEN '渐进/双光'
           WHEN '4' THEN '隐形'
           ELSE ''
         END )                   AS '处方形式名称',
       S_SE_SB_DignosisRe        AS '备注',
       S_SE_SB_DiameterOD        AS '隐形右眼直径',
       S_SE_SB_DiameterOS        AS '隐形左眼直径',
       S_SE_SB_ConRecipeType     AS '隐形处理方式',
       S_SE_SB_SecCheckDate      AS '复诊时间',
       S_SE_SB_SubVisitUnit      AS '复诊时间单位',
       S_SE_SB_SalesType         AS '销售类型',
       ( CASE S_SE_SB_SalesType
           WHEN '1' THEN '内方'
           WHEN '2' THEN '外方'
           WHEN '3' THEN '辅料'
           ELSE ''
         END )                   AS '销售类型',
       S_SE_SB_SalerID           AS '销售人员ID',
       xs.personName             AS '销售员姓名',
       S_SE_SB_Lryid             AS '录入员ID',
       lr.personName             AS '录入员姓名',
       S_SE_SB_FactPosDatetime       AS '收银日期',
       S_SE_SB_PosID             AS '收银员ID',
       sy.personName             AS '收银员姓名',
       S_SE_SB_PriceSum          AS '原价合计',
       S_SE_SB_SalesValue        AS '应收金额',
       S_SE_SB_EyeCurvatureOD1   AS '隐形右眼曲率1',
       S_SE_SB_EyeCurvatureOD2   AS '隐形右眼曲率2',
       S_SE_SB_EyeCurvatureOS1   AS '隐形左眼曲率1',
       S_SE_SB_EyeCurvatureOS2   AS '隐形左眼曲率2',
       S_SE_SB_DiscountRate      AS '折扣率',
       S_SE_SB_DiscountNum       AS '折扣金额',
       S_SE_SB_Psalsvalue        AS '实缴金额',
       S_SE_SB_ArrearsValue      AS '欠款金额',
       S_SE_SB_Location          AS '取镜地点',
       qjdd.B_DP_DepartmentName  AS '销售店名',
       S_SE_SB_ArrivedDate       AS '到镜日期',
       S_SE_SB_ValueFlag         AS '收费标志',
       ( CASE S_SE_SB_ValueFlag
           WHEN '0' THEN '未收费'
           WHEN '1' THEN '已收费'
           ELSE ''
         END )                   AS '收费状态',
       S_SE_SB_CheckoutFlag      AS '欠费标志',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '0' THEN '未欠费'
           WHEN '1' THEN '欠费'
           ELSE ''
         END )                   AS '欠费状态',
       S_SE_SB_InTransit         AS '配镜单当前在途状态',
       S_SE_SB_FactWithdrawDate      AS '退费日期',
       S_SE_SB_WithdrawFlag      AS '退费标示位',
       S_SE_SB_WithdrawPersonID  AS '退费人员',
       sy.personName             AS '退费人员姓名',
       S_SE_SB_MovementType      AS '活动类型ID',
       S_SE_SB_FactArrearsAppendDate AS '补齐欠款日期',
       S_SE_SB_ArrearsDate       AS '欠款日期',
       S_SE_SB_PayCash           AS '缴费现金金额',
       S_SE_SB_BankCard          AS '缴费银行卡金额',
       S_SE_SB_StoredCard        AS '缴费储值卡金额',
       S_SE_SB_Renums            AS '抹零金额',
       S_SE_SB_DiscountType      AS '折扣类型',
       S_SE_SB_DiscountPerson    AS '打折人',
       dz.personName             AS '打折人员姓名',
       S_SE_SB_DragsType         AS '委外类型',
       S_SE_SB_PupilHeightOD     AS '右眼瞳高',
       S_SE_SB_PupilHeightOS     AS '左眼瞳高',
       S_SE_SB_FavorableAmount,
       S_SE_SB_WorryType         AS '加急状态',
       S_SE_SB_Integral,
       S_SE_SB_SetMealID         AS '套餐ID',
       S_SM_SM_Title             AS '套餐名称',
       S_SE_SB_ExecStandard,
       S_SE_SB_SalesRemark       AS '销售备注',
       S_SE_SB_SourceSalesID,
       S_SE_SB_SwapGoodsFlag     AS '配镜单退款类型',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '1' THEN '整单退款'
           WHEN '2' THEN '部分退款'
           WHEN '3' THEN '部分换货'
           WHEN '4' THEN '直接退款'
           ELSE ''
         END )                   AS '配镜单退款类型名称',
       S_SE_SD_SalesItemID       AS '商品代码',
       S_SE_SD_ItemID            AS '商品条码',
       S_SE_SD_StockId           AS '仓储ID',
       B_WH_warehouseName        AS '仓位名称',
       S_SE_SD_SalesItemName     AS '商品名称',
       S_SE_SD_Sprice            AS '商品单价',
       S_SE_SD_Number            AS '数量',
B_UT_unitName AS '单位',
       S_SE_SD_UnitPrice         AS '单位成本(不含税价格)',
       S_SE_SD_CostsPrive        AS '成本价格',
       S_SE_SD_PriceSum          AS '原价合计',
       S_SE_SD_SalesValue        AS '应收金额',
B_GI_Spec AS '规格',
B_GI_Color AS '色号',
F_TT_Name AS '加工工艺',
       S_SE_SD_DiscountRate      AS '折率',
       S_SE_SD_DiscountNum       AS '折扣金额',
       S_SE_SD_GoodDescribe      AS '商品描述',
       S_SE_SD_GlassFlag         AS '右左眼标识',
       S_SE_SD_CommoditiesFlag   AS '商品类别',
(CASE S_SE_SD_CommoditiesFlag 
	WHEN '1' THEN 1
	WHEN '2' THEN 999
	WHEN '3' THEN 2
	WHEN '4' THEN 3
	WHEN '5' THEN 4
	WHEN '6' THEN 5
	WHEN '7' THEN 99
	WHEN '8' THEN 6
	WHEN '9' THEN 7
ELSE '101' END) AS '排序列',
       S_SE_SD_Updatetime        AS '更新时间',
       S_SE_SD_LargessFlag       AS '赠品标识',
       S_SE_SD_Renums            AS '抹零金额',
       S_SE_SD_IsCollect         AS '汇总销售出库单的标志',
       S_SE_SD_DiscountType      AS '折扣类型',
       S_SE_SD_DiscountSource    AS '关联打折工号、打折卡号、打折券',
       S_SE_SD_InStockId         AS '退款仓位',
       S_SE_SD_Favorable         AS '优惠金额',
       S_SE_SD_Integral          AS '积分',
       S_SE_SD_OutStorageFlag    AS '结款是否出库',
       S_SE_SD_InStorageFlag     AS '退款是否入库',
       S_SE_SD_Guaranteeperiod   AS '失效日期',
       S_SE_SD_Batch             AS '批号',
       S_SE_SD_WithdrawFlag,
       S_SE_SD_WithdrawDate,
       S_SE_SD_WithdrawPersonID,
       S_SE_SD_ExchageFlag
FROM   S_SE_SalesBasic
       LEFT JOIN S_SE_SalesDetail
         ON S_SE_SD_SalesID = S_SE_SB_SalesID
       LEFT JOIN B_Departments xsdd
         ON xsdd.B_DP_DepartmentID = S_SE_SB_ShopCode
       LEFT JOIN B_Departments qjdd
         ON qjdd.B_DP_DepartmentID = S_SE_SB_Location
       LEFT JOIN B_Warehouse
         ON B_WH_ID = S_SE_SD_StockId
       LEFT JOIN S_ME_CustomerInfo
         ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
       LEFT JOIN S_SM_SetMeal
         ON S_SM_SM_ID = S_SE_SB_SetMealID
       LEFT JOIN SYS_PersonInfo xs
         ON xs.ID = S_SE_SB_SalerID
       LEFT JOIN SYS_PersonInfo lr
         ON lr.ID = S_SE_SB_Lryid
       LEFT JOIN SYS_PersonInfo sy
         ON sy.ID = S_SE_SB_PosID
       LEFT JOIN SYS_PersonInfo tf
         ON tf.ID = S_SE_SB_WithdrawPersonID
       LEFT JOIN SYS_PersonInfo dz
         ON dz.ID = S_SE_SB_DiscountPerson
	INNER JOIN B_GoodsInfo ON B_GI_GoodsID = S_SE_SD_SalesItemID
	LEFT JOIN F_TechnologyType ON F_TT_ID = B_GI_FinishedGlassesType
	LEFT JOIN B_Unit ON B_UT_id = B_GI_UnitId
WHERE  S_SE_SB_SalesID = '${salesid}' AND S_SE_SD_CommoditiesFlag IN ('1','7','8') AND S_SE_SD_LargessFlag <> '1'
ORDER BY [排序列]A]]></Query>
</TableData>
<TableData name="镜片" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT S_SE_SB_SalesID           AS '销售单号',
       S_SE_SB_ShopCode          AS '店号',
       xsdd.B_DP_DepartmentName  AS '销售店名',
       S_ME_CI_MemberId          AS '顾客号',
       S_ME_CI_Name              AS '顾客姓名',
       ( CASE S_ME_CI_Sex
           WHEN '0' THEN '男'
           WHEN '1' THEN '女'
           ELSE ''
         END )                   AS '顾客性别',
       S_ME_CI_Phone             AS '顾客电话',
       S_ME_CI_CardType          AS '顾客卡类型',
       S_SE_SB_OptID             AS '验光号-验光基表',
       S_SE_SB_OptometryID       AS '验光病历号',
       S_SE_SB_InspectionID      AS '检查结论ID',
       S_SE_SB_TakeGlassData     AS '取镜日期',
       S_SE_SB_SalesDatetime     AS '销售日期',
       S_SE_SB_OrdersType        AS '订单类型',
       ( CASE S_SE_SB_OrdersType
           WHEN '1' THEN '镜架成品片'
           WHEN '2' THEN '镜架订做片'
           WHEN '3' THEN '隐形成品片'
           WHEN '4' THEN '隐形订做片'
           WHEN '5' THEN '辅料'
           ELSE ''
         END )                   AS '订单类型名称',
       S_SE_SB_BallGlassOD       AS '右眼球镜',
       S_SE_SB_BallGlassOS       AS '左眼球镜',
       S_SE_SB_PostGlassOD       AS '右眼柱镜',
       S_SE_SB_PostGlassOS       AS '左眼柱镜',
       S_SE_SB_AxesOD            AS '右眼轴向',
       S_SE_SB_AxesOS            AS '左眼轴向',
       S_SE_SB_ADDOD             AS '右眼add',
       S_SE_SB_ADDOS             AS '左眼add',
       S_SE_SB_ArriseGlassOD1    AS '右眼三棱镜',
       S_SE_SB_ArriseGlassOS1    AS '左眼三棱镜',
       S_SE_SB_BasisOD1          AS '右眼基底1',
       S_SE_SB_BasisOS1          AS '左眼基底1',
       S_SE_SB_PrismOD           AS '右眼棱镜',
       S_SE_SB_PrismOS           AS '左眼棱镜',
       ISNULL(S_SE_SB_InterHighOD, S_SE_SB_InterDistanceOD)       AS '右眼瞳距',
       ISNULL(S_SE_SB_InterHighOS, S_SE_SB_InterDistanceOS)       AS '左眼瞳距',
       ISNULL(S_SE_SB_FarVAOD, S_SE_SB_CloseVAOD)           AS '右眼VA',
       ISNULL(S_SE_SB_FarVAOS, S_SE_SB_CloseVAOS)           AS '左眼VA',
       S_SE_SB_RecipeType        AS '处方形式',
       ( CASE S_SE_SB_RecipeType
           WHEN '1' THEN '远用'
           WHEN '2' THEN '近用'
           WHEN '3' THEN '渐进/双光'
           WHEN '4' THEN '隐形'
           ELSE ''
         END )                   AS '处方形式名称',
       S_SE_SB_DignosisRe        AS '备注',
       S_SE_SB_DiameterOD        AS '隐形右眼直径',
       S_SE_SB_DiameterOS        AS '隐形左眼直径',
       S_SE_SB_ConRecipeType     AS '隐形处理方式',
       S_SE_SB_SecCheckDate      AS '复诊时间',
       S_SE_SB_SubVisitUnit      AS '复诊时间单位',
       S_SE_SB_SalesType         AS '销售类型',
       ( CASE S_SE_SB_SalesType
           WHEN '1' THEN '内方'
           WHEN '2' THEN '外方'
           WHEN '3' THEN '辅料'
           ELSE ''
         END )                   AS '销售类型',
       S_SE_SB_SalerID           AS '销售人员ID',
       xs.personName             AS '销售员姓名',
       S_SE_SB_Lryid             AS '录入员ID',
       lr.personName             AS '录入员姓名',
       S_SE_SB_FactPosDatetime       AS '收银日期',
       S_SE_SB_PosID             AS '收银员ID',
       sy.personName             AS '收银员姓名',
       S_SE_SB_PriceSum          AS '原价合计',
       S_SE_SB_SalesValue        AS '应收金额',
       S_SE_SB_EyeCurvatureOD1   AS '隐形右眼曲率1',
       S_SE_SB_EyeCurvatureOD2   AS '隐形右眼曲率2',
       S_SE_SB_EyeCurvatureOS1   AS '隐形左眼曲率1',
       S_SE_SB_EyeCurvatureOS2   AS '隐形左眼曲率2',
       S_SE_SB_DiscountRate      AS '折扣率',
       S_SE_SB_DiscountNum       AS '折扣金额',
       S_SE_SB_Psalsvalue        AS '实缴金额',
       S_SE_SB_ArrearsValue      AS '欠款金额',
       S_SE_SB_Location          AS '取镜地点',
       qjdd.B_DP_DepartmentName  AS '销售店名',
       S_SE_SB_ArrivedDate       AS '到镜日期',
       S_SE_SB_ValueFlag         AS '收费标志',
       ( CASE S_SE_SB_ValueFlag
           WHEN '0' THEN '未收费'
           WHEN '1' THEN '已收费'
           ELSE ''
         END )                   AS '收费状态',
       S_SE_SB_CheckoutFlag      AS '欠费标志',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '0' THEN '未欠费'
           WHEN '1' THEN '欠费'
           ELSE ''
         END )                   AS '欠费状态',
       S_SE_SB_InTransit         AS '配镜单当前在途状态',
       S_SE_SB_FactWithdrawDate      AS '退费日期',
       S_SE_SB_WithdrawFlag      AS '退费标示位',
       S_SE_SB_WithdrawPersonID  AS '退费人员',
       sy.personName             AS '退费人员姓名',
       S_SE_SB_MovementType      AS '活动类型ID',
       S_SE_SB_FactArrearsAppendDate AS '补齐欠款日期',
       S_SE_SB_ArrearsDate       AS '欠款日期',
       S_SE_SB_PayCash           AS '缴费现金金额',
       S_SE_SB_BankCard          AS '缴费银行卡金额',
       S_SE_SB_StoredCard        AS '缴费储值卡金额',
       S_SE_SB_Renums            AS '抹零金额',
       S_SE_SB_DiscountType      AS '折扣类型',
       S_SE_SB_DiscountPerson    AS '打折人',
       dz.personName             AS '打折人员姓名',
       S_SE_SB_DragsType         AS '委外类型',
       S_SE_SB_PupilHeightOD     AS '右眼瞳高',
       S_SE_SB_PupilHeightOS     AS '左眼瞳高',
       S_SE_SB_FavorableAmount,
       S_SE_SB_WorryType         AS '加急状态',
       S_SE_SB_Integral,
       S_SE_SB_SetMealID         AS '套餐ID',
       S_SM_SM_Title             AS '套餐名称',
       S_SE_SB_ExecStandard,
       S_SE_SB_SalesRemark       AS '销售备注',
       S_SE_SB_SourceSalesID,
       S_SE_SB_SwapGoodsFlag     AS '配镜单退款类型',
       ( CASE S_SE_SB_CheckoutFlag
           WHEN '1' THEN '整单退款'
           WHEN '2' THEN '部分退款'
           WHEN '3' THEN '部分换货'
           WHEN '4' THEN '直接退款'
           ELSE ''
         END )                   AS '配镜单退款类型名称',
       S_SE_SD_SalesItemID       AS '商品代码',
       S_SE_SD_ItemID            AS '商品条码',
       S_SE_SD_StockId           AS '仓储ID',
       B_WH_warehouseName        AS '仓位名称',
       ( CASE 
           WHEN (S_SE_SD_CommoditiesFlag='4' OR S_SE_SD_CommoditiesFlag='5') AND F_SP_PrintStealthCheck='1' THEN (S_SE_SD_SalesItemName+'：'+ISNULL(S_SE_SD_Guaranteeperiod,'') )
           ELSE S_SE_SD_SalesItemName
         END )                   AS '商品名称',
       S_SE_SD_Sprice            AS '商品单价',
       S_SE_SD_Number            AS '数量',
B_UT_unitName AS '单位',
       S_SE_SD_UnitPrice         AS '单位成本(不含税价格)',
       S_SE_SD_CostsPrive        AS '成本价格',
       S_SE_SD_PriceSum          AS '原价合计',
       S_SE_SD_SalesValue        AS '应收金额',
B_GI_Spec AS '规格',
B_GI_Color AS '色号',
F_TT_Name AS '加工工艺',
       S_SE_SD_DiscountRate      AS '折率',
       S_SE_SD_DiscountNum       AS '折扣金额',
       S_SE_SD_GoodDescribe      AS '商品描述',
       S_SE_SD_GlassFlag         AS '右左眼标识',
       S_SE_SD_CommoditiesFlag   AS '商品类别',
(CASE S_SE_SD_CommoditiesFlag 
	WHEN '1' THEN 1
	WHEN '2' THEN 999
	WHEN '3' THEN 2
	WHEN '4' THEN 3
	WHEN '5' THEN 4
	WHEN '6' THEN 5
	WHEN '7' THEN 99
	WHEN '8' THEN 6
	WHEN '9' THEN 7
ELSE '101' END) AS '排序列',
       S_SE_SD_Updatetime        AS '更新时间',
       S_SE_SD_LargessFlag       AS '赠品标识',
       S_SE_SD_Renums            AS '抹零金额',
       S_SE_SD_IsCollect         AS '汇总销售出库单的标志',
       S_SE_SD_DiscountType      AS '折扣类型',
       S_SE_SD_DiscountSource    AS '关联打折工号、打折卡号、打折券',
       S_SE_SD_InStockId         AS '退款仓位',
       S_SE_SD_Favorable         AS '优惠金额',
       S_SE_SD_Integral          AS '积分',
       S_SE_SD_OutStorageFlag    AS '结款是否出库',
       S_SE_SD_InStorageFlag     AS '退款是否入库',
       S_SE_SD_Guaranteeperiod   AS '失效日期',
       S_SE_SD_Batch             AS '批号',
       S_SE_SD_WithdrawFlag,
       S_SE_SD_WithdrawDate,
       S_SE_SD_WithdrawPersonID,
       S_SE_SD_ExchageFlag
FROM   F_SystemParameter,S_SE_SalesBasic
       LEFT JOIN S_SE_SalesDetail
         ON S_SE_SD_SalesID = S_SE_SB_SalesID
       LEFT JOIN B_Departments xsdd
         ON xsdd.B_DP_DepartmentID = S_SE_SB_ShopCode
       LEFT JOIN B_Departments qjdd
         ON qjdd.B_DP_DepartmentID = S_SE_SB_Location
       LEFT JOIN B_Warehouse
         ON B_WH_ID = S_SE_SD_StockId
       LEFT JOIN S_ME_CustomerInfo
         ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
       LEFT JOIN S_SM_SetMeal
         ON S_SM_SM_ID = S_SE_SB_SetMealID
       LEFT JOIN SYS_PersonInfo xs
         ON xs.ID = S_SE_SB_SalerID
       LEFT JOIN SYS_PersonInfo lr
         ON lr.ID = S_SE_SB_Lryid
       LEFT JOIN SYS_PersonInfo sy
         ON sy.ID = S_SE_SB_PosID
       LEFT JOIN SYS_PersonInfo tf
         ON tf.ID = S_SE_SB_WithdrawPersonID
       LEFT JOIN SYS_PersonInfo dz
         ON dz.ID = S_SE_SB_DiscountPerson
	INNER JOIN B_GoodsInfo ON B_GI_GoodsID = S_SE_SD_SalesItemID
	LEFT JOIN F_TechnologyType ON F_TT_ID = B_GI_FinishedGlassesType
	LEFT JOIN B_Unit ON B_UT_id = B_GI_UnitId
WHERE  S_SE_SB_SalesID = '${salesid}' 
	AND S_SE_SD_CommoditiesFlag IN ('3','4','5', '6')
ORDER BY [排序列]A]]></Query>
</TableData>
<TableData name="特殊加工要求" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT S_SE_SD_ID          AS 'ID',
       S_SE_SD_SalesID     AS '销售单号',
       S_SE_SD_Requirement AS '特殊加工要求'
FROM   S_SE_SpecialPDetail
WHERE  S_SE_SD_SalesID = '${salesid}' ]]></Query>
</TableData>
<TableData name="赠品" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[SELECT TOP 4 S_SE_SB_SalesID AS '销售单号', 
S_SE_SB_ShopCode AS '店号', 
xsdd.B_DP_DepartmentName AS '销售店名', 
S_ME_CI_MemberId AS '顾客号', 
S_ME_CI_Name AS '顾客姓名', 
( CASE S_ME_CI_Sex 
WHEN '0' THEN '男' 
WHEN '1' THEN '女' 
ELSE '' 
END ) AS '顾客性别', 
S_ME_CI_Phone AS '顾客电话', 
S_ME_CI_CardType AS '顾客卡类型', 
S_SE_SB_OptID AS '验光号-验光基表', 
S_SE_SB_OptometryID AS '验光病历号', 
S_SE_SB_InspectionID AS '检查结论ID', 
S_SE_SB_TakeGlassData AS '取镜日期', 
S_SE_SB_SalesDatetime AS '销售日期', 
S_SE_SB_OrdersType AS '订单类型', 
( CASE S_SE_SB_OrdersType 
WHEN '1' THEN '镜架成品片' 
WHEN '2' THEN '镜架订做片' 
WHEN '3' THEN '隐形成品片' 
WHEN '4' THEN '隐形订做片' 
WHEN '5' THEN '辅料' 
ELSE '' 
END ) AS '订单类型名称', 
S_SE_SB_BallGlassOD AS '右眼球镜', 
S_SE_SB_BallGlassOS AS '左眼球镜', 
S_SE_SB_PostGlassOD AS '右眼柱镜', 
S_SE_SB_PostGlassOS AS '左眼柱镜', 
S_SE_SB_AxesOD AS '右眼轴向', 
S_SE_SB_AxesOS AS '左眼轴向', 
S_SE_SB_ADDOD AS '右眼add', 
S_SE_SB_ADDOS AS '左眼add', 
S_SE_SB_ArriseGlassOD1 AS '右眼三棱镜', 
S_SE_SB_ArriseGlassOS1 AS '左眼三棱镜', 
S_SE_SB_BasisOD1 AS '右眼基底1', 
S_SE_SB_BasisOS1 AS '左眼基底1', 
S_SE_SB_PrismOD AS '右眼棱镜', 
S_SE_SB_PrismOS AS '左眼棱镜', 
ISNULL(S_SE_SB_InterHighOD, S_SE_SB_InterDistanceOD) AS '右眼瞳距', 
ISNULL(S_SE_SB_InterHighOS, S_SE_SB_InterDistanceOS) AS '左眼瞳距', 
ISNULL(S_SE_SB_FarVAOD, S_SE_SB_CloseVAOD) AS '右眼VA', 
ISNULL(S_SE_SB_FarVAOS, S_SE_SB_CloseVAOS) AS '左眼VA', 
S_SE_SB_RecipeType AS '处方形式', 
( CASE S_SE_SB_RecipeType 
WHEN '1' THEN '远用' 
WHEN '2' THEN '近用' 
WHEN '3' THEN '渐进/双光' 
WHEN '4' THEN '隐形' 
ELSE '' 
END ) AS '处方形式名称', 
S_SE_SB_DignosisRe AS '备注', 
S_SE_SB_DiameterOD AS '隐形右眼直径', 
S_SE_SB_DiameterOS AS '隐形左眼直径', 
S_SE_SB_ConRecipeType AS '隐形处理方式', 
S_SE_SB_SecCheckDate AS '复诊时间', 
S_SE_SB_SubVisitUnit AS '复诊时间单位', 
S_SE_SB_SalesType AS '销售类型', 
( CASE S_SE_SB_SalesType 
WHEN '1' THEN '内方' 
WHEN '2' THEN '外方' 
WHEN '3' THEN '辅料' 
ELSE '' 
END ) AS '销售类型', 
S_SE_SB_SalerID AS '销售人员ID', 
xs.personName AS '销售员姓名', 
S_SE_SB_Lryid AS '录入员ID', 
lr.personName AS '录入员姓名', 
S_SE_SB_FactPosDatetime AS '收银日期', 
S_SE_SB_PosID AS '收银员ID', 
sy.personName AS '收银员姓名', 
S_SE_SB_PriceSum AS '原价合计', 
S_SE_SB_SalesValue AS '应收金额', 
S_SE_SB_EyeCurvatureOD1 AS '隐形右眼曲率1', 
S_SE_SB_EyeCurvatureOD2 AS '隐形右眼曲率2', 
S_SE_SB_EyeCurvatureOS1 AS '隐形左眼曲率1', 
S_SE_SB_EyeCurvatureOS2 AS '隐形左眼曲率2', 
S_SE_SB_DiscountRate AS '折扣率', 
S_SE_SB_DiscountNum AS '折扣金额', 
S_SE_SB_Psalsvalue AS '实缴金额', 
S_SE_SB_ArrearsValue AS '欠款金额', 
S_SE_SB_Location AS '取镜地点', 
qjdd.B_DP_DepartmentName AS '销售店名', 
S_SE_SB_ArrivedDate AS '到镜日期', 
S_SE_SB_ValueFlag AS '收费标志', 
( CASE S_SE_SB_ValueFlag 
WHEN '0' THEN '未收费' 
WHEN '1' THEN '已收费' 
ELSE '' 
END ) AS '收费状态', 
S_SE_SB_CheckoutFlag AS '欠费标志', 
( CASE S_SE_SB_CheckoutFlag 
WHEN '0' THEN '未欠费' 
WHEN '1' THEN '欠费' 
ELSE '' 
END ) AS '欠费状态', 
S_SE_SB_InTransit AS '配镜单当前在途状态', 
S_SE_SB_FactWithdrawDate AS '退费日期', 
S_SE_SB_WithdrawFlag AS '退费标示位', 
S_SE_SB_WithdrawPersonID AS '退费人员', 
sy.personName AS '退费人员姓名', 
S_SE_SB_MovementType AS '活动类型ID', 
S_SE_SB_FactArrearsAppendDate AS '补齐欠款日期', 
S_SE_SB_ArrearsDate AS '欠款日期', 
S_SE_SB_PayCash AS '缴费现金金额', 
S_SE_SB_BankCard AS '缴费银行卡金额', 
S_SE_SB_StoredCard AS '缴费储值卡金额', 
S_SE_SB_Renums AS '抹零金额', 
S_SE_SB_DiscountType AS '折扣类型', 
S_SE_SB_DiscountPerson AS '打折人', 
dz.personName AS '打折人员姓名', 
S_SE_SB_DragsType AS '委外类型', 
S_SE_SB_PupilHeightOD AS '右眼瞳高', 
S_SE_SB_PupilHeightOS AS '左眼瞳高', 
S_SE_SB_FavorableAmount, 
S_SE_SB_WorryType AS '加急状态', 
S_SE_SB_Integral, 
S_SE_SB_SetMealID AS '套餐ID', 
S_SM_SM_Title AS '套餐名称', 
S_SE_SB_ExecStandard, 
S_SE_SB_SalesRemark AS '销售备注', 
S_SE_SB_SourceSalesID, 
S_SE_SB_SwapGoodsFlag AS '配镜单退款类型', 
( CASE S_SE_SB_CheckoutFlag 
WHEN '1' THEN '整单退款' 
WHEN '2' THEN '部分退款' 
WHEN '3' THEN '部分换货' 
WHEN '4' THEN '直接退款' 
ELSE '' 
END ) AS '配镜单退款类型名称', 
S_SE_SD_SalesItemID AS '商品代码', 
S_SE_SD_ItemID AS '商品条码', 
S_SE_SD_StockId AS '仓储ID', 
B_WH_warehouseName AS '仓位名称', 
S_SE_SD_SalesItemName AS '商品名称', 
S_SE_SD_Sprice AS '商品单价', 
S_SE_SD_Number AS '数量', 
B_UT_unitName AS '单位', 
S_SE_SD_UnitPrice AS '单位成本(不含税价格)', 
S_SE_SD_CostsPrive AS '成本价格', 
S_SE_SD_PriceSum AS '原价合计', 
S_SE_SD_SalesValue AS '应收金额', 
B_GI_Spec AS '规格', 
B_GI_Color AS '色号', 
F_TT_Name AS '加工工艺', 
S_SE_SD_DiscountRate AS '折率', 
S_SE_SD_DiscountNum AS '折扣金额', 
S_SE_SD_GoodDescribe AS '商品描述', 
S_SE_SD_GlassFlag AS '右左眼标识', 
S_SE_SD_CommoditiesFlag AS '商品类别', 
(CASE S_SE_SD_CommoditiesFlag 
WHEN '1' THEN 1 
WHEN '2' THEN 999 
WHEN '3' THEN 2 
WHEN '4' THEN 3 
WHEN '5' THEN 4 
WHEN '6' THEN 5 
WHEN '7' THEN 99 
WHEN '8' THEN 6 
WHEN '9' THEN 7 
ELSE '101' END) AS '排序列', 
S_SE_SD_Updatetime AS '更新时间', 
S_SE_SD_LargessFlag AS '赠品标识', 
S_SE_SD_Renums AS '抹零金额', 
S_SE_SD_IsCollect AS '汇总销售出库单的标志', 
S_SE_SD_DiscountType AS '折扣类型', 
S_SE_SD_DiscountSource AS '关联打折工号、打折卡号、打折券', 
S_SE_SD_InStockId AS '退款仓位', 
S_SE_SD_Favorable AS '优惠金额', 
S_SE_SD_Integral AS '积分', 
S_SE_SD_OutStorageFlag AS '结款是否出库', 
S_SE_SD_InStorageFlag AS '退款是否入库', 
S_SE_SD_Guaranteeperiod AS '失效日期', 
S_SE_SD_Batch AS '批号', 
S_SE_SD_WithdrawFlag, 
S_SE_SD_WithdrawDate, 
S_SE_SD_WithdrawPersonID, 
S_SE_SD_ExchageFlag 
FROM S_SE_SalesBasic 
LEFT JOIN S_SE_SalesDetail 
ON S_SE_SD_SalesID = S_SE_SB_SalesID 
LEFT JOIN B_Departments xsdd 
ON xsdd.B_DP_DepartmentID = S_SE_SB_ShopCode 
LEFT JOIN B_Departments qjdd 
ON qjdd.B_DP_DepartmentID = S_SE_SB_Location 
LEFT JOIN B_Warehouse 
ON B_WH_ID = S_SE_SD_StockId 
LEFT JOIN S_ME_CustomerInfo 
ON S_ME_CI_CustomerID = S_SE_SB_CustomerID 
LEFT JOIN S_SM_SetMeal 
ON S_SM_SM_ID = S_SE_SB_SetMealID 
LEFT JOIN SYS_PersonInfo xs 
ON xs.ID = S_SE_SB_SalerID 
LEFT JOIN SYS_PersonInfo lr 
ON lr.ID = S_SE_SB_Lryid 
LEFT JOIN SYS_PersonInfo sy 
ON sy.ID = S_SE_SB_PosID 
LEFT JOIN SYS_PersonInfo tf 
ON tf.ID = S_SE_SB_WithdrawPersonID 
LEFT JOIN SYS_PersonInfo dz 
ON dz.ID = S_SE_SB_DiscountPerson 
INNER JOIN B_GoodsInfo ON B_GI_GoodsID = S_SE_SD_SalesItemID 
LEFT JOIN F_TechnologyType ON F_TT_ID = B_GI_FinishedGlassesType 
LEFT JOIN B_Unit ON B_UT_id = B_GI_UnitId 
WHERE S_SE_SB_SalesID = '${salesid}' AND S_SE_SD_LargessFlag = '1' OR S_SE_SD_CommoditiesFlag='5'
ORDER BY [排序列]A]]></Query>
</TableData>
<TableData name="旧镜检查" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[pjd]]></DatabaseName>
</Connection>
<Query>
<![CDATA[
SELECT 
S_SE_SB_CustomerID,
S_ME_CI_Name,
ISNULL(S_OP_HI_BallOD,'') AS 右眼球径,

ISNULL(S_OP_HI_BallOS,'') AS 左眼球径
,
ISNULL(S_OP_HI_PostOD,'') AS 右眼柱径
,
ISNULL(S_OP_HI_PostOS,'') AS 左眼柱径
,
ISNULL(S_OP_HI_AxesOD,'') AS 右眼轴向
,
ISNULL(S_OP_HI_AxesOS,'') AS 左眼轴向
,
ISNULL(S_OP_HI_AddOD,'') AS 右眼ADD
,
ISNULL(S_OP_HI_AddOS,'') AS 左眼ADD
,
ISNULL(S_OP_HI_ArriseOD,'') AS 右眼棱镜
,
ISNULL(S_OP_HI_ArriseOS,'') AS 左眼棱镜
,
ISNULL(S_OP_HI_BasisOD,'') AS 右眼基底
,
ISNULL(S_OP_HI_BasisOS,'') AS 左眼基底
,
ISNULL(S_OP_HI_InterHighOD,'') AS 右眼瞳距
,
ISNULL(S_OP_HI_InterHighOS,'') AS 左眼瞳距


 FROM S_SE_SalesBasic
	LEFT JOIN S_OP_HisInfo ON S_OP_HI_FCustomerID=S_SE_SB_CustomerID
	LEFT JOIN S_ME_CustomerInfo ON S_ME_CI_CustomerID = S_SE_SB_CustomerID
WHERE S_SE_SB_SalesID='${salesid}']]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR/>
<FR/>
<HC/>
<FC/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[734400,734400,734400,734400,734400,734400,734400,734400,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[1524000,2438400,2057400,2171700,3086100,2476500,2743200,2743200,2743200,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" s="0">
<O>
<![CDATA[姓名]]></O>
<Expand/>
</C>
<C c="1" r="0" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="顾客姓名"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="0" s="0">
<O>
<![CDATA[配镜单号]]></O>
<Expand/>
</C>
<C c="3" r="0" cs="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售单号"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" rs="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="处方形式名称"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="1" s="0">
<O>
<![CDATA[球镜\\nSph(D)]]></O>
<Expand/>
</C>
<C c="2" r="1" s="0">
<O>
<![CDATA[柱镜\\nCyl(D)]]></O>
<Expand/>
</C>
<C c="3" r="1" s="0">
<O>
<![CDATA[轴位\\nAxis(°)]]></O>
<Expand/>
</C>
<C c="4" r="1" s="0">
<O>
<![CDATA[下加/棱镜\\nAdd(D)/P(△)]]></O>
<Expand/>
</C>
<C c="5" r="1" s="0">
<O>
<![CDATA[瞳距(mm)]]></O>
<Expand/>
</C>
<C c="1" r="2" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼球镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="2" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼柱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="2" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="2" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼add右眼三棱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="2" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="右眼瞳距"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼球镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼柱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="3" r="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼轴向"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼add左眼三棱镜"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="3" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="左眼瞳距"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="4" rs="2" s="0">
<O>
<![CDATA[镜片]]></O>
<Expand/>
</C>
<C c="1" r="4" s="0">
<O>
<![CDATA[右]]></O>
<Expand/>
</C>
<C c="2" r="4" cs="4" s="0">
<O t="DSColumn">
<Attributes dsName="镜片" columnName="商品名称"/>
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[0]]></CNUMBER>
<CNAME>
<![CDATA[右左眼标识]]></CNAME>
<Compare op="0">
<O>
<![CDATA[R]]></O>
</Compare>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="5" s="0">
<O>
<![CDATA[左]]></O>
<Expand/>
</C>
<C c="2" r="5" cs="4" s="0">
<O t="DSColumn">
<Attributes dsName="镜片" columnName="商品名称"/>
<Condition class="com.fr.data.condition.CommonCondition">
<CNUMBER>
<![CDATA[0]]></CNUMBER>
<CNAME>
<![CDATA[右左眼标识]]></CNAME>
<Compare op="0">
<O>
<![CDATA[L]]></O>
</Compare>
</Condition>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="6" cs="2" s="0">
<O>
<![CDATA[镜架]]></O>
<Expand/>
</C>
<C c="2" r="6" cs="4" s="0">
<O t="DSColumn">
<Attributes dsName="镜架" columnName="商品名称"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="7" s="0">
<O>
<![CDATA[验光师]]></O>
<Expand/>
</C>
<C c="1" r="7" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="验光师姓名"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="7" s="0">
<O>
<![CDATA[营业员]]></O>
<Expand/>
</C>
<C c="3" r="7" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售员姓名"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="7" s="0">
<O>
<![CDATA[配镜日期]]></O>
<Expand/>
</C>
<C c="5" r="7" s="0">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="销售日期"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0" printBackground="false">
<PaperSetting>
<PaperSize width="15840000" height="8640000"/>
<Margin top="0" left="0" bottom="0" right="0"/>
</PaperSetting>
<Background name="NullBackground"/>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="true" delayPlaying="true" windowPosition="1" align="0"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="0" size="64"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
</StyleList>
</WorkBook>
