<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 ('查询日期:' + '${bgnDate}' + ' ～ '+'${endDate}') as queryDate]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="salesCost"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxCyljp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endretailamount"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgistealthclassyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodsbigclass"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minCylyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodssmallclass"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgispecjj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnretailamount"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxCylyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphlh"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiismutiluminosityjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minSphyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiusetypeyj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bandID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgieyeglassmaterialtypejp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgiframesizejj"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphjp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="maxSphlh"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="brandID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="minCyljp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgirefractivejp"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgicolorjj"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[


select departmentID into #salesDepartments from sales_createShopCodeTab('${shopCode}')

--------------*********************************************------------------------------------

if ('${bgnDate}'<convert(varchar(10),getdate(),120))
begin

if ('${endDate}'<convert(varchar(10),getdate(),120))
begin
	select 
t1.CategoryID,
t1.GoodsCategoryName,

t1.goodsid,
t1.goodsname,
t1. ShopCode,
t1.ShopCodeName,
t1.xsNum,
t1.thNum,
t1.shNum,
t1.thje,
t1.xsje,
t1.shje,
t2.xsNum2,
t2.thNum2,
t2.shNum2,
t2.thje2,
t2.xsje2,
t2.shje2,
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t1.shje/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as jezb,
case when isnull(t2.bhsje2,0.00)=0.00 then '0%' else cast(cast(t1.bhsje/t2.bhsje2*100 as decimal(18, 2)) as varchar(20))+'%' end as cbzb,
cast(isnull(t1.bhsje,0.00)as decimal(18, 2)) as bhsje,
cast(isnull(t2.bhsje2,0.00)as decimal(18, 2)) as bhsje2,
t1.mlje,
t2.mlje2,
case when isnull(t1.shje,0.00)=0.00 then '0%' else cast(cast(t1.mlje/t1.shje*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll, 
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t2.mlje2/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll2,
t3.zhanbi as zhanbi,
t3.goodsNum as goodsNum     
 from
(	select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
		   ShopCode,
		   B_DP_DepartmentName as ShopCodeName,
	       sum(xsNum) as xsNum,
		   sum(thNum) as thNum,
           sum(xsNum)+ sum(thNum) as shNum,
		   sum(thje) as thje,
		   sum(xsje) as xsje,
           sum(thje)+ sum(xsje) as shje,
		   sum(bhsje) as bhsje,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje 
	 from (

		select 	R_SD_DSE_ShopCode as ShopCode,
			R_RC_DSE_SupplierID as SupplierID,
			R_RC_DSE_SupplierName as SupplierName,
            isnull(R_SD_DSE_GoodsNum,0) as xsNum,
			0 as thNum,
			0 as thje,
			isnull(R_SD_DSE_GoodsAmount,0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
			B_GI_ViewGoodsName as goodsname,
			R_RC_DSE_GoodsID as GoodsID,
			R_RC_DSE_BandID as brandid,
			R_RC_DSE_BandName as BrandName,
			R_RC_DSE_GoodsCategoryID as CategoryID
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='1'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<='${endDate}') or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

		union all
		select  R_SD_DSE_ShopCode as ShopCode,
			R_RC_DSE_SupplierID as SupplierID,
			R_RC_DSE_SupplierName as SupplierName,
            0 as xsNum,
			isnull(R_SD_DSE_GoodsNum,0) as thNum,
			isnull(R_SD_DSE_GoodsAmount,0) as thje,
			0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
			B_GI_ViewGoodsName as goodsname,
			R_RC_DSE_GoodsID as GoodsID,
			R_RC_DSE_BandID as brandid,
			R_RC_DSE_BandName as BrandName,
			R_RC_DSE_GoodsCategoryID as CategoryID
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='2'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<='${endDate}') or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	)temp
	left join B_Departments on B_DP_DepartmentID = ShopCode
	left join B_GoodsCategory on CategoryID = B_GC_ID
	  group by CategoryID,B_GC_GoodsCategoryName,ShopCode,B_DP_DepartmentName,goodsid,goodsname
)t1 left join
(select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
	       sum(xsNum) as xsNum2,
		   sum(thNum) as thNum2,
           sum(xsNum)+ sum(thNum) as shNum2,
		   sum(thje) as thje2,
		   sum(xsje) as xsje2,
           sum(thje)+ sum(xsje) as shje2,
		   sum(bhsje) as bhsje2,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje2
	 from (

		select 	R_SD_DSE_ShopCode as ShopCode,
			R_RC_DSE_SupplierID as SupplierID,
			R_RC_DSE_SupplierName as SupplierName,
            isnull(R_SD_DSE_GoodsNum,0) as xsNum,
			0 as thNum,
			0 as thje,
			isnull(R_SD_DSE_GoodsAmount,0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
			B_GI_ViewGoodsName as goodsname,
			R_RC_DSE_GoodsID as GoodsID,
			R_RC_DSE_BandID as brandid,
			R_RC_DSE_BandName as BrandName,
			R_RC_DSE_GoodsCategoryID as CategoryID
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='1'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<='${endDate}') or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

		union all
		select  R_SD_DSE_ShopCode as ShopCode,
			R_RC_DSE_SupplierID as SupplierID,
			R_RC_DSE_SupplierName as SupplierName,
            0 as xsNum,
			isnull(R_SD_DSE_GoodsNum,0) as thNum,
			isnull(R_SD_DSE_GoodsAmount,0) as thje,
			0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje,
			B_GI_ViewGoodsName as goodsname,
			R_RC_DSE_GoodsID as GoodsID,
			R_RC_DSE_BandID as brandid,
			R_RC_DSE_BandName as BrandName,
			R_RC_DSE_GoodsCategoryID as CategoryID
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='2'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<='${endDate}') or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	)temp
	left join B_Departments on B_DP_DepartmentID = ShopCode
	left join B_GoodsCategory on CategoryID = B_GC_ID
	  group by CategoryID,B_GC_GoodsCategoryName,goodsid,goodsname
)t2 on  t1.goodsid=t2.goodsid
left join(
	select goodsID,goodsNum,brandNum,cast(zhanbi as varchar(20))+'%' as zhanbi from (
	select goodsID,isnull(temp.goodsNum,0) as goodsNum,isnull(temp3.brandNum,0) as brandNum,
		   (case isnull(temp3.brandNum,0) when 0 then 0 else cast((isnull(temp.goodsNum,0) / isnull(temp3.brandNum,0))*100 as decimal(18, 2)) end) as zhanbi
	 from (
	select goodsID,sum(goodsNum) as goodsNum from (
	select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
	  from C_SH_StorageBeginning
	union all
	select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
	  from C_SH_StorageChange
	)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
	  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
	  group by goodsID
	)temp inner join (
		select brandID,sum(goodsNum) as brandNum from (
		select substring(goodsID,1,7) as brandID,goodsNum as goodsNum from (
		select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
		  from C_SH_StorageBeginning
		union all
		select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
		  from C_SH_StorageChange
		)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
		  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
		)temp2
		group by brandID
	)temp3 on substring(goodsID,1,7)=brandID
	  where substring(goodsID,1,1)='${goodsCategoryID}'
		   and ((isnull('${supplierID}','')<>'' and substring(goodsID,3,2)='${supplierID}' ) or (isnull('${supplierID}','')=''))
		   and ((isnull('${brandID}','')<>'' and substring(goodsID,6,2)='${brandID}' ) or (isnull('${brandID}','')=''))
	)temp4
)t3 on t1.goodsid = t3.goodsID
end
else
begin

	select 
t1.CategoryID,
t1.GoodsCategoryName,

t1.goodsid,
t1.goodsname,
t1. ShopCode,
t1.ShopCodeName,
t1.xsNum,
t1.thNum,
t1.shNum,
t1.thje,
t1.xsje,
t1.shje,
t2.xsNum2,
t2.thNum2,
t2.shNum2,
t2.thje2,
t2.xsje2,
t2.shje2,
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t1.shje/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as jezb,
case when isnull(t2.bhsje2,0.00)=0.00 then '0%' else cast(cast(t1.bhsje/t2.bhsje2*100 as decimal(18, 2)) as varchar(20))+'%' end as cbzb,
cast(isnull(t1.bhsje,0.00)as decimal(18, 2)) as bhsje,
cast(isnull(t2.bhsje2,0.00)as decimal(18, 2)) as bhsje2,
t1.mlje,
t2.mlje2,
case when isnull(t1.shje,0.00)=0.00 then '0%' else cast(cast(t1.mlje/t1.shje*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll, 
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t2.mlje2/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll2,
t3.zhanbi as zhanbi,
t3.goodsNum as goodsNum     
 from
(	select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
		   ShopCode,
		   B_DP_DepartmentName as ShopCodeName,
	       sum(xsNum) as xsNum,
		   sum(thNum) as thNum,
           sum(xsNum)+ sum(thNum) as shNum,
		   sum(thje) as thje,
		   sum(xsje) as xsje,
           sum(thje)+ sum(xsje) as shje,
		   sum(bhsje) as bhsje,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje 
	 from (
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as BrandID,
			BrandName as BrandName,
			GoodsID as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (

		select R_SD_DSE_ShopCode as ShopCode,
			   R_RC_DSE_GoodsCategoryID as CategoryID,
			   R_RC_DSE_SupplierID as SupplierID,
			   R_RC_DSE_SupplierName as SupplierName,
			   R_RC_DSE_BandID as brandid,
			   R_RC_DSE_BandName as BrandName,
               isnull(R_SD_DSE_GoodsNum,0) as xsNum,
			   R_RC_DSE_GoodsID as GoodsID,
			   B_GI_ViewGoodsName as goodsname,
			   0 as thNum,
			   0 as thje,
			   isnull(R_SD_DSE_GoodsAmount,0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='1'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<=convert(char(10), dateadd(day,-1, '${endDate}'),120)) or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

		union all
		select	R_SD_DSE_ShopCode as ShopCode,
			    R_RC_DSE_GoodsCategoryID as CategoryID,
			    R_RC_DSE_SupplierID as SupplierID,
			    R_RC_DSE_SupplierName as SupplierName,
			    R_RC_DSE_BandID as brandid,
			    R_RC_DSE_BandName as BrandName,
                0 as xsNum,
			    R_RC_DSE_GoodsID as GoodsID,
			    B_GI_ViewGoodsName as goodsname,
			    isnull(R_SD_DSE_GoodsNum,0) as thNum,
			    isnull(R_SD_DSE_GoodsAmount,0) as thje,
			    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='2'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<=convert(char(10), dateadd(day,-1, '${endDate}'),120)) or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,brandid,BrandName,GoodsID,goodsname
    union all
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as brandid,
			brandName as brandName,
			GoodsID as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (
	select  S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    isnull(sum(isnull(S_SE_SD_Number,0)),0) as xsNum,
			0 as thNum,
			0 as thje,
		    isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' 
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>=convert(varchar(10), getdate(), 23)) or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	union all
	select S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    0 as xsNum,
			-isnull(sum(isnull(S_SE_SD_Number,0)),0) as thNum,
			-isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as thje,
		    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>=convert(varchar(10), getdate(), 23)) or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,brandid,brandName,goodsid,goodsname

	)temp
	left join B_Departments on B_DP_DepartmentID = ShopCode
	left join B_GoodsCategory on CategoryID = B_GC_ID
	group by CategoryID,B_GC_GoodsCategoryName,ShopCode,B_DP_DepartmentName,goodsid,goodsname
)t1 left join
(select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
	       sum(xsNum) as xsNum2,
		   sum(thNum) as thNum2,
           sum(xsNum)+ sum(thNum) as shNum2,
		   sum(thje) as thje2,
		   sum(xsje) as xsje2,
           sum(thje)+ sum(xsje) as shje2,
		   sum(bhsje) as bhsje2,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje2
	 from (
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as BrandID,
			BrandName as BrandName,
			GoodsID as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (

		select R_SD_DSE_ShopCode as ShopCode,
			   R_RC_DSE_GoodsCategoryID as CategoryID,
			   R_RC_DSE_SupplierID as SupplierID,
			   R_RC_DSE_SupplierName as SupplierName,
			   R_RC_DSE_BandID as brandid,
			   R_RC_DSE_BandName as BrandName,
               isnull(R_SD_DSE_GoodsNum,0) as xsNum,
			   R_RC_DSE_GoodsID as GoodsID,
			   B_GI_ViewGoodsName as goodsname,
			   0 as thNum,
			   0 as thje,
			   isnull(R_SD_DSE_GoodsAmount,0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='1'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<=convert(char(10), dateadd(day,-1, '${endDate}'),120)) or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

		union all
		select	R_SD_DSE_ShopCode as ShopCode,
			    R_RC_DSE_GoodsCategoryID as CategoryID,
			    R_RC_DSE_SupplierID as SupplierID,
			    R_RC_DSE_SupplierName as SupplierName,
			    R_RC_DSE_BandID as brandid,
			    R_RC_DSE_BandName as BrandName,
                0 as xsNum,
			    R_RC_DSE_GoodsID as GoodsID,
			    B_GI_ViewGoodsName as goodsname,
			    isnull(R_SD_DSE_GoodsNum,0) as thNum,
			    isnull(R_SD_DSE_GoodsAmount,0) as thje,
			    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(R_SD_DSE_GoodsRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(R_SD_DSE_GoodsNotRateAmount, 0)
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(R_SD_DSE_GoodsAvgAmount, 0)
                                      ELSE Isnull(R_SD_DSE_GoodsRateAmount, 0)  END )AS bhsje
		  from R_RC_DaySalesEntry
		  left join B_GoodsInfo on B_GI_GoodsID = R_RC_DSE_GoodsID
		  where R_SD_DSE_SalesType='2'
			   and ((isnull('${shopCode}','')<>'' and R_SD_DSE_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
			   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
			   and ((isnull('${endDate}','')<>'' and convert(varchar(10),R_SD_DSE_Date,120)<=convert(char(10), dateadd(day,-1, '${endDate}'),120)) or isnull('${endDate}','')='')
			   and ((isnull('${goodsCategoryID}','')<>'' and R_RC_DSE_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
			   and ((isnull('${supplierID}','')<>'' and R_RC_DSE_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
			   and ((isnull('${bandID}','')<>'' and R_RC_DSE_BandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
			   and ((isnull('${goodsID}','')<>'' and R_RC_DSE_GoodsID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
			   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND R_RC_DSE_RetailPrice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND R_RC_DSE_RetailPrice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,brandid,BrandName,GoodsID,goodsname
    union all
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as brandid,
			brandName as brandName,
			GoodsID as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (
	select  S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    isnull(sum(isnull(S_SE_SD_Number,0)),0) as xsNum,
			0 as thNum,
			0 as thje,
		    isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' 
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>=convert(varchar(10), getdate(), 23)) or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	union all
	select S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    0 as xsNum,
			-isnull(sum(isnull(S_SE_SD_Number,0)),0) as thNum,
			-isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as thje,
		    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>=convert(varchar(10), getdate(), 23)) or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,brandid,brandName,goodsid,goodsname

	)temp
	left join B_GoodsCategory on CategoryID = B_GC_ID
	group by CategoryID,B_GC_GoodsCategoryName,goodsid,goodsname
)t2 on  t1.goodsid=t2.goodsid
left join(
	select goodsID,goodsNum,brandNum,cast(zhanbi as varchar(20))+'%' as zhanbi from (
	select goodsID,isnull(temp.goodsNum,0) as goodsNum,isnull(temp3.brandNum,0) as brandNum,
		   (case isnull(temp3.brandNum,0) when 0 then 0 else cast((isnull(temp.goodsNum,0) / isnull(temp3.brandNum,0))*100 as decimal(18, 2)) end) as zhanbi
	 from (
	select goodsID,sum(goodsNum) as goodsNum from (
	select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
	  from C_SH_StorageBeginning
	union all
	select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
	  from C_SH_StorageChange
	)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
	  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
	  group by goodsID
	)temp inner join (
		select brandID,sum(goodsNum) as brandNum from (
		select substring(goodsID,1,7) as brandID,goodsNum as goodsNum from (
		select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
		  from C_SH_StorageBeginning
		union all
		select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
		  from C_SH_StorageChange
		)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
		  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
		)temp2
		group by brandID
	)temp3 on substring(goodsID,1,7)=brandID
	  where substring(goodsID,1,1)='${goodsCategoryID}'
		   and ((isnull('${supplierID}','')<>'' and substring(goodsID,3,2)='${supplierID}' ) or (isnull('${supplierID}','')=''))
		   and ((isnull('${brandID}','')<>'' and substring(goodsID,6,2)='${brandID}' ) or (isnull('${brandID}','')=''))
	)temp4
)t3 on t1.goodsid = t3.goodsID
end

end
else
begin

		select 
t1.CategoryID,
t1.GoodsCategoryName,

t1.goodsid,
t1.goodsname,
t1. ShopCode,
t1.ShopCodeName,
t1.xsNum,
t1.thNum,
t1.shNum,
t1.thje,
t1.xsje,
t1.shje,
t2.xsNum2,
t2.thNum2,
t2.shNum2,
t2.thje2,
t2.xsje2,
t2.shje2,
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t1.shje/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as jezb,
case when isnull(t2.bhsje2,0.00)=0.00 then '0%' else cast(cast(t1.bhsje/t2.bhsje2*100 as decimal(18, 2)) as varchar(20))+'%' end as cbzb,
cast(isnull(t1.bhsje,0.00)as decimal(18, 2)) as bhsje,
cast(isnull(t2.bhsje2,0.00)as decimal(18, 2)) as bhsje2,
t1.mlje,
t2.mlje2,
case when isnull(t1.shje,0.00)=0.00 then '0%' else cast(cast(t1.mlje/t1.shje*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll, 
case when isnull(t2.shje2,0.00)=0.00 then '0%' else cast(cast(t2.mlje2/t2.shje2*100 as decimal(18, 2)) as varchar(20))+'%' end as xsmll2,
t3.zhanbi as zhanbi,
t3.goodsNum as goodsNum     
 from
(	select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
		   ShopCode,
		   B_DP_DepartmentName as ShopCodeName,
	       sum(xsNum) as xsNum,
		   sum(thNum) as thNum,
           sum(xsNum)+ sum(thNum) as shNum,
		   sum(thje) as thje,
		   sum(xsje) as xsje,
           sum(thje)+ sum(xsje) as shje,
		   sum(bhsje) as bhsje,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje 
	 from (
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as brandid,
		    brandName as brandName,
			goodsid as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (
	select  S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    isnull(sum(isnull(S_SE_SD_Number,0)),0) as xsNum,
			0 as thNum,
			0 as thje,
		    isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' 
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	union all
	select S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    0 as xsNum,
			-isnull(sum(isnull(S_SE_SD_Number,0)),0) as thNum,
		    -isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as thje,
		    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )



	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,BrandID,brandName,goodsid,goodsname

	)temp
	left join B_Departments on B_DP_DepartmentID = ShopCode
	left join B_GoodsCategory on CategoryID = B_GC_ID
	group by CategoryID,B_GC_GoodsCategoryName,ShopCode,B_DP_DepartmentName,goodsid,goodsname
)t1 left join
(select CategoryID as CategoryID,
		   B_GC_GoodsCategoryName as GoodsCategoryName,
		   goodsid as goodsid,
		   goodsname as goodsname,
	       sum(xsNum) as xsNum2,
		   sum(thNum) as thNum2,
           sum(xsNum)+ sum(thNum) as shNum2,
		   sum(thje) as thje2,
		   sum(xsje) as xsje2,
           sum(thje)+ sum(xsje) as shje2,
		   sum(bhsje) as bhsje2,
           sum(thje)+ sum(xsje)-sum(bhsje) as mlje2
	 from (
	select  CategoryID,
			ShopCode,
			SupplierID as SupplierID,
			SupplierName as SupplierName,
			brandid as brandid,
		    brandName as brandName,
			goodsid as goodsid,
			goodsname as goodsname,
			sum(xsNum) as xsNum,
			sum(thNum) as thNum,
		    sum(thje) as thje,
			sum(xsje) as xsje,
			sum(bhsje) as bhsje 
	from (
	select  S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    isnull(sum(isnull(S_SE_SD_Number,0)),0) as xsNum,
			0 as thNum,
			0 as thje,
		    isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' 
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )

	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	union all
	select S_SE_SB_ShopCode as ShopCode,
			S_SE_SD_CommoditiesFlag as CategoryID,
			B_SP_ID as SupplierID,
			B_SP_SupplierName as SupplierName,
			B_BD_ID as brandid,
		    B_BD_brandName as brandName,
			S_SE_SD_SalesItemID as GoodsID,
			B_GI_ViewGoodsName as goodsname,
		    0 as xsNum,
			-isnull(sum(isnull(S_SE_SD_Number,0)),0) as thNum,
			-isnull(sum(isnull(S_SE_SD_SalesValue,0)),0) as thje,
		    0 as xsje,
                                     (CASE 
                                        WHEN ISNULL('${salesCost}', '') = '1' THEN -Isnull(SUM(Isnull(S_SE_SD_CostsPrive * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '2' THEN -Isnull(SUM(Isnull(S_SE_SD_UnitPrice * S_SE_SD_Number, 0)), 0) 
                                        WHEN ISNULL('${salesCost}', '') = '3' THEN -Isnull(SUM(Isnull(dbo.ufn_getGoodsInfoByCompany('',S_SE_SB_ShopCode,S_SE_SD_SalesItemID) * S_SE_SD_Number, 0)), 0)
                                      ELSE -Isnull(SUM(Isnull(S_SE_SD_SalesValue, 0)), 0)  END )AS bhsje

	  from S_SE_SalesBasic_Today inner join S_SE_SalesDetail_Today on S_SE_SB_SalesID=S_SE_SD_SalesID
		   left join B_GoodsInfo on S_SE_SD_SalesItemID=B_GI_GoodsID
		   left join B_Brand on B_BD_ID=B_GI_BrandID and B_GI_SupplierID=B_BD_SupplierID
		   left join B_Supplier on B_GI_SupplierID=B_SP_ID
	  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
		   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
		   and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
		   and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
		   and ((isnull('${goodsCategoryID}','')<>'' and B_GI_GoodsCategoryID=isnull('${goodsCategoryID}','')) or isnull('${goodsCategoryID}','')='')
		   and ((isnull('${supplierID}','')<>'' and B_GI_SupplierID=isnull('${supplierID}','')) or isnull('${supplierID}','')='')
		   and ((isnull('${bandID}','')<>'' and B_GI_BrandID=isnull('${bandID}','')) or isnull('${bandID}','')='')
		   and ((isnull('${goodsID}','')<>'' and S_SE_SD_SalesItemID like '%' + isnull('${goodsID}','') + '%') or isnull('${goodsID}','')='')
		   and ((isnull('${goodsName}','')<>'' and B_GI_ViewGoodsName like '%' + isnull('${goodsName}','') + '%') or isnull('${goodsName}','')='')
		   and (('${bgispecjj}' <> '' and B_GoodsInfo.B_GI_Spec='${bgispecjj}') or ('${bgispecjj}' = ''))  --型号
	and (('${bgicolorjj}' <> '' and B_GoodsInfo.B_GI_Color='${bgicolorjj}') or ('${bgicolorjj}' = ''))  --色号
	and (('${bgiframesizejj}' <> '' and B_GoodsInfo.B_GI_FrameSize='${bgiframesizejj}') or ('${bgiframesizejj}' = ''))  --尺寸 
	and (('${bgieyeglassmaterialtypejp}' <> '' and B_GoodsInfo.B_GI_EyeGlassMaterialType='${bgieyeglassmaterialtypejp}') or ('${bgieyeglassmaterialtypejp}' = '')) --镜片材料分类
	and (('${bgirefractivejp}' <> '' and B_GoodsInfo.B_GI_Refractive='${bgirefractivejp}') or ('${bgirefractivejp}' = ''))  --镜片折射率
	and (('${bgiismutiluminosityjp}' <> '' and B_GoodsInfo.B_GI_isMutiLuminosity='${bgiismutiluminosityjp}') or ('${bgiismutiluminosityjp}' = ''))   --镜片光度分类
	and (('${minSphjp}' <> '' and B_GoodsInfo.B_GI_Sph >= cast( '${minSphjp}' as float)) or ('${minSphjp}' = ''))   --镜片球镜范围
	and (('${maxSphjp}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphjp}' = ''))   --镜片球镜范围
	and (('${minCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCyljp}' = ''))   --镜片柱镜范围
	and (('${maxCyljp}' <> '' and B_GoodsInfo.B_GI_Cyl <= cast( '${maxCyljp}' as float)) or ('${maxCyljp}' = ''))   --镜片柱镜范围
	and (('${bgiusetypeyj}' <> '' and B_GoodsInfo.B_GI_UseType='${bgiusetypeyj}') or ('${bgiusetypeyj}' = ''))   --隐形使用类型
	and (('${bgistealthclassyj}' <> '' and B_GoodsInfo.B_GI_StealthClass='${bgistealthclassyj}') or ('${bgistealthclassyj}' = ''))   --抛弃型分类
	and (('${minSphyj}' <> '' and B_GoodsInfo.B_GI_Sph >= cast('${minSphjp}' as float)) or ('${minSphyj}' = ''))   --隐形球镜范围
	and (('${maxSphyj}' <> '' and B_GoodsInfo.B_GI_Sph <= cast('${maxSphjp}' as float)) or ('${maxSphyj}' = ''))   --隐形球镜范围
	and (('${minCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl >= cast( '${minCyljp}' as float)) or ('${minCylyj}' = ''))   --隐形柱镜范围
	and (('${maxCylyj}' <> '' and B_GoodsInfo.B_GI_Cyl  <= cast( '${maxCyljp}' as float)) or ('${maxCylyj}' = ''))   --隐形柱镜范围
    AND ( ( '${minSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph >= CAST('${minSphlh}' AS FLOAT) ) OR ( '${minSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${maxSphlh}' <> '' AND B_GoodsInfo.B_GI_Sph <= CAST('${maxSphlh}' AS FLOAT) ) OR ( '${maxSphlh}' = '' ) ) --老花球镜范围
    AND ( ( '${bgiothergoodsbigclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsBigClass = '${bgiothergoodsbigclass}' )  OR ( '${bgiothergoodsbigclass}' = '' ) ) --其他大类
    AND ( ( '${bgiothergoodssmallclass}' <> '' AND B_GoodsInfo.B_GI_OtherGoodsSmallClass = '${bgiothergoodssmallclass}' ) OR ( '${bgiothergoodssmallclass}' = '' ) ) --其他小类
	AND ( ( '${bgnretailamount}' <> '' AND S_SE_SD_Sprice >= CAST('${bgnretailamount}' AS FLOAT) ) OR ( '${bgnretailamount}' = '' ) )
    AND ( ( '${endretailamount}' <> '' AND S_SE_SD_Sprice <= CAST('${endretailamount}' AS FLOAT) ) OR ( '${endretailamount}' = '' ) )



	  group by  S_SE_SD_SalesItemID,
				B_GI_ViewGoodsName,
				B_BD_ID,
				S_SE_SD_CommoditiesFlag,
				S_SE_SB_ShopCode,
				B_SP_ID,
				B_SP_SupplierName,
				B_BD_brandName
	)temp
	  group by CategoryID,ShopCode,SupplierID,SupplierName,BrandID,brandName,goodsid,goodsname

	)temp

	left join B_GoodsCategory on CategoryID = B_GC_ID
	group by CategoryID,B_GC_GoodsCategoryName,goodsid,goodsname
)t2 on  t1.goodsid=t2.goodsid
left join(
	select goodsID,goodsNum,brandNum,cast(zhanbi as varchar(20))+'%' as zhanbi from (
	select goodsID,isnull(temp.goodsNum,0) as goodsNum,isnull(temp3.brandNum,0) as brandNum,
		   (case isnull(temp3.brandNum,0) when 0 then 0 else cast((isnull(temp.goodsNum,0) / isnull(temp3.brandNum,0))*100 as decimal(18, 2)) end) as zhanbi
	 from (
	select goodsID,sum(goodsNum) as goodsNum from (
	select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
	  from C_SH_StorageBeginning
	union all
	select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
	  from C_SH_StorageChange
	)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
	  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
	  group by goodsID
	)temp inner join (
		select brandID,sum(goodsNum) as brandNum from (
		select substring(goodsID,1,7) as brandID,goodsNum as goodsNum from (
		select C_SH_SB_GoodsId as goodsID,C_SH_SB_StockId as stockID,C_SH_SB_GoodsQuantity as goodsNum 
		  from C_SH_StorageBeginning
		union all
		select C_SH_SC_GoodsId as goodsID,C_SH_SC_StockId as stockID,C_SH_SC_GoodsQuantity as goodsNum
		  from C_SH_StorageChange
		)temp inner join B_Warehouse on stockID=B_WH_ID inner join B_Departments on B_WH_deptID=B_DP_DepartmentID
		  where B_DP_Type='1'
			AND ((ISNULL('${shopCode}', '')<>'' AND B_DP_DepartmentID IN (SELECT departmentID FROM   #salesDepartments)) OR (ISNULL('${shopCode}','')=''))
		)temp2
		group by brandID
	)temp3 on substring(goodsID,1,7)=brandID
	  where substring(goodsID,1,1)='${goodsCategoryID}'
		   and ((isnull('${supplierID}','')<>'' and substring(goodsID,3,2)='${supplierID}' ) or (isnull('${supplierID}','')=''))
		   and ((isnull('${brandID}','')<>'' and substring(goodsID,6,2)='${brandID}' ) or (isnull('${brandID}','')=''))
	)temp4
)t3 on t1.goodsid = t3.goodsID

end

drop table #salesDepartments

]]></Query>
</TableData>
<TableData name="ds4" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select departmentID into #salesDepartments from sales_createShopCodeTab('${shopCode}')

select sum(xiaoshou) as xiaoshou from (
select isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' 
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')

union all
select -isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic
  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')
union all
select isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' 
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_PosDatetime,120)<='${endDate}') or isnull('${endDate}','')='')

union all
select -isnull(sum(isnull(S_SE_SB_SalesValue,0)),0) as xiaoshou
  from S_SE_SalesBasic_Finished
  where S_SE_SB_ValueFlag='1' and S_SE_SB_WithdrawFlag='1'
       and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #salesDepartments)) or isnull('${shopCode}','')='')
       and ((isnull('${bgnDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)>='${bgnDate}') or isnull('${bgnDate}','')='')
       and ((isnull('${endDate}','')<>'' and convert(varchar(10),S_SE_SB_WithdrawDate,120)<='${endDate}') or isnull('${endDate}','')='')


)temp

drop table #salesDepartments]]></Query>
</TableData>
<TableData name="ds5" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="supplierID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select top 1 B_SP_SupplierName from B_Supplier where B_SP_ID = '${supplierID}']]></Query>
</TableData>
<TableData name="ds6" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select B_GC_GoodsCategoryName
 from B_GoodsCategory
 where ((isnull('${goodsCategoryID}','')='' and B_GC_ID in (select B_GC_ID  from B_GoodsCategory)) or (isnull('${goodsCategoryID}','')<>'' and B_GC_ID='${goodsCategoryID}'))]]></Query>
</TableData>
<TableData name="ds7" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="shopCode"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="bgnDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select departmentID into #shopCode from sales_createShopCodeTab('${shopCode}')
select '附加费用' as fjname,
ShopCode as ShopCode,
B_DP_DepartmentName as DepartmentName,
sum(sNumber) as sNumber,
sum(samount) as samount,
sum(tNumber) as tNumber,
sum(tamount) as tamount,
sum(sNumber)+sum(tNumber) as hNumber,
sum(samount)+sum(tamount) as hamount
 from
(
    select
         isnull(S_SE_Number,0) as sNumber
        ,cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0')as decimal(18, 2)) as samount,
        0 as tNumber,
        0.00 as tamount,
     S_SE_SB_ShopCode as ShopCode
    from
        S_se_SalesBasic
    left join
        S_SE_AdditionalCDetail
    on S_SE_AdditionalCDetail.S_SE_SalesID  = s_se_sb_salesid
    where 1=1
 and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10),s_se_sb_PosDatetime,23) >= '${bgnDate}'
    and convert(varchar(10),s_se_sb_PosDatetime,23) <= '${endDate}'
    Union All
    select
        0 as sNumber,
        0.00 as samount,
        -cast(isnull(S_SE_Number,0) as decimal(18, 2)) as tNumber,
        -cast(cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0') as varchar(32)) as decimal(18, 2))  as tamount,        
        S_SE_SB_ShopCode
	 from 
        S_se_SalesBasic
    left join 
        S_SE_AdditionalCDetail
	on S_SE_AdditionalCDetail.S_SE_SalesID = s_se_sb_salesid
	where 1=1
   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10), S_SE_SB_WithdrawDate, 23) >=  '${bgnDate}'
	and convert(varchar(10), S_SE_SB_WithdrawDate, 23) <='${endDate}'
	and s_se_sb_withdrawflag = 1
union all
    select
         isnull(S_SE_Number,0) as sNumber
        ,cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0')as decimal(18, 2)) as samount,
        0 as tNumber,
        0.00 as tamount,
     S_SE_SB_ShopCode as ShopCode
    from
        S_SE_SalesBasic_Finished
    left join
        S_SE_AdditionalCDetail
    on S_SE_AdditionalCDetail.S_SE_SalesID  = s_se_sb_salesid
    where 1=1
 and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10),s_se_sb_PosDatetime,23) >= '${bgnDate}'
    and convert(varchar(10),s_se_sb_PosDatetime,23) <= '${endDate}'
    Union All
    select
        0 as sNumber,
        0.00 as samount,
        -cast(isnull(S_SE_Number,0) as decimal(18, 2)) as tNumber,
        -cast(cast(isnull(S_SE_AdditionalCDetail.S_SE_Amount*S_SE_Number,'0.0') as varchar(32)) as decimal(18, 2))  as tamount,        
        S_SE_SB_ShopCode
	 from 
        S_SE_SalesBasic_Finished
    left join 
        S_SE_AdditionalCDetail
	on S_SE_AdditionalCDetail.S_SE_SalesID = s_se_sb_salesid
	where 1=1
   and ((isnull('${shopCode}','')<>'' and S_SE_SB_ShopCode in (select departmentID from #shopCode )) or (isnull('${shopCode}','')=''))
 
    and s_se_sb_ValueFlag = '1'
    and convert(varchar(10), S_SE_SB_WithdrawDate, 23) >=  '${bgnDate}'
	and convert(varchar(10), S_SE_SB_WithdrawDate, 23) <='${endDate}'
	and s_se_sb_withdrawflag = 1

)temp
inner join B_Departments on ShopCode=B_DP_DepartmentID

 group by ShopCode,B_DP_DepartmentName
DROP TABLE #shopCode]]></Query>
</TableData>
</TableDataMap>
<ReportWebAttr>
<WebPageContent>
<ToolBars>
<ToolBarManager>
<Location>
<Embed position="1"/>
</Location>
<ToolBar>
<Widget class="com.fr.report.web.ui.impl.page.First">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-First')}]]></Text>
<IconName>
<![CDATA[first]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Previous">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Previous')}]]></Text>
<IconName>
<![CDATA[previous]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.PageNavi">
<WidgetAttr/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Next">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Next')}]]></Text>
<IconName>
<![CDATA[next]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.Last">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('ReportServerP-Last')}]]></Text>
<IconName>
<![CDATA[last]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.FlashPrint">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Utils-Print[Client]A')}]]></Text>
<IconName>
<![CDATA[flashprint]]></IconName>
</Widget>
<Widget class="com.fr.report.web.ui.impl.Export">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('Export')}]]></Text>
<IconName>
<![CDATA[export]]></IconName>
<Buttons pdf="true" excelP="true" excelO="true" excelS="true" word="true" image="true" html="true"/>
</Widget>
<Widget class="com.fr.report.web.ui.impl.page.SetPrinterOffset">
<WidgetAttr/>
<Text>
<![CDATA[${i18n('SetPrinterOffset')}]]></Text>
<IconName>
<![CDATA[setprinteroffset]]></IconName>
</Widget>
</ToolBar>
</ToolBarManager>
</ToolBars>
<WebPage isPage="false" isShowAsImage="false" isAutoScale="false" isTDHeavy="false"/>
</WebPageContent>
</ReportWebAttr>
<ReportExportAttr>
<ExcelExportAttr hideColumn="false" hideRow="false"/>
<PDFExportAttr/>
<HTMLExportAttr/>
</ReportExportAttr>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="0" T="7"/>
<FR/>
<HC F="0" T="3"/>
<FC/>
<UPFCR COLUMN="true" ROW="true"/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,914400,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[576000,0,6210300,9144000,2592000,2592000,2592000,2592000,2592000,2592000,2592000,0,2592000,2743200,0,3086100,3086100,0,2743200,2743200,2592000,2592000,2592000,2592000,2592000,2592000,2592000,2592000,2743200,2592000,3352800,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" s="0">
<Expand/>
</C>
<C c="1" r="0" s="0">
<Expand/>
</C>
<C c="2" r="0" s="0">
<Expand/>
</C>
<C c="3" r="0" cs="29" s="1">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="32" r="0" s="0">
<Expand/>
</C>
<C c="0" r="1" s="0">
<Expand/>
</C>
<C c="1" r="1" s="0">
<Expand/>
</C>
<C c="2" r="1" s="0">
<Expand/>
</C>
<C c="3" r="1" cs="29" s="2">
<O>
<![CDATA[商品销售分析表（商品）]]></O>
<Expand/>
</C>
<C c="32" r="1" s="0">
<Expand/>
</C>
<C c="0" r="2" s="3">
<Expand/>
</C>
<C c="1" r="2" s="3">
<Expand/>
</C>
<C c="2" r="2" s="4">
<O>
<![CDATA[查询日期：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="2" cs="14" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate + " 至 " + $endDate]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="2" cs="16" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate + " 至 " + $endDate]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="2" s="3">
<Expand/>
</C>
<C c="23" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="2" s="3">
<Expand/>
</C>
<C c="26" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="2" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="2" s="3">
<Expand/>
</C>
<C c="32" r="2" s="3">
<Expand/>
</C>
<C c="0" r="3" s="3">
<Expand/>
</C>
<C c="1" r="3" s="5">
<Expand/>
</C>
<C c="2" r="3" s="5">
<O>
<![CDATA[制造商：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="3" cs="14" s="5">
<O t="DSColumn">
<Attributes dsName="ds5" columnName="B_SP_SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="4" r="3" cs="16" s="5">
<O t="DSColumn">
<Attributes dsName="ds5" columnName="B_SP_SupplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="20" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="3" s="3">
<Expand/>
</C>
<C c="23" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="3" s="3">
<Expand/>
</C>
<C c="26" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="3" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="3" s="3">
<Expand/>
</C>
<C c="32" r="3" s="3">
<Expand/>
</C>
<C c="0" r="4" s="3">
<Expand/>
</C>
<C c="1" r="4" s="5">
<Expand/>
</C>
<C c="2" r="4" s="5">
<O>
<![CDATA[销售门店：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="4" cs="14" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentNames]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="4" r="4" cs="16" s="5">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentNames]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="20" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="4" s="3">
<Expand/>
</C>
<C c="23" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="4" s="3">
<Expand/>
</C>
<C c="26" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="4" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="4" s="3">
<Expand/>
</C>
<C c="32" r="4" s="3">
<Expand/>
</C>
<C c="0" r="5" s="3">
<Expand/>
</C>
<C c="1" r="5" s="5">
<Expand/>
</C>
<C c="2" r="5" s="5">
<O>
<![CDATA[商品类别：]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="5" cs="11" s="4">
<O t="DSColumn">
<Attributes dsName="ds6" columnName="B_GC_GoodsCategoryName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[$$$]]></Result>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$isShow = 1]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.RowHeightHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="5" s="3">
<Expand/>
</C>
<C c="15" r="5" s="3">
<Expand/>
</C>
<C c="16" r="5" s="3">
<Expand/>
</C>
<C c="17" r="5" s="3">
<Expand/>
</C>
<C c="18" r="5" s="6">
<Expand/>
</C>
<C c="19" r="5" s="6">
<Expand/>
</C>
<C c="20" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="5" s="3">
<Expand/>
</C>
<C c="23" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="5" s="3">
<Expand/>
</C>
<C c="26" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="5" s="3">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="5" s="3">
<Expand/>
</C>
<C c="32" r="5" s="3">
<Expand/>
</C>
<C c="0" r="6" s="7">
<Expand/>
</C>
<C c="1" r="6" s="8">
<Expand/>
</C>
<C c="2" r="6" rs="2" s="9">
<O>
<![CDATA[商品代码]]></O>
<Expand/>
</C>
<C c="3" r="6" rs="2" s="9">
<O>
<![CDATA[商品名称]]></O>
<Expand/>
</C>
<C c="4" r="6" cs="16" s="9">
<O>
<![CDATA[销售信息小计]]></O>
<Expand/>
</C>
<C c="20" r="6" cs="13" s="9">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="ShopCodeName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$shopcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="1"/>
</C>
<C c="0" r="7" s="7">
<Expand/>
</C>
<C c="1" r="7" s="8">
<Expand/>
</C>
<C c="4" r="7" s="10">
<O>
<![CDATA[销售数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[1]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[2]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="5" r="7" s="10">
<O>
<![CDATA[退货数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[3]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[4]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="6" r="7" s="10">
<O>
<![CDATA[实售数量]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[5]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[6]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="7" r="7" s="10">
<O>
<![CDATA[销售金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[7]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[8]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="8" r="7" s="10">
<O>
<![CDATA[退款金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[9]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[10]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="9" r="7" s="10">
<O>
<![CDATA[实售金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[11]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[12]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="10" r="7" s="10">
<O>
<![CDATA[金额占比]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[13]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[14]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="11" r="7" s="7">
<Expand/>
</C>
<C c="12" r="7" s="10">
<O>
<![CDATA[成本金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[15]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[16]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="13" r="7" s="10">
<O>
<![CDATA[成本占比]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[21]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[22]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="14" r="7" s="7">
<Expand/>
</C>
<C c="15" r="7" s="10">
<O>
<![CDATA[毛利金额]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[17]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[18]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="16" r="7" s="10">
<O>
<![CDATA[销售毛利率]]></O>
<NameJavaScriptGroup>
<NameJavaScript name="从小到大">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[19]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
<NameJavaScript name="从大到小">
<JavaScript class="com.fr.base.js.ParameterJavaScript">
<Parameters>
<Parameter>
<Attributes name="order"/>
<O>
<![CDATA[20]]></O>
</Parameter>
</Parameters>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="17" r="7" s="7">
<Expand/>
</C>
<C c="18" r="7" s="9">
<O>
<![CDATA[库存数量]]></O>
<Expand/>
</C>
<C c="19" r="7" s="9">
<O>
<![CDATA[库存占比]]></O>
<Expand/>
</C>
<C c="20" r="7" s="9">
<O>
<![CDATA[销售数量]]></O>
<CellGUIAttr printBackground="false" showAsDefault="true"/>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand order="2"/>
</C>
<C c="21" r="7" s="9">
<O>
<![CDATA[退货数量]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="7" s="9">
<O>
<![CDATA[实售数量]]></O>
<Expand/>
</C>
<C c="23" r="7" s="9">
<O>
<![CDATA[销售金额]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="7" s="9">
<O>
<![CDATA[退款金额]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="7" s="9">
<O>
<![CDATA[实售金额]]></O>
<Expand/>
</C>
<C c="26" r="7" s="9">
<O>
<![CDATA[金额占比]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="7" s="9">
<O>
<![CDATA[成本金额]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="7" s="9">
<O>
<![CDATA[成本占比]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="7" s="9">
<O>
<![CDATA[毛利金额]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="7" s="9">
<O>
<![CDATA[销售毛利率]]></O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="7" s="9">
<O>
<![CDATA[库存数量]]></O>
<Expand/>
</C>
<C c="32" r="7" s="9">
<O>
<![CDATA[库存占比]]></O>
<Expand/>
</C>
<C c="1" r="8" s="11">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="CategoryID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="goodsid"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[(row() - 8) % 20 = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.PageHighlightAction">
<P i="1"/>
</HighlightAction>
</Highlight>
</HighlightList>
<Expand dir="0" order="2">
<SortFormula>
<![CDATA[SWITCH($order, "1", -TODOUBLE(E9), "2", TODOUBLE(E9), "3", -TODOUBLE(F9), "4", TODOUBLE(F9), "5", -TODOUBLE(G9), "6", TODOUBLE(G9), "7", -TODOUBLE(H9), "8", TODOUBLE(H9), "9", -TODOUBLE(I9), "10", TODOUBLE(I9), "11", -TODOUBLE(J9), "12", TODOUBLE(J9), "13", -TODOUBLE(L9), "14", TODOUBLE(L9), "15", -TODOUBLE(M9), "16", TODOUBLE(M9), "17", -TODOUBLE(P9), "18", TODOUBLE(P9), "19", -TODOUBLE(R9), "20", TODOUBLE(R9), "21", -TODOUBLE(O9), "22", TODOUBLE(O9), "23", -TODOUBLE(V9), "24", TODOUBLE(V9), "25", -TODOUBLE(W9), "26", TODOUBLE(W9), "27", -TODOUBLE(X9), "28", TODOUBLE(X9), "29", -TODOUBLE(Y9), "30", TODOUBLE(Y9), "31", -TODOUBLE(Z9), "32", TODOUBLE(Z9), "33", -TODOUBLE(AA9), "34", TODOUBLE(AA9), "35", -TODOUBLE(AB9), "36", TODOUBLE(AB9), "37", -TODOUBLE(AD9), "38", TODOUBLE(AD9), "39", -TODOUBLE(AE9), "40", TODOUBLE(AE9))]]></SortFormula>
</Expand>
</C>
<C c="3" r="8" s="13">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="goodsname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<NameJavaScriptGroup>
<NameJavaScript name="JavaScript2">
<JavaScript class="com.fr.base.js.JavaScriptImpl">
<Parameters>
<Parameter>
<Attributes name="bgnDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endDate"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endDate]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsCategoryID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=B9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="customAmountName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$customAmountName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopCode"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopCode]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="departmentNames"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$departmentNames]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="querySystematics"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$querySystematics]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="isShow"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$isShow]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgispecjj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgispecjj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgicolorjj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgicolorjj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiframesizejj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiframesizejj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgieyeglassmaterialtypejp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgieyeglassmaterialtypejp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgirefractivejp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgirefractivejp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiismutiluminosityjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiismutiluminosityjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphjp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphjp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minCyljp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minCyljp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxCyljp"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxCyljp]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiusetypeyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiusetypeyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgistealthclassyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgistealthclassyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minCylyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minCylyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxCylyj"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxCylyj]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodsbigclass"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiothergoodsbigclass]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgiothergoodssmallclass"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgiothergoodssmallclass]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="minSphlh"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$minSphlh]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="maxSphlh"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$maxSphlh]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="pjlx"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$pjlx]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="shopcol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$shopcol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesnumcol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesnumcol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="moneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$moneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="costmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$costmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="zmoneycol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$zmoneycol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="zmoneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$zmoneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="supplierID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$supplierID]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bandID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=D9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$goodsName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="goodsID"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=C9]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="bgnretailamount"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$bgnretailamount]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="endretailamount"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$endretailamount]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="costmoneyratecol"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$costmoneyratecol]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="showCompanyName"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$showCompanyName]]></Attributes>
</O>
</Parameter>
<Parameter>
<Attributes name="salesCost"/>
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=$salesCost]]></Attributes>
</O>
</Parameter>
</Parameters>
<JSImport>
<![CDATA[js/pengsheng-checkform.js]]></JSImport>
<JSImport>
<![CDATA[js/windowOpen.js]]></JSImport>
<Content>
<![CDATA[var DataURL = "report.action?reportlet=sales_goodsSalesAnalysisNew_Orders.cpt&__bypagesize__=false&bgnDate="+bgnDate+"&endDate="+endDate+"&goodsCategoryID="+goodsCategoryID+"&salesCost="+salesCost+"&customAmountName="+EncodeUtf8(customAmountName)+"&shopCode="+shopCode+"&departmentNames="+EncodeUtf8(departmentNames)+"&querySystematics="+EncodeUtf8(querySystematics)+"&isShow="+isShow+"&bgispecjj="+bgispecjj+"&bgicolorjj="+bgicolorjj+"&bgiframesizejj="+bgiframesizejj+"&bgieyeglassmaterialtypejp="+bgieyeglassmaterialtypejp+"&bgirefractivejp="+bgirefractivejp+"&bgiismutiluminosityjp="+bgiismutiluminosityjp+"&minSphjp="+minSphjp+"&maxSphjp="+maxSphjp+"&minCyljp="+minCyljp+"&maxCyljp="+maxCyljp+"&bgiusetypeyj="+bgiusetypeyj+"&bgistealthclassyj="+bgistealthclassyj+"&minSphyj="+minSphyj+"&maxSphyj="+maxSphyj+"&minCylyj="+minCylyj+"&maxCylyj="+maxCylyj+"&bgiothergoodsbigclass="+bgiothergoodsbigclass+"&bgiothergoodssmallclass="+bgiothergoodssmallclass+"&minSphlh="+minSphlh+"&maxSphlh="+maxSphlh+"&pjlx="+pjlx+"&shopcol="+shopcol+"&salesnumcol="+salesnumcol+"&salesmoneycol="+salesmoneycol+"&moneyratecol="+moneyratecol+"&costmoneycol="+costmoneycol+"&zmoneycol="+zmoneycol+"&zmoneyratecol="+zmoneyratecol+"&supplierID="+supplierID+"&bandID="+bandID+"&goodsName="+EncodeUtf8(goodsName)+"&goodsID="+goodsID+"&bgnretailamount="+bgnretailamount+"&endretailamount="+endretailamount+"&costmoneyratecol="+costmoneyratecol+"&showCompanyName="+showCompanyName;

openWindowForReport(DataURL);]]></Content>
</JavaScript>
</NameJavaScript>
</NameJavaScriptGroup>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[(row() - 8) % 20 = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.PageHighlightAction">
<P i="1"/>
</HighlightAction>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="4" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="5" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="6" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shNum2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="7" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="8" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="9" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="10" r="8" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((J9 / J11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="11" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=J9 / J11]]></Attributes>
</O>
<Expand/>
</C>
<C c="12" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="bhsje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="13" r="8" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((M9 / M11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=M9 / M11]]></Attributes>
</O>
<Expand/>
</C>
<C c="15" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="mlje2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="16" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsmll2"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="17" r="8">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=P9 / J9]]></Attributes>
</O>
<Expand/>
</C>
<C c="18" r="8" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(AF9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="19" r="8" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((S9 / S11) * 100) + "%"]]></Attributes>
</O>
<Expand/>
</C>
<C c="20" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="21" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="22" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="23" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsje"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="24" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="thje"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="25" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="shje"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="26" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="jezb"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="27" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="bhsje"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="28" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="cbzb"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="29" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="mlje"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="30" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="xsmll"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="31" r="8" s="12">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="goodsNum"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="32" r="8" s="12">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((AF9 / AF11) * 100) + "%"]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="9" s="11">
<Expand/>
</C>
<C c="2" r="9" cs="2" s="14">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="GoodsCategoryName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[(row() - 8) % 20 = 0]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.PageHighlightAction">
<P i="1"/>
</HighlightAction>
</Highlight>
</HighlightList>
<Expand dir="0" leftParentDefault="false" left="B9"/>
</C>
<C c="4" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(E9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(F9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(G9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="7" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(H9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="8" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(I9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(J9))]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((J10 / J11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(M9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((M10 / M11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="14" r="9">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=M10 / M11]]></Attributes>
</O>
<Expand/>
</C>
<C c="15" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(P9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="16" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((P10 / J10) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="18" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(S9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="19" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((S10 / S11) * 100) + "%"]]></Attributes>
</O>
<Expand/>
</C>
<C c="20" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(U9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(V9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(W9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="23" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(X9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Y9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Z9))]]></Attributes>
</O>
<Expand/>
</C>
<C c="26" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((Z10 / Z11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(AB9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((AB10 / Z11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand dir="0"/>
</C>
<C c="29" r="9" s="15">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(AD9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((AD10 / Z10) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(AF9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="32" r="9" s="16">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((AF10 / AF11) * 100) + "%"]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="1" r="10" s="11">
<Expand/>
</C>
<C c="2" r="10" cs="2" s="17">
<O>
<![CDATA[合计：]]></O>
<Expand/>
</C>
<C c="4" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(U11)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="5" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(V11)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="6" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(W11)]]></Attributes>
</O>
<Expand/>
</C>
<C c="7" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(X11))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="8" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Y11))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="9" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Z11))]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="10" s="18">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(M10))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="10" s="18">
<Expand/>
</C>
<C c="15" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(P10))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="16" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((P11 / J11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="18" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(S10)]]></Attributes>
</O>
<Expand/>
</C>
<C c="19" r="10" s="19">
<Expand/>
</C>
<C c="20" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(U9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(V9)]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(W9)]]></Attributes>
</O>
<Expand/>
</C>
<C c="23" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(X9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Y9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Z9))]]></Attributes>
</O>
<Expand/>
</C>
<C c="26" r="10" s="18">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(AB10))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="10" s="18">
<Expand/>
</C>
<C c="29" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(AD9))]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne((AD11 / Z11) * 100) + "%"]]></Attributes>
</O>
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="31" r="10" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=sum(AF10)]]></Attributes>
</O>
<Expand/>
</C>
<C c="32" r="10" s="18">
<Expand/>
</C>
<C c="2" r="11" cs="2" s="20">
<O t="DSColumn">
<Attributes dsName="ds7" columnName="fjname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="4" r="11" cs="5" s="21">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="(" + $bgnDate + " 至 " + $endDate + ")"]]></Attributes>
</O>
<Expand dir="0"/>
</C>
<C c="9" r="11" s="22">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Z12))]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="11" s="12">
<Expand/>
</C>
<C c="11" r="11" s="12">
<Expand/>
</C>
<C c="12" r="11" s="12">
<Expand/>
</C>
<C c="13" r="11" s="12">
<Expand/>
</C>
<C c="14" r="11" s="12">
<Expand/>
</C>
<C c="15" r="11" s="12">
<Expand/>
</C>
<C c="16" r="11" s="12">
<Expand/>
</C>
<C c="17" r="11">
<Expand/>
</C>
<C c="18" r="11" s="12">
<Expand/>
</C>
<C c="19" r="11" s="12">
<Expand/>
</C>
<C c="20" r="11" cs="5" s="12">
<O t="DSColumn">
<Attributes dsName="ds7" columnName="fjname"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="25" r="11" s="12">
<O t="DSColumn">
<Attributes dsName="ds7" columnName="hamount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="26" r="11" s="12">
<Expand/>
</C>
<C c="27" r="11" s="12">
<Expand/>
</C>
<C c="28" r="11" s="12">
<Expand/>
</C>
<C c="29" r="11" s="12">
<Expand/>
</C>
<C c="30" r="11" s="12">
<Expand/>
</C>
<C c="31" r="11" s="12">
<Expand/>
</C>
<C c="32" r="11" s="12">
<Expand/>
</C>
<C c="2" r="12" cs="2" s="23">
<O>
<![CDATA[总合计：]]></O>
<Expand/>
</C>
<C c="4" r="12" cs="6" s="17">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(J9) + J12)]]></Attributes>
</O>
<Expand/>
</C>
<C c="10" r="12" s="24">
<Expand/>
</C>
<C c="11" r="12" s="24">
<Expand/>
</C>
<C c="12" r="12" s="24">
<Expand/>
</C>
<C c="13" r="12" s="24">
<Expand/>
</C>
<C c="14" r="12" s="24">
<Expand/>
</C>
<C c="15" r="12" s="24">
<Expand/>
</C>
<C c="16" r="12" s="24">
<Expand/>
</C>
<C c="17" r="12">
<Expand/>
</C>
<C c="18" r="12" s="19">
<Expand/>
</C>
<C c="19" r="12" s="19">
<Expand/>
</C>
<C c="20" r="12" cs="5" s="18">
<O>
<![CDATA[小计]]></O>
<Expand/>
</C>
<C c="25" r="12" s="18">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(sum(Z9) + Z12)]]></Attributes>
</O>
<Expand/>
</C>
<C c="26" r="12" s="24">
<Expand/>
</C>
<C c="27" r="12" s="24">
<Expand/>
</C>
<C c="28" r="12" s="24">
<Expand/>
</C>
<C c="29" r="12" s="24">
<Expand/>
</C>
<C c="30" r="12" s="24">
<Expand/>
</C>
<C c="31" r="12" s="24">
<Expand/>
</C>
<C c="32" r="12" s="24">
<Expand/>
</C>
<C c="1" r="13" s="25">
<Expand/>
</C>
<C c="2" r="13" cs="15" s="26">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期：" + today()]]></Attributes>
</O>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="3" r="13" cs="17" s="26">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="打印日期：" + today()]]></Attributes>
</O>
<CellPageAttr/>
<CellInsertPolicy/>
<Expand/>
</C>
<C c="20" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="21" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesnumcol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="22" r="13">
<Expand/>
</C>
<C c="23" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="25" r="13">
<Expand/>
</C>
<C c="26" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="13">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="3" r="14">
<Expand/>
</C>
<C c="7" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="8" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="10" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="12" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="13" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="15" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="16" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="18" r="14" s="11">
<Expand/>
</C>
<C c="19" r="14" s="11">
<Expand/>
</C>
<C c="23" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="24" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$salesmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="26" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$moneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="27" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="28" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$costmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="29" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneycol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
<C c="30" r="14">
<HighlightList>
<Highlight class="com.fr.report.cell.cellattr.highlight.DefaultHighlight">
<Name>
<![CDATA[条件属性1]]></Name>
<Condition class="com.fr.data.condition.FormulaCondition">
<Formula>
<![CDATA[$zmoneyratecol != "1"]]></Formula>
</Condition>
<HighlightAction class="com.fr.report.cell.cellattr.highlight.ColWidthHighlightAction"/>
</Highlight>
</HighlightList>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting orientation="1">
<PaperSize width="30240000" height="47520000"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="黑体" style="0" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="128"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="黑体" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="0" size="80"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="黑体" style="1" size="80" foreground="-16776961" underline="1"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72" foreground="-16776961" underline="1"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="ColorBackground" color="-1"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="宋体" style="1" size="72" foreground="-65536"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1" color="-16777216"/>
<Bottom style="1" color="-16777216"/>
<Left style="1" color="-16777216"/>
<Right style="1" color="-16777216"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="宋体" style="0" size="72"/>
<Background name="ColorBackground" color="-4144960"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="2" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
