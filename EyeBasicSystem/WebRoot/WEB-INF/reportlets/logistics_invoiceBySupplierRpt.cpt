<?xml version="1.0" encoding="UTF-8"?>
<WorkBook xmlVersion="20120529" releaseVersion="7.0.0">
<TableDataMap>
<TableData name="ds1" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="statue"/>
<O>
<![CDATA[]]></O>
</Parameter>
<Parameter>
<Attributes name="invoiceID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select B_UT_unitName as unitName,
       (case '${statue}' when '1' then -sum(L_IE_IE_CheckGoodsQuantity) else sum(L_IE_IE_CheckGoodsQuantity) end) as nums,
       (case '${statue}' when '1' then -sum(L_IE_IE_NotTaxRateAmount) else sum(L_IE_IE_NotTaxRateAmount) end) as notTaxRateAmount,
       (case '${statue}' when '1' then -sum(L_IE_IE_TaxAmount) else sum(L_IE_IE_TaxAmount) end) as taxAmount,
       (case '${statue}' when '1' then -sum(L_IE_IE_CostPriceAmount) else sum(L_IE_IE_CostPriceAmount) end) as costPriceAmount 

 from L_IE_InvoiceEntry inner join B_GoodsInfo on L_IE_IE_GoodsID=B_GI_GoodsID inner join B_Unit on B_GI_UnitId=B_UT_id
      inner join L_I_Invoice on L_I_I_ID=L_IE_IE_InvoiceID
      inner join B_Brand on B_GI_BrandID=B_BD_ID and B_BD_SupplierID=L_I_I_SupplierID
 where L_IE_IE_InvoiceID='${invoiceID}'
 group by B_UT_unitName]]></Query>
</TableData>
<TableData name="ds3" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="logincompanyid"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select 
*
from F_CompanyName
where F_CN_ID = '${logincompanyid}']]></Query>
</TableData>
<TableData name="ds2" class="com.fr.data.impl.DBTableData">
<Parameters>
<Parameter>
<Attributes name="invoiceID"/>
<O>
<![CDATA[]]></O>
</Parameter>
</Parameters>
<Attributes maxMemRowCount="-1"/>
<Connection class="com.fr.data.impl.NameDatabaseConnection">
<DatabaseName>
<![CDATA[datasource]]></DatabaseName>
</Connection>
<Query>
<![CDATA[select B_SP_SupplierName as supplierName,convert(varchar(10),L_I_I_Date,120) as invoiceDate,L_I_I_ID as invoiceID,
       (select personname from SYS_PersonInfo where id=L_I_I_CreatePersonID) as createPerson,
       (select personname from SYS_PersonInfo where id=L_I_I_AuditPersonID) as auditPerson,L_IT_Type as invoiceType
  from L_I_Invoice inner join B_Supplier on L_I_I_SupplierID=B_SP_ID inner join L_IT_InvoiceType on L_I_I_InvoiceType=L_IT_ID
  where L_I_I_ID='${invoiceID}']]></Query>
</TableData>
</TableDataMap>
<Report class="com.fr.report.WorkSheet" name="sheet1">
<ReportPageAttr>
<HR F="4" T="4"/>
<FR F="7" T="7"/>
<HC/>
<FC/>
</ReportPageAttr>
<RowHeight defaultValue="723900">
<![CDATA[1143000,1143000,723900,762000,990600,990600,990600,762000,723900,723900,723900]]></RowHeight>
<ColumnWidth defaultValue="2743200">
<![CDATA[2438400,2667000,1562100,2743200,1790700,2628900,3429000,3429000,3429000,2743200,2743200]]></ColumnWidth>
<CellElementList>
<C c="0" r="0" cs="9" s="0">
<O t="DSColumn">
<Attributes dsName="ds3" columnName="F_CN_ReportShowName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="1" cs="9" s="1">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="invoiceType"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="2" s="2">
<O>
<![CDATA[发票号：]]></O>
<Expand dir="0"/>
</C>
<C c="1" r="2" cs="4">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="invoiceID"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="2" s="3">
<O>
<![CDATA[发票日期：]]></O>
<Expand/>
</C>
<C c="6" r="2" cs="2">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="invoiceDate"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="3" s="2">
<O>
<![CDATA[制造商：]]></O>
<Expand dir="0"/>
</C>
<C c="1" r="3" cs="5">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="supplierName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="0" r="4" cs="2" s="4">
<O>
<![CDATA[商品名称]]></O>
<Expand/>
</C>
<C c="2" r="4" cs="2" s="4">
<O>
<![CDATA[规格型号]]></O>
<Expand/>
</C>
<C c="4" r="4" s="4">
<O>
<![CDATA[单位]]></O>
<Expand/>
</C>
<C c="5" r="4" s="4">
<O>
<![CDATA[数量]]></O>
<Expand/>
</C>
<C c="6" r="4" s="4">
<O>
<![CDATA[金额]]></O>
<Expand/>
</C>
<C c="7" r="4" s="4">
<O>
<![CDATA[税额]]></O>
<Expand/>
</C>
<C c="8" r="4" s="4">
<O>
<![CDATA[价税合计]]></O>
<Expand/>
</C>
<C c="0" r="5" cs="2" s="5">
<O>
<![CDATA[制造商]]></O>
<Expand dir="0"/>
</C>
<C c="2" r="5" cs="2" s="5">
<Expand dir="0"/>
</C>
<C c="4" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="unitName"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="A6"/>
</C>
<C c="5" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="nums"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="A6"/>
</C>
<C c="6" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="notTaxRateAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="A6"/>
</C>
<C c="7" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="taxAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="A6"/>
</C>
<C c="8" r="5" s="5">
<O t="DSColumn">
<Attributes dsName="ds1" columnName="costPriceAmount"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper">
<Attr divideMode="1"/>
</RG>
<Result>
<![CDATA[FuncOne($$$)]]></Result>
<Parameters/>
</O>
<Expand dir="0" leftParentDefault="false" left="A6"/>
</C>
<C c="0" r="6" s="6">
<O>
<![CDATA[制单 ]]></O>
<Expand/>
</C>
<C c="1" r="6" s="7">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="createPerson"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="2" r="6" s="8">
<O>
<![CDATA[审核 ]]></O>
<Expand/>
</C>
<C c="3" r="6" cs="2" s="9">
<O t="DSColumn">
<Attributes dsName="ds2" columnName="auditPerson"/>
<Complex/>
<RG class="com.fr.report.cell.cellattr.core.group.FunctionGrouper"/>
<Parameters/>
</O>
<Expand dir="0"/>
</C>
<C c="5" r="6" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=SUM(F6)]]></Attributes>
</O>
<Expand/>
</C>
<C c="6" r="6" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(G6))]]></Attributes>
</O>
<Expand/>
</C>
<C c="7" r="6" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(H6))]]></Attributes>
</O>
<Expand/>
</C>
<C c="8" r="6" s="4">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=FuncOne(SUM(I6))]]></Attributes>
</O>
<Expand/>
</C>
<C c="0" r="7">
<O>
<![CDATA[打印日期：]]></O>
<Expand/>
</C>
<C c="1" r="7" cs="3">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[=TODAY()]]></Attributes>
</O>
<Expand/>
</C>
<C c="6" r="7" cs="3" s="10">
<O t="Formula" class="Formula">
<Attributes>
<![CDATA[="页次:第 " + $$page_number + " 页/共 " + $$totalPage_number + " 页"]]></Attributes>
</O>
<Expand/>
</C>
</CellElementList>
<ReportAttrSet>
<ReportSettings headerHeight="0" footerHeight="0">
<PaperSetting>
<Margin top="0" left="719999" bottom="0" right="0"/>
</PaperSetting>
</ReportSettings>
<Header reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Header>
<Footer reportPageType="0">
<Background name="NullBackground"/>
<LeftList/>
<CenterList/>
<RightList/>
</Footer>
</ReportAttrSet>
</Report>
<ReportParameterAttr>
<Attributes showWindow="false" delayPlaying="true" windowPosition="1" align="1"/>
<PWTitle>
<![CDATA[参数]]></PWTitle>
</ReportParameterAttr>
<StyleList>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="108"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="120"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="0" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Left style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="1" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
</Border>
</Style>
<Style imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border>
<Top style="1"/>
<Bottom style="1"/>
<Right style="1"/>
</Border>
</Style>
<Style horizontal_alignment="4" imageLayout="1">
<FRFont name="SimSun" style="0" size="72"/>
<Background name="NullBackground"/>
<Border/>
</Style>
</StyleList>
</WorkBook>
